<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Algorithm Problem 001: Maximum Possible Score of an Array</title>
    <url>/en/2023/09/21/Algorithm-Problem-001-Calculate-Maximum-Possible-Score-of-an-Array/</url>
    <content><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><blockquote>
<p> Problem Source: NowCoder Online Test</p>
</blockquote>
<p>Given an array $nums$ indexing from $0$ and a non-negative integer $k$.</p>
<p>In one operation, you can perform the following:</p>
<ul>
<li>Choose an index $i$ not chosen before, where $i$ is in the range $[0, nums.length - 1]$.</li>
<li>Replace $nums[i]$ with any integer in the range $[nums[i] - k, nums[i] + k]$ (inclusive).</li>
</ul>
<p>After applying any times of operations, return the maximum possible score of the array $nums$.</p>
<p>The array‚Äôs <strong>score</strong> is defined as the ‚Äúmaximum number of repeated elements in the array‚Äù.</p>
<p>Note that you can only apply the operation <strong>once</strong> for each index.</p>
<span id="more"></span>



<h1 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h1><h2 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1"></a>Example 1</h2><p>Input:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>Output:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>Explanation:</p>
<p>In this example, we perform the following operations:</p>
<ul>
<li>Choose index 1, replace it with 4 (range [4, 8]), nums &#x3D; [4,4,1,2].</li>
<li>Choose index 3, replace it with 4 (range [0, 4]), nums &#x3D; [4,4,1,4].</li>
</ul>
<p>After applying these operations, the score of array nums is 3 (subsequence composed of indices 0, 1, and 3). It can be proved that 3 is the maximum possible length we can achieve.</p>
<h2 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h2><p>Input:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>

<p>Output:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>Explanation:</p>
<p>In this example, no operations are needed.</p>
<p>The score of array nums is 4 (the entire array).</p>
<h1 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h1><h2 id="Rereading-the-Problem"><a href="#Rereading-the-Problem" class="headerlink" title="Rereading the Problem"></a>Rereading the Problem</h2><p>Let‚Äôs restate the problem:</p>
<p>Given an array $nums$ and a natural number $k$.</p>
<p>For any index $i$, we can replace the element $nums[i]$ with any integer in the range $[nums[i] - k, nums[i] + k]$. An index can only be operated on once, or not at all.</p>
<p>Return the maximum possible count of repeated elements in the array $nums$ after any times of operations.</p>
<h2 id="Observation-1-Sorting"><a href="#Observation-1-Sorting" class="headerlink" title="Observation 1: Sorting"></a>Observation 1: Sorting</h2><p>To maximize the number of repeated elements, we need to operate on elements that are <strong>close in value</strong> to make them equal.</p>
<p>How to find elements that are close in value? ‚Äî Sorting</p>
<h2 id="Observation-2-Finding-a-Pattern"><a href="#Observation-2-Finding-a-Pattern" class="headerlink" title="Observation 2: Finding a Pattern"></a>Observation 2: Finding a Pattern</h2><p>Assume, after sorting, we attempt to make elements in the interval $[i, j]$ equal after operations. What conditions should $i$ and $j$ satisfy?</p>
<ul>
<li>After sorting, we know that $nums[i] \le nums[i + 1] \le \cdots \le nums[j - 1] \le nums[j]$.</li>
<li>The replacement range for $nums[i]$ is $[nums[i] - k, nums[i] + k]$, and for $nums[j]$ is $[nums[j] - k, nums[j] + k]$.</li>
<li>Therefore, $nums[i] + k \ge nums[j] - k$.</li>
<li>Simplifying, we get <strong>$0 \le nums[j] - nums[i] \le 2k$</strong>.</li>
</ul>
<p>It can be seen that when $i$ is fixed, to maximize the range $j - i + 1$, we need to find a $j$ such that $nums[j] - nums[i]$ is as close to $2k$ as possible. This way, the interval range $j - i + 1$ could be the desired answer.</p>
<h2 id="Observation-3-Sliding-Window"><a href="#Observation-3-Sliding-Window" class="headerlink" title="Observation 3: Sliding Window"></a>Observation 3: Sliding Window</h2><p>After our analysis, this problem becomes:</p>
<ul>
<li>For a sorted array $nums$ and a natural number $k$.</li>
<li>When index $i$ is fixed, we need to find the maximum index $j$ such that $0 \le nums[j] - nums[i] \le 2k$.</li>
<li>Among all possible intervals $[i, j]$, the maximum $j - i + 1$ is the answer.</li>
</ul>
<p>Now, using the <strong>sliding window</strong> algorithm can reduce the time complexity from $O(n^2)$ (brute-force) to $O(n)$.</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maximumScore</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line"></span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// sliding window</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (j &lt; n &amp;&amp; nums[j] &lt;= nums[i] + <span class="number">2</span> * k) j++;</span><br><span class="line">            ans = Math.max(ans, j - i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Algorithm Problems</category>
      </categories>
      <tags>
        <tag>Sort</tag>
        <tag>Sliding Window</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Problem 002: Spiral Matrix II</title>
    <url>/en/2023/10/03/Algorithm-Problem-002-spiral-matrix-ii/</url>
    <content><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><blockquote>
<p>Problem SourceÔºö<a href="https://leetcode.cn/problems/spiral-matrix-ii/">59. Spiral Matrix II</a></p>
</blockquote>
<blockquote>
<p><strong>Problem Description</strong>Ôºö</p>
<p>Given a positive integer <code>n</code>, generate an <code>n x n</code> <code>matrix</code> filled with elements from <code>1</code> to <code>n^2</code> in spiral order.</p>
</blockquote>
<blockquote>
<p><strong>Example 1:</strong><br><img src="/en/MarkDownImages/spiraln.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: n = 3</span><br><span class="line">Output: [[1,2,3],[8,9,4],[7,6,5]]</span><br></pre></td></tr></table></figure>
</blockquote>
<span id="more"></span>

<blockquote>
<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: n = 1</span><br><span class="line">Output: [[1]]</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= n &lt;= 20</code></li>
</ul>
</blockquote>
<h1 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h1><p>This problem is a typical simulation problem where we need to traverse the entire matrix as described.</p>
<h2 id="Approach-1"><a href="#Approach-1" class="headerlink" title="Approach 1"></a>Approach 1</h2><p>My approach is to divide the matrix into layers and traverse each layer one by one. For example, when $n &#x3D; 3$, the matrix is:</p>
<p><img src="/en/MarkDownImages/spiraln.jpg" alt="img"></p>
<p>Here, we define the first layer as <code>layer = 0</code>, which contains numbers 1 to 8. The second layer is <code>layer = 1</code>, containing the number 9.</p>
<p>While traversing each layer, write the loop codes for moving right (1, 2), moving down (3, 4), moving left (5, 6), and moving up (7, 8).</p>
<p>The key to this approach is to find the mathematical pattern for the relationship between <code>layer</code> and the length of the current row&#x2F;column being traversed.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] generateMatrix(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="type">int</span>[][] ans = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">        <span class="type">int</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">layer</span> <span class="operator">=</span> <span class="number">0</span>; layer &lt;= n / <span class="number">2</span>; layer++) &#123;</span><br><span class="line">            <span class="comment">// Move right</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> layer; j &lt; n - layer - <span class="number">1</span>; ++j, ++counter) &#123;</span><br><span class="line">                ans[layer][j] = counter;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Move down</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> layer; i &lt; n - layer - <span class="number">1</span>; ++i, ++counter) &#123;</span><br><span class="line">                ans[i][n - layer - <span class="number">1</span>] = counter;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Move left</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> n - layer - <span class="number">1</span>; j &gt; layer; --j, ++counter) &#123;</span><br><span class="line">                ans[n - layer - <span class="number">1</span>][j] = counter;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Move up</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n - layer - <span class="number">1</span>; i &gt; layer; --i, ++counter) &#123;</span><br><span class="line">                ans[i][layer] = counter;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// For square matrices with odd length, manually handle the center element</span></span><br><span class="line">        <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            ans[n / <span class="number">2</span>][n / <span class="number">2</span>] = counter;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Clearly, this approach is error-prone as finding the pattern is tedious.</strong></p>
<p>Some experts on LeetCode provide an alternative solution that avoids finding the pattern, such as <a href="https://leetcode.cn/problems/spiral-matrix-ii/solutions/12594/spiral-matrix-ii-mo-ni-fa-she-ding-bian-jie-qing-x/">Krahets‚Äôs solution</a>Ôºömanually control the four boundaries (up, down, left, right), and when reaching a boundary, turn to the next direction.</p>
<h2 id="Approach-2"><a href="#Approach-2" class="headerlink" title="Approach 2"></a>Approach 2</h2><p>Since we are dealing with a matrix (a <strong>regular</strong> shape), we tend to control the traversal from a <strong>macro</strong> perspective, as in Approach 1. Macro means understanding the global picture, as seen in my approach of finding mathematical patterns and the experts‚Äô approach of controlling the four boundaries.</p>
<p>Now, let‚Äôs approach the problem from a <strong>micro</strong> perspective: what if we stand on a <strong>huge</strong> chessboard with <strong>invisible boundaries</strong> and need to fill in these numbers, how would we do it? We can <strong>only see the numbers on the surrounding squares</strong>. At this point, the macro approach is no longer effective, so what should we do?</p>
<p><img src="/en/MarkDownImages/spiraln.jpg" alt="img"></p>
<p>Suppose we stand on square 1 (facing right) and move forward, filling in the numbers along the path. When we reach square 3, we find that there is no way forward. Since we want to fill in the numbers clockwise, let‚Äôs turn right (facing down), and now the square we are facing is where we should fill in the number 4.</p>
<p>Similarly, when we reach square 8 (facing up), the squares in front have already been filled with number 1. Let‚Äôs turn right again (facing right), and now the square we are facing is where we should fill in the number 9.</p>
<p>Therefore, in the code, let‚Äôs <strong>focus only on the current coordinates of the agent</strong> and make it <strong>keep moving in one direction</strong> until it reaches a boundary or the square has already been filled with a number. When this happens, we <strong>turn right</strong>.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] generateMatrix(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="type">int</span>[][] ans = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">        <span class="comment">// (dx[k], dy[k]) represents the direction to move, in the order of right, down, left, up, right ...</span></span><br><span class="line">        <span class="type">int</span>[] dx = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">        <span class="type">int</span>[] dy = &#123;<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// (x, y) is the agent&#x27;s coordinates;</span></span><br><span class="line">        <span class="comment">// dir represents the current direction to move, it is the index of the dx, dy arrays</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">0</span>, y = <span class="number">0</span>, dir = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// Loop variables, and the condition for the loop to exit</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="number">1</span>, limit = n * n;</span><br><span class="line">        <span class="keyword">while</span> (counter &lt;= limit) &#123;</span><br><span class="line">            <span class="comment">// Current coordinates are within the boundaries, and the current square is not filled with a number</span></span><br><span class="line">            <span class="keyword">while</span> (<span class="number">0</span> &lt;= x &amp;&amp; x &lt; n &amp;&amp; <span class="number">0</span> &lt;= y &amp;&amp; y &lt; n &amp;&amp; ans[x][y] == <span class="number">0</span>) &#123;</span><br><span class="line">                ans[x][y] = counter;</span><br><span class="line">                counter++;</span><br><span class="line">                <span class="comment">// keep moving</span></span><br><span class="line">                x += dx[dir];</span><br><span class="line">                y += dy[dir];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Step back one square</span></span><br><span class="line">            x -= dx[dir];</span><br><span class="line">            y -= dy[dir];</span><br><span class="line">            <span class="comment">// Turn right</span></span><br><span class="line">            dir = (dir + <span class="number">1</span>) % dx.length;</span><br><span class="line">            <span class="comment">// After moving forward one step, the position (x, y) is the first square to be processed in the next while loop</span></span><br><span class="line">            x += dx[dir];</span><br><span class="line">            y += dy[dir];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h1><p>I came up with Approach 2 because I recently solved a problem that required filling numbers clockwise in an isosceles right-angled triangle (with the right angle parallel to the coordinate axes).</p>
<p>For example, when <code>n = 4</code>, we need to fill in the numbers as follows:</p>
<img src="/MarkDownImages/image-20231003171918667.png" alt="image-20231003171918667" style="zoom:67%;" />

<p>For the macro approach that finds patterns from a high-level perspective, I really didn‚Äôt bother and found it cumbersome. </p>
<p>With Approach 2, the so-called clockwise filling is essentially cycling through these directions: up, down-right, left. So, at the code level:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span>[] dx = &#123;-<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] dy = &#123;<span class="number">0</span>, <span class="number">1</span>, -<span class="number">1</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>A slight modification to the code for Approach 2 is all that is needed.</p>
]]></content>
      <categories>
        <category>Algorithm Problems</category>
      </categories>
      <tags>
        <tag>Simulation</tag>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title>the Architecture of Azure Pipelines</title>
    <url>/en/2023/10/06/Azure-Pipelines-Architecture/</url>
    <content><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Azure Pipelines is a component of Azure DevOps (a SaaS platform) and serves as an automated CI&#x2F;CD pipeline. Similar technologies include <a href="https://github.com/features/actions">GitHub Actions</a> and <a href="https://www.jenkins.io/">Jenkins</a>.</p>
<p>As users, we only need to define various tasks in YAML, trigger the pipeline, and Azure Pipelines automatically executes these tasks for us.</p>
<p>So, how are tasks executed? Is there a limit to parallel tasks? How can we design YAML more efficiently to make a pipeline run faster? This article will analyze the architecture of Azure Pipelines from the perspective of task scheduling, providing answers to these questions along the way.</p>
<span id="more"></span>

<h1 id="Azure-Pipelines-Terminology"><a href="#Azure-Pipelines-Terminology" class="headerlink" title="Azure Pipelines Terminology"></a>Azure Pipelines Terminology</h1><p><img src="/en/MarkDownImages/key-pipeline-concepts-overview-ca80c85c.png" alt="img"></p>
<p><strong>For users of Azure Pipelines</strong>, a YAML file uniquely defines the logic of a pipeline run:</p>
<ul>
<li>A pipeline can contain multiple stages.</li>
<li>A stage can contain multiple jobs.</li>
<li>A job can contain multiple steps.</li>
<li>A step can contain multiple tasks.</li>
</ul>
<p><strong>For Azure Pipelines itself</strong>, when a pipeline is triggered, it needs to invoke computing resources to execute the pipeline‚Äôs logic. Specifically, a machine (agent) is responsible for executing a job.</p>
<p>A job runs on only one agent, and it is not further divided. However, all jobs of a pipeline may be assigned to different agents for execution.</p>
<p>How is this distribution of jobs accomplished?</p>
<h1 id="Azure-Pipelines-Task-Scheduling"><a href="#Azure-Pipelines-Task-Scheduling" class="headerlink" title="Azure Pipelines Task Scheduling"></a>Azure Pipelines Task Scheduling</h1><p>Azure Pipelines task scheduling follows a typical distributed task scheduling model (similar technologies include <a href="http://www.quartz-scheduler.org/">QUARTZ</a> and <a href="https://github.com/xuxueli/xxl-job">xxl-job</a>):</p>
<ul>
<li>Azure Pipelines has a <strong>‚ÄòTask Queue‚Äô</strong> containing all pending <u>jobs</u> (referring to both the job&#x2F;task in the task scheduling model and the job term in the pipeline).</li>
<li>The agent is a worker that periodically checks whether there are jobs to run in the <strong>‚ÄòTask Queue‚Äô</strong>. If there are, some agent will compete to gain the right to execute that job while obtaining access to the relevant resources. At this point, it can start executing the job.</li>
</ul>
<p>Therefore, a pipeline is executed as follows:</p>
<ol>
<li>Trigger the pipeline. Azure Pipelines parses YAML, splits it into multiple jobs, and stores them in the <strong>‚ÄòTask Queue‚Äô</strong>.</li>
<li>If there is an idle agent at this time (indicating that the <strong>‚ÄòTask Queue‚Äô</strong> was empty), it listens for the event that a new job is pushed to the queue and begins competing to execute that job with other agents (if any).<ul>
<li>If successful, it starts execution.</li>
<li>If unsuccessful, it continues to listen.</li>
</ul>
</li>
<li>If there is no idle agent at this time (indicating that the <strong>‚ÄòTask Queue‚Äô</strong> previously had jobs or no agent completed its previously assigned job), these newly generated jobs will wait for an agent to execute them in an orderly manner (jobs are queued based on the time the pipeline was triggered, ensuring fairness).</li>
</ol>
<h1 id="Parallel-Jobs"><a href="#Parallel-Jobs" class="headerlink" title="Parallel Jobs"></a>Parallel Jobs</h1><p>The task scheduling framework implies <strong>parallelism</strong>. This means that when defining YAML, <strong>steps or tasks without dependencies should be elevated to jobs, allowing them to run in parallel and reduce execution time</strong>.</p>
<blockquote>
<p>However, during internships, few people do this, and most people use the default step level, even when many agents are often idle. ü§î</p>
</blockquote>
<p>Now, since the immediate execution of a new job depends on the presence of idle agents, does increasing the number of agents improve overall throughput (the number of jobs completed in a unit of time)? Unfortunately, not really.</p>
<p>After all, Microsoft needs to profit from Azure, so they introduced the concept of ‚ÄòParallel Jobs‚Äô, indicating a limit to the number of jobs that can run in parallel. This limit requires purchasing.</p>
<p>In other words, to run jobs in parallel, we not only need to purchase Azure VM agents but also Parallel Jobs. Even if we have many machines locally, we still need to buy Parallel Jobs.</p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="https://learn.microsoft.com/en-us/training/modules/explore-azure-pipelines/3-describe-azure-pipelines">Describe Azure Pipelines</a></li>
<li><a href="https://learn.microsoft.com/en-us/training/modules/explore-azure-pipelines/4-understand-key-terms">Understand Azure Pipelines key terms</a></li>
<li><a href="https://learn.microsoft.com/en-us/training/modules/manage-azure-pipeline-agents-pools/7-communicate-with-azure-pipelines">Communicate with Azure Pipelines</a></li>
<li><a href="https://azure.microsoft.com/en-us/products/devops/pipelines#overview">Azure Pipelines Product Overview</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/devops/pipelines/agents/agents">Azure Pipelines agents</a></li>
</ul>
]]></content>
      <categories>
        <category>tech</category>
        <category>Azure</category>
      </categories>
      <tags>
        <tag>Azure</tag>
        <tag>Azure Pipelines</tag>
        <tag>Architecture</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Problem 003: Diagonal Traverse II</title>
    <url>/en/2023/10/29/Algorithm-Problem-003-diagonal-traverse-ii/</url>
    <content><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><blockquote>
<p>Problem SourceÔºö <a href="https://leetcode.cn/problems/diagonal-traverse-ii/">1424. Diagonal Traverse II</a></p>
</blockquote>
<blockquote>
<p><strong>Problem Description</strong>Ôºö</p>
<p>Given a 2D integer array <code>nums</code>, return <em>all elements of</em> <code>nums</code> <em>in diagonal order as shown in the below images</em>.</p>
</blockquote>
<blockquote>
<p><strong>Example 1:</strong></p>
<p><img src="/en/MarkDownImages/image-20231029115351760.png" alt="image-20231029115351760"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [[1,2,3],[4,5,6],[7,8,9]]</span><br><span class="line">Output: [1,4,2,7,5,3,8,6,9]</span><br></pre></td></tr></table></figure>
</blockquote>
<span id="more"></span>

<blockquote>
<p><strong>Example 2:</strong></p>
<p><img src="/en/MarkDownImages/image-20231029115127660.png" alt="image-20231029115127660"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [[1,2,3,4,5],[6,7],[8],[9,10,11],[12,13,14,15,16]]</span><br><span class="line">Output: [1,6,2,8,7,3,9,4,12,10,5,13,11,14,15,16]</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [[1,2,3],[4],[5,6,7],[8],[9,10,11]]</span><br><span class="line">Output: [1,4,2,5,3,8,6,9,7,10,11]</span><br></pre></td></tr></table></figure>



<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 105</code></li>
<li><code>1 &lt;= nums[i].length &lt;= 105</code></li>
<li><code>1 &lt;= sum(nums[i].length) &lt;= 105</code></li>
<li><code>1 &lt;= nums[i][j] &lt;= 105</code></li>
</ul>
</blockquote>
<h1 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h1><p>For a natural number $k \in \mathbb{N}$, the coordinates of the elements on the $(k + 1)$-th diagonal are given by $\set{(i,j) | i + j &#x3D; k}$. For example, when $k &#x3D; 2$, the coordinates of the elements on the 3rd diagonal are $\set{(0,2),(1,1),(2,0)}$.</p>
<p>If <code>nums</code> were a matrix, this problem would be a simple simulation problem, just traversing it diagonally. </p>
<p>However, given that the number of rows $m \le 10^5$ and columns $n \le 10^5$, a time complexity of $O(mn)$ would be too slow. Therefore, we should not treat <code>nums</code> as a matrix for traversal to avoid accessing many empty cells.</p>
<p>Let‚Äôs observe example 1:</p>
<p><img src="/en/MarkDownImages/image-20231029115351760.png" alt="image-20231029115351760"></p>
<p>Observation1Ô∏è‚É£: For any $k \in \mathbb{N}$, the elements on the $(k + 1)$-th diagonal are traversed from bottom-left to top-right, i.e., $(k, 0), (k - 1,1),\cdots,(0,k)$. Therefore, if we want to obtain the elements on the $(k + 1)$-th diagonal, we should traverse each element in the corresponding rows of <code>nums</code> <strong>in reverse order</strong>.</p>
<p>Observation2Ô∏è‚É£: It is evident that for each row <code>nums[j]</code> in <code>nums</code>, the elements in this row belong to different diagonals, making them <strong>independent of each other</strong>.</p>
<p>Observation3Ô∏è‚É£: When <strong>traversing in reverse order</strong>:</p>
<ul>
<li>For the <strong>last row</strong> with elements $12,13,14,15,16$, they are the <strong>first</strong> elements on their respective diagonals, even though the diagonals that $13,14,15,16$ belong to do not have elements in the first column.</li>
<li>For the <strong>second-to-last row</strong> with elements $9,10,11$, they are the <strong>next</strong> elements to be traversed on their respective diagonals.</li>
<li>This pattern continues‚Ä¶</li>
</ul>
<p>Our goal is to collect all elements from <code>nums</code> diagonally. To achieve this, we can first create a list for each diagonal and add the corresponding elements to that list. Then, we traverse these lists in order to obtain the final result. If we follow this approach, we need to create a total of <code>m + n - 1</code> lists.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> nums.size();</span><br><span class="line"><span class="comment">// n is the maximum number of columns</span></span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.stream().mapToInt(List::size).max().getAsInt();</span><br><span class="line"><span class="comment">// ans stores m + n - 1 lists, representing elements traversed on different diagonals</span></span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">IntStream.range(<span class="number">0</span>, m + n - <span class="number">1</span>).forEach(i -&gt; ans.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;()));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Key problem: How to traverse??</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Traverse nums in forward order for each row</span></span><br><span class="line"><span class="keyword">return</span> ans.stream().flatMap(l -&gt; l.stream()).mapToInt(i -&gt; i).toArray();</span><br></pre></td></tr></table></figure>

<p>So, how do we traverse? To avoid timeout, we need to traverse row by row.</p>
<ul>
<li>According to ‚ÄòObservation 1Ô∏è‚É£‚Äô, traverse <code>nums</code> in reverse order.</li>
<li>According to ‚ÄòObservation 2Ô∏è‚É£‚Äô, for each row, for each traversed element <code>nums[i][j]</code>, put it into the $(i + j + 1)$-th list.</li>
<li>According to ‚ÄòObservation 3Ô∏è‚É£‚Äô, append the element <code>nums[i][j]</code> to the corresponding list. This is because the previous $n - i - 1$ rows ($n -1, n - 2 , \cdots, i + 1$) have already been traversed for the diagonal, and their elements are already stored in the list in the same order ‚Äî‚Äî we can prove this using recursion or mathematical induction.</li>
</ul>
<p>The code is straightforward:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Traverse nums in reverse</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> m - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">    List&lt;Integer&gt; row = nums.get(i);</span><br><span class="line">    <span class="comment">// For each element nums[i][j], put it into the (i + j + 1)-th list</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; row.size(); j++) &#123;</span><br><span class="line">        ans.get(i + j).add(row.get(j));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The time complexity is $O(m + n + \text{(# elements in nums)})$.</p>
<p>The space complexity is $O(m + n)$.</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] findDiagonalOrder(List&lt;List&lt;Integer&gt;&gt; nums) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> nums.size();</span><br><span class="line">        <span class="comment">// n is the maximum number of columns</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.stream().mapToInt(List::size).max().getAsInt();</span><br><span class="line">        <span class="comment">// ans stores m + n - 1 lists, representing elements traversed on different diagonals</span></span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        IntStream.range(<span class="number">0</span>, m + n - <span class="number">1</span>).forEach(i -&gt; ans.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Traverse nums in reverse</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> m - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            List&lt;Integer&gt; row = nums.get(i);</span><br><span class="line">            <span class="comment">// For each element nums[i][j], put it into the (i + j + 1)-th list</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; row.size(); j++) &#123;</span><br><span class="line">                ans.get(i + j).add(row.get(j));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Traverse nums in forward order for each row</span></span><br><span class="line">        <span class="keyword">return</span> ans.stream().flatMap(l -&gt; l.stream()).mapToInt(i -&gt; i).toArray();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









]]></content>
      <categories>
        <category>Algorithm Problems</category>
      </categories>
      <tags>
        <tag>Simulation</tag>
        <tag>Array</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Problem 005: Maximum Balanced Subsequence Sum</title>
    <url>/en/2023/11/06/Algorithm-Problem-005-maximum-balanced-subsequence-sum/</url>
    <content><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><blockquote>
<p>Problem Source: <a href="https://leetcode.cn/problems/maximum-balanced-subsequence-sum/">2926. Maximum Balanced Subsequence Sum</a></p>
<p>This article is an analysis of the solution to the last problem in <a href="/en/2023/11/05/leetcode-370-weekly-contest-summary/">LeetCode Weekly Contest 370</a>, which I failed to solve. The solution refers to <a href="https://leetcode.cn/problems/maximum-balanced-subsequence-sum/solutions/2513121/shu-zhuang-shu-zu-you-hua-dp-by-endlessc-3zf4/">the article by endlesscheng</a>„ÄÇ</p>
</blockquote>
<span id="more"></span>



<blockquote>
<p><strong>Problem Description:</strong></p>
<p>You are given a <strong>0-indexed</strong> integer array <code>nums</code>.</p>
<p>A <strong>subsequence</strong> of <code>nums</code> having length <code>k</code> and consisting of <strong>indices</strong> <code>i0 &lt; i1 &lt; ... &lt; ik-1</code> is <strong>balanced</strong> if the following holds:</p>
<ul>
<li><code>nums[ij] - nums[ij-1] &gt;= ij - ij-1</code>, for every <code>j</code> in the range <code>[1, k - 1]</code>.</li>
</ul>
<p>A <strong>subsequence</strong> of <code>nums</code> having length <code>1</code> is considered balanced.</p>
<p>Return <em>an integer denoting the <strong>maximum</strong> possible <strong>sum of elements</strong> in a <strong>balanced</strong> subsequence of</em> <code>nums</code>.</p>
<p>A <strong>subsequence</strong> of an array is a new <strong>non-empty</strong> array that is formed from the original array by deleting some (<strong>possibly none</strong>) of the elements without disturbing the relative positions of the remaining elements.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [3,3,5,6]</span><br><span class="line">Output: 14</span><br><span class="line">Explanation: In this example, the subsequence [3,5,6] consisting of indices 0, 2, and 3 can be selected.</span><br><span class="line">nums[2] - nums[0] &gt;= 2 - 0.</span><br><span class="line">nums[3] - nums[2] &gt;= 3 - 2.</span><br><span class="line">Hence, it is a balanced subsequence, and its sum is the maximum among the balanced subsequences of nums.</span><br><span class="line">The subsequence consisting of indices 1, 2, and 3 is also valid.</span><br><span class="line">It can be shown that it is not possible to get a balanced subsequence with a sum greater than 14.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [5,-1,-3,8]</span><br><span class="line">Output: 13</span><br><span class="line">Explanation: In this example, the subsequence [5,8] consisting of indices 0 and 3 can be selected.</span><br><span class="line">nums[3] - nums[0] &gt;= 3 - 0.</span><br><span class="line">Hence, it is a balanced subsequence, and its sum is the maximum among the balanced subsequences of nums.</span><br><span class="line">It can be shown that it is not possible to get a balanced subsequence with a sum greater than 13.</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [-2,-1]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: In this example, the subsequence [-1] can be selected.</span><br><span class="line">It is a balanced subsequence, and its sum is the maximum among the balanced subsequences of nums.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 105</code></li>
<li><code>-109 &lt;= nums[i] &lt;= 109</code></li>
</ul>
</blockquote>
<h1 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h1><h2 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h2><p>Let‚Äôs change the formulation of the problem: consecutive elements <code>nums[i]</code> and <code>nums[j]</code> in a balanced subsequence must satisfy $i &lt; j$ and $nums[j] - nums[i] \ge j - i$.</p>
<p>By rearranging the inequality above, we get $nums[j] - j \ge nums[i] - i$.</p>
<p>Let $b[i] &#x3D; nums[i] - i$, then the requirement for each element in a balanced subsequence only depends on its own value and index, not those of other elements.</p>
<p>Therefore, this problem is similar to the Longest Increasing Subsequence, and we can solve it using DP:</p>
<p>DP Definition: <code>dp[j]</code> represents the maximum sum of elements in a <strong>balanced</strong> subsequence ending at <code>nums[j]</code>.</p>
<p>Recurrence relation: $dp[j] &#x3D; nums[j] + \max\set{dp[i] | (i &lt; j) ‚àß (b[j] \ge b[i])}$</p>
<p>CodeÔºö</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">maxBalancedSubsequenceSum</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="comment">// b[i] = nums[i] - i</span></span><br><span class="line">        <span class="type">int</span>[] b = IntStream.range(<span class="number">0</span>, n).map(i -&gt; nums[i] - i).toArray();</span><br><span class="line">        <span class="comment">// dp[i]: maximum sum of elements in a subsequence ending at nums[i]</span></span><br><span class="line">        <span class="type">long</span>[] dp = <span class="keyword">new</span> <span class="title class_">long</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            dp[j] = nums[j];</span><br><span class="line">            <span class="type">long</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; j; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (b[j] &gt;= b[i])</span><br><span class="line">                    max = Math.max(max, dp[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            dp[j] += max;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(dp).max().getAsLong();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Clearly, the time complexity of the above code is $O(n^2)$ due to the nested loops, and it is likely to time out. How can we improve?</p>
<h2 id="Binary-Indexed-Tree-BIT"><a href="#Binary-Indexed-Tree-BIT" class="headerlink" title="Binary Indexed Tree (BIT)"></a>Binary Indexed Tree (BIT)</h2><p>Based on the recurrence relation above, our code logic should be as follows:</p>
<ul>
<li>For each $j$,</li>
<li>Traverse the interval $[0, j)$ and find the index $i$ that satisfies $b[j] \ge b[i]$ and maximizes $dp[i]$, which is a range query for the maximum value.</li>
<li>Set $dp[j] &#x3D; nums[j] + dp[i]$, which is a point update.</li>
</ul>
<p>We need the time complexity of ‚Äúrange query‚Äù + ‚Äúpoint update‚Äù to be strictly less than $O(n)$ to avoid time-outs. The Binary Indexed Tree (BIT) fits this requirement.</p>
<blockquote>
<p>Initially, I thought BIT was only suitable for range sum queries (for optimizing difference arrays), but this problem shows that range queries can also extend to minimum and maximum values.</p>
</blockquote>
<p>The values stored in the BIT are key-value pairs <code>&lt;b[j], dp[j]&gt;</code>, where <code>b[j]</code> is the index and <code>dp[j]</code> is the array element. To query the maximum value of elements whose indices $\le b[j]$, we are essentially querying the maximum value of a prefix interval.</p>
<p>Code:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BIT</span> &#123;</span><br><span class="line">        <span class="type">long</span>[] arr;</span><br><span class="line">        <span class="type">int</span> offset;</span><br><span class="line"></span><br><span class="line">        BIT(<span class="type">int</span> min, <span class="type">int</span> max) &#123;</span><br><span class="line">            <span class="comment">// Move the interval [min, max] to start from 0</span></span><br><span class="line">            offset = -min;</span><br><span class="line">            <span class="comment">// Leave index 0 of BIT empty, so the interval starts from 1</span></span><br><span class="line">            offset++;</span><br><span class="line">            arr = <span class="keyword">new</span> <span class="title class_">long</span>[max - min + <span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="title function_">lsb</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setMax</span><span class="params">(<span class="type">int</span> i, <span class="type">long</span> val)</span> &#123;</span><br><span class="line">            i += offset;</span><br><span class="line">            <span class="comment">// Index i affects all subsequent intervals, so we add lsb</span></span><br><span class="line">            <span class="keyword">for</span> (; i &lt; arr.length; i += lsb(i)) &#123;</span><br><span class="line">                arr[i] = Math.max(arr[i], val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="title function_">getMax</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">            i += offset;</span><br><span class="line">            <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> Long.MIN_VALUE;</span><br><span class="line">            <span class="comment">// Prefix interval, so we subtract lsb</span></span><br><span class="line">            <span class="keyword">for</span> (; i &gt; <span class="number">0</span>; i -= lsb(i)) &#123;</span><br><span class="line">                ans = Math.max(ans, arr[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">maxBalancedSubsequenceSum</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="comment">// b[i] = nums[i] - i</span></span><br><span class="line">        <span class="type">int</span>[] b = IntStream.range(<span class="number">0</span>, n).map(i -&gt; nums[i] - i).toArray();</span><br><span class="line">        <span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> Arrays.stream(b).max().getAsInt();</span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> Arrays.stream(b).min().getAsInt();</span><br><span class="line">        <span class="comment">// Customize the size of BIT#arr based on the range of elements in b</span></span><br><span class="line">        <span class="type">BIT</span> <span class="variable">tree</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BIT</span>(min, max);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> Long.MIN_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="comment">// Range query for the maximum value</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">dp_i</span> <span class="operator">=</span> Math.max(tree.getMax(b[j]), <span class="number">0</span>);</span><br><span class="line">            <span class="comment">// Point update</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">dp_j</span> <span class="operator">=</span> dp_i + nums[j];</span><br><span class="line">            tree.setMax(b[j], dp_j);</span><br><span class="line"></span><br><span class="line">            ans = Math.max(ans, dp_j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Submit this code:</p>
<p><img src="/en/MarkDownImages/image-20231106113338051.png" alt="image-20231106113338051"></p>
<p>We got an OOM.</p>
<p>Note the data range of the problem: $n \le 10^5$ Ôºå$nums[i] \in[-10^9,10^9]$</p>
<p>Therefore, the range of values for <code>b[i]</code> is approximately equal to the range of 32-bit integers, i.e., $2^{32}$, which will result in an Out Of Memory (OOM) error when creating <code>BIT#arr</code>. How can we optimize the space?</p>
<h2 id="Discretization"><a href="#Discretization" class="headerlink" title="Discretization"></a>Discretization</h2><blockquote>
<p>Reference to <a href="https://oi-wiki.org/misc/discrete/">OI-wiki</a>: </p>
<p>Discretization is a data processing technique, essentially a form of hashing, that ensures that data remains in its original full&#x2F;partial order after hashing.</p>
<p>In simple terms, when <strong>some data</strong> is too large or of a type that <strong>does not support using it as an array index</strong> conveniently, and <strong>only the relative size relationship</strong> between elements <strong>affects the final result</strong>, we can process the problem by treating the data <strong>based on their ranking</strong>, i.e., discretization.</p>
</blockquote>
<p>Let‚Äôs combine the concept with the problem:</p>
<ul>
<li>We want to query the maximum value of all indices $\le b[j]$ ‚Äî‚Äî there are $2^{32}$ possible values for <code>b[j]</code>.</li>
<li>However, the array <code>b</code> only has <code>n</code> elements.</li>
<li>Assume that <code>b[j]</code> is the $k$-th smallest element after sorting; then, we only need to query the maximum value among the first $k - 1$ elements smaller than <code>b[j]</code>.</li>
<li>Therefore, the length of <code>BIT#arr</code> is also <code>n</code>, and $n \ll 2^{32}$.</li>
<li>If we know the index <code>k</code> where <code>b[j]</code> is located after sorting, the operation ‚Äòquery the maximum value of all indices less than or equal to <code>b[j]</code>‚Äò is equivalent to <code>getMax(k)</code>.</li>
</ul>
<blockquote>
<p>In terms of effects, ‚ÄòDiscretization‚Äô should probably be called ‚ÄòNormalization‚Äô? ü§î</p>
</blockquote>
<p>The process of discretization is a typical template. Just memorize it:</p>
<blockquote>
<ol>
<li>Create a copy of the original array.</li>
<li>Sort the values in the copy in ascending order.</li>
<li>Remove duplicates from the sorted copy.</li>
<li>Find the position of each element in the original array in the sorted copy. This position becomes the ranking, and it is used as the discretized value.</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> ans[i] indicates the ranking of b[i] after sorting</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span>[] discretize(<span class="type">int</span>[] b) &#123;</span><br><span class="line">    <span class="type">int</span>[] arr = Arrays.stream(b).sorted().distinct().toArray();</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> b.length;</span><br><span class="line">    <span class="type">int</span>[] ans = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="comment">// b[i] must exist in arr</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">order</span> <span class="operator">=</span> Arrays.binarySearch(arr, b[i]);</span><br><span class="line">        <span class="comment">// ans[i] &gt;= 1 because index 0 of BIT must be left empty. In fact, you don&#x27;t need to add 1.</span></span><br><span class="line">        ans[i] = order + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If not removing duplicates, we use <code>std::lower_bound</code> instead of <code>std::binary_search</code> in C++. However, Java does not have such a function, so we must remove duplicates.</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BIT</span> &#123;</span><br><span class="line">        <span class="type">long</span>[] arr;</span><br><span class="line"></span><br><span class="line">        BIT(<span class="type">int</span> n) &#123;</span><br><span class="line">            arr = <span class="keyword">new</span> <span class="title class_">long</span>[n + <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="title function_">lsb</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">setMax</span><span class="params">(<span class="type">int</span> i, <span class="type">long</span> val)</span> &#123;</span><br><span class="line">            <span class="comment">// Index i affects all subsequent intervals, so we add lsb</span></span><br><span class="line">            <span class="keyword">for</span> (; i &lt; arr.length; i += lsb(i)) &#123;</span><br><span class="line">                arr[i] = Math.max(arr[i], val);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="title function_">getMax</span><span class="params">(<span class="type">int</span> i)</span> &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> Long.MIN_VALUE;</span><br><span class="line">            <span class="comment">// Prefix interval, so we subtract lsb</span></span><br><span class="line">            <span class="keyword">for</span> (; i &gt; <span class="number">0</span>; i -= lsb(i)) &#123;</span><br><span class="line">                ans = Math.max(ans, arr[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ans[i] indicates the ranking of b[i] after sorting</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[] discretize(<span class="type">int</span>[] b) &#123;</span><br><span class="line">        <span class="type">int</span>[] arr = Arrays.stream(b).sorted().distinct().toArray();</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> b.length;</span><br><span class="line">        <span class="type">int</span>[] ans = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="comment">// b[i] must exist in arr</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">order</span> <span class="operator">=</span> Arrays.binarySearch(arr, b[i]);</span><br><span class="line">            <span class="comment">// ans[i] &gt;= 1 because index 0 of BIT must be left empty. In fact, you don&#x27;t need to add 1.</span></span><br><span class="line">            ans[i] = order + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">maxBalancedSubsequenceSum</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="comment">// b[i] = nums[i] - i</span></span><br><span class="line">        <span class="type">int</span>[] b = IntStream.range(<span class="number">0</span>, n).map(i -&gt; nums[i] - i).toArray();</span><br><span class="line">        <span class="comment">// Discretization</span></span><br><span class="line">        <span class="type">int</span>[] arr = discretize(b);</span><br><span class="line">        <span class="type">BIT</span> <span class="variable">tree</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BIT</span>(n + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> Long.MIN_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="comment">// b[j] is the k-th smallest element</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> arr[j];</span><br><span class="line">            <span class="comment">// Range query for the maximum value</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">dp_i</span> <span class="operator">=</span> Math.max(tree.getMax(k), <span class="number">0</span>);</span><br><span class="line">            <span class="comment">// Point update</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">dp_j</span> <span class="operator">=</span> dp_i + nums[j];</span><br><span class="line">            tree.setMax(k, dp_j);</span><br><span class="line"></span><br><span class="line">            ans = Math.max(ans, dp_j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://leetcode.cn/problems/maximum-balanced-subsequence-sum/solutions/2513121/shu-zhuang-shu-zu-you-hua-dp-by-endlessc-3zf4/">Optimizing DP with BITÔºàPython&#x2F;Java&#x2F;C++&#x2F;GoÔºâ</a></li>
<li><a href="https://oi-wiki.org/misc/discrete/">Discretization - OI Wiki</a></li>
</ul>
]]></content>
      <categories>
        <category>Algorithm Problems</category>
      </categories>
      <tags>
        <tag>DP</tag>
        <tag>BIT</tag>
        <tag>Discretization</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Problem 004: Maximum Employees to Be Invited to a Meeting</title>
    <url>/en/2023/11/01/Algorithm-Problem-004-maximum-employees-to-be-invited-to-a-meeting/</url>
    <content><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><blockquote>
<p>Source: <a href="https://leetcode.cn/problems/maximum-employees-to-be-invited-to-a-meeting/">2127. Maximum Employees to Be Invited to a Meeting</a> (Daily Problem)</p>
</blockquote>
<p>A company is organizing a meeting and has a list of <code>n</code> employees, waiting to be invited. They have arranged for a large <strong>circular</strong> table, capable of seating <strong>any number</strong> of employees.</p>
<p>The employees are numbered from <code>0</code> to <code>n - 1</code>. Each employee has a <strong>favorite</strong> person and they will attend the meeting <strong>only if</strong> they can sit next to their favorite person at the table. The favorite person of an employee is <strong>not</strong> themselves.</p>
<p>Given a <strong>0-indexed</strong> integer array <code>favorite</code>, where <code>favorite[i]</code> denotes the favorite person of the <code>ith</code> employee, return <em>the <strong>maximum number of employees</strong> that can be invited to the meeting</em>.</p>
<h2 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1"></a>Example 1</h2><blockquote>
<p>Input: favorite &#x3D; [2,2,1,2]<br>Output: 3</p>
</blockquote>
<p><img src="/MarkDownImages/image-20231101114926490.png" alt="image-20231101114926490" style="zoom:65%;" /><img src="/MarkDownImages/image-20231101125447756-16988146128191.png" alt="image-20231101125447756" style="zoom:35%;" /></p>
<span id="more"></span>

<h2 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h2><blockquote>
<p>Input: favorite &#x3D; [1,2,0]<br>Output: 3</p>
</blockquote>
<p><img src="/en/MarkDownImages/image-20231101115048286.png" alt="image-20231101115048286"></p>
<h2 id="Example-3"><a href="#Example-3" class="headerlink" title="Example 3"></a>Example 3</h2><blockquote>
<p>Input: favorite &#x3D; [3,0,1,4,1]<br>Output: 4</p>
</blockquote>
<p><img src="/MarkDownImages/image-20231101115200232.png" alt="image-20231101115200232" style="zoom:65%;" /><img src="/MarkDownImages/image-20231101125539019.png" alt="image-20231101125539019" style="zoom:33%;" /></p>
<h1 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h1><p>By the definition of <code>favorite</code>, if we consider each employee as a node pointing to their favorite employee, we form a <strong>directed cyclic graph</strong> with <code>n</code> edges, <code>n</code> nodes, and each node having an out-degree of 1.</p>
<p>Observing Examples 2 and 3, the employees attending the circular table meeting must form a cycle. This is because each node has an out-degree of 1, and an employee must sit next to his favorite employee. Therefore, the maximum number of employees attending the meeting is equal to the <strong>length of the longest cycle</strong> (Conclusion 1Ô∏è‚É£).</p>
<p>Conclusion 1Ô∏è‚É£ can also be argued in reverse:</p>
<p>In Example 3, node 2 cannot attend the meeting because inserting this employee at any position on the circular table breaks the existing cycle. For instance, if we insert 2 between 0 and 1, then the neighbors of 1 become 2 and 4, neither of which is the favorite employee, violating the conditions.</p>
<p>Hence, the graph formed by employees able to attend the meeting must be a cycle, and there cannot be any other node chains (linked lists) pointing to a node within the cycle.</p>
<p>As shown in the diagram below, the answer is $\set{0,1,2,3}$ and it cannot include $\set{7,8}$ and $\set{4,5,6}$.</p>
<img src="/MarkDownImages/image-20231101132810263.png" alt="image-20231101132810263" style="zoom: 50%;" />

<p><strong>However</strong>, for <strong>cycles of length 2</strong> (two nodes pointing to each other), as long as the two employees sit together, the cycle cannot be broken. Therefore, cycles of length 2 need to be <strong>specially handled</strong>. In Example 1, nodes 1 and 2 form a cycle, and in this case, an additional employee can be added to the circular table.</p>
<p>Observing the following example:</p>
<img src="/MarkDownImages/image-20231101133700388.png" alt="image-20231101133700388" style="zoom:50%;" />

<p>Nodes 0 and 1 form a cycle of length 2, and the node chain $(3,2)$ points to 0, while the node chain $(5,4),(6)$ points to 1. The employees on the circular table in order should be $3,2,0,1,4,5$. That is, <strong>for every node in the cycle (2 nodes in total), add its longest node chain to the result set</strong> (Conclusion 2Ô∏è‚É£). Therefore, we choose $(5,4)$ instead of $(6)$.</p>
<p>Note that the graph may have multiple connected components. We need to adjust the two conclusions above:</p>
<ul>
<li>For cycles of length greater than 2, the entire circular table must belong to the nodes within the cycle, and no other nodes are allowed. Therefore, when there are multiple cycles, choose the one with the maximum length as the result.</li>
<li>For cycles of length 2, the condition that each employee ‚Äòwill attend the meeting only if they can sit next to their favorite person at the table‚Äô is satisfied by the cycle itself, not by occupying the entire circular table. Therefore, <strong>the final result is the union of all result sets satisfying ‚ÄòConclusion 2Ô∏è‚É£‚Äô</strong>. If employees in one result set sit together, then <strong>all result sets can coexist</strong>.</li>
</ul>
<p>Observing the example below, the answer is three cycles of length 2 and their extended node chains, totaling 8 nodes. The remaining connected component is a cycle of length 4.</p>
<img src="/MarkDownImages/image-20231101134045195.png" alt="image-20231101134045195" style="zoom: 50%;" />

<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><p>Based on the conclusions we drew earlier, the following information needs to be calculated in the code:</p>
<ul>
<li>The lengths of various cycles</li>
<li>The maximum length of the node chain for every node in cycles of length 2</li>
</ul>
<h2 id="How-to-Find-Cycles-in-the-Graph"><a href="#How-to-Find-Cycles-in-the-Graph" class="headerlink" title="How to Find Cycles in the Graph?"></a>How to Find Cycles in the Graph?</h2><p>Use topological sorting. Since this is a directed graph with <strong>$n$ edges, $n$ nodes, and each node‚Äôs out-degree is 1</strong>, nodes that cannot be visited during topological sorting must be part of a cycle.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> favorite.length;</span><br><span class="line"><span class="type">int</span>[] inDegree = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">ArrayDeque&lt;Integer&gt; que = <span class="keyword">new</span> <span class="title class_">ArrayDeque</span>&lt;&gt;();</span><br><span class="line"><span class="type">boolean</span>[] visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[n];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">    inDegree[favorite[i]]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (inDegree[i] == <span class="number">0</span>) &#123;</span><br><span class="line">        que.add(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> que.pollFirst();</span><br><span class="line">    visited[cur] = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">next</span> <span class="operator">=</span> favorite[cur];</span><br><span class="line"></span><br><span class="line">    inDegree[next]--;</span><br><span class="line">    <span class="keyword">if</span> (inDegree[next] == <span class="number">0</span>) &#123;</span><br><span class="line">        que.addLast(next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// At this point, all non-cycle nodes have been traversed and marked as visited</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">maxCircleSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (visited[i]) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="comment">// circle collects all nodes in the current cycle</span></span><br><span class="line">    ArrayList&lt;Integer&gt; circle = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> i;</span><br><span class="line">    <span class="keyword">while</span> (!visited[cur]) &#123;</span><br><span class="line">        circle.add(cur);</span><br><span class="line">        visited[cur] = <span class="literal">true</span>;</span><br><span class="line">        cur = favorite[cur];</span><br><span class="line">    &#125;</span><br><span class="line">    maxCircleSize = Math.max(maxCircleSize, circle.size());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="How-to-Count-Node-Chains"><a href="#How-to-Count-Node-Chains" class="headerlink" title="How to Count Node Chains?"></a>How to Count Node Chains?</h2><p>Node chains are single-linked lists that do not belong to a cycle. The list starts from a node with an in-degree of 0 and points to a node within a cycle. We can define a <code>pathLen</code> array,<br>where <code>pathLen[i]</code> represents <strong>the length of the longest node chain pointing to node <code>i</code></strong>.</p>
<p>Since topological sorting continuously traverses nodes with a current in-degree of 0, if node a points to b, then a will be visited first. If the node chain for a is already calculated, we can easily calculate the node chain for b:</p>
<p>$pathLen[b] &#x3D; \max\limits_{(a,b)\in E}\set{1 + pathLen[a]}$</p>
<p>Therefore, we can calculate <code>pathLen</code> during topological sorting:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Initialized to 0</span></span><br><span class="line"><span class="type">int</span>[] pathLen = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> que.pollFirst();</span><br><span class="line">    visited[cur] = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">next</span> <span class="operator">=</span> favorite[cur];</span><br><span class="line">    <span class="comment">// Update pathLen here</span></span><br><span class="line">    pathLen[next] = Math.max(pathLen[next], pathLen[cur] + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    inDegree[next]--;</span><br><span class="line">    <span class="keyword">if</span> (inDegree[next] == <span class="number">0</span>) &#123;</span><br><span class="line">        que.addLast(next);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Final-Code"><a href="#Final-Code" class="headerlink" title="Final Code"></a>Final Code</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayDeque;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maximumInvitations</span><span class="params">(<span class="type">int</span>[] favorite)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> favorite.length;</span><br><span class="line">        <span class="type">int</span>[] inDegree = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="type">int</span>[] pathLen = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        ArrayDeque&lt;Integer&gt; que = <span class="keyword">new</span> <span class="title class_">ArrayDeque</span>&lt;&gt;();</span><br><span class="line">        <span class="type">boolean</span>[] visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[n];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Topological sorting</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            inDegree[favorite[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (inDegree[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                que.add(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> que.pollFirst();</span><br><span class="line">            visited[cur] = <span class="literal">true</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">next</span> <span class="operator">=</span> favorite[cur];</span><br><span class="line">            pathLen[next] = Math.max(pathLen[next], pathLen[cur] + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            inDegree[next]--;</span><br><span class="line">            <span class="keyword">if</span> (inDegree[next] == <span class="number">0</span>) &#123;</span><br><span class="line">                que.addLast(next);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Topological sorting is complete, </span></span><br><span class="line">        <span class="comment">// all non-cycle nodes have been traversed and marked as visited</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Maximum cycle length</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">maxCircleLength</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// The size of the union of all result sets satisfying &#x27;Conclusion 2Ô∏è‚É£&#x27;</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">twoCirclePath</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Start finding cycles</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (visited[i]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="comment">// circle collects all nodes in the current cycle</span></span><br><span class="line">            ArrayList&lt;Integer&gt; circle = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="type">int</span> <span class="variable">cur</span> <span class="operator">=</span> i;</span><br><span class="line">            <span class="keyword">while</span> (!visited[cur]) &#123;</span><br><span class="line">                circle.add(cur);</span><br><span class="line">                visited[cur] = <span class="literal">true</span>;</span><br><span class="line">                cur = favorite[cur];</span><br><span class="line">            &#125;</span><br><span class="line">            maxCircleLength = Math.max(maxCircleLength, circle.size());</span><br><span class="line">            <span class="keyword">if</span> (circle.size() == <span class="number">2</span>) &#123;</span><br><span class="line">                twoCirclePath += pathLen[circle.get(<span class="number">0</span>)] + pathLen[circle.get(<span class="number">1</span>)] + <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Math.max(maxCircleLength, twoCirclePath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Algorithm Problems</category>
      </categories>
      <tags>
        <tag>Graph</tag>
        <tag>Topological Sorting</tag>
      </tags>
  </entry>
  <entry>
    <title>Algorithm Problem 006: Construct Binary Tree from Preorder and Postorder Traversal</title>
    <url>/en/2024/02/22/Algorithm-Problem-006-construct-binary-tree-from-preorder-and-postorder-traversal/</url>
    <content><![CDATA[<h1 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h1><blockquote>
<p>Problem SourceÔºö<a href="https://leetcode.cn/problems/construct-binary-tree-from-preorder-and-postorder-traversal">889. Construct Binary Tree from Preorder and Postorder Traversal</a>(Daily Challenge)</p>
</blockquote>
<blockquote>
<p><strong>Problem Description</strong>Ôºö</p>
<p>Given two integer arrays, <code>preorder</code> and <code>postorder</code> where <code>preorder</code> is the preorder traversal of a binary tree of <strong>distinct</strong> values and <code>postorder</code> is the postorder traversal of the same tree, reconstruct and return <em>the binary tree</em>.</p>
<p>If there exist multiple answers, you can <strong>return any</strong> of them.</p>
</blockquote>
<span id="more"></span>

<blockquote>
<p><strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2021/07/24/lc-prepost.jpg" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: preorder = [1,2,4,5,3,6,7], postorder = [4,5,2,6,7,3,1]</span><br><span class="line">Output: [1,2,3,4,5,6,7]</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: preorder = [1], postorder = [1]</span><br><span class="line">Output: [1]</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= preorder.length &lt;= 30</code></li>
<li><code>1 &lt;= preorder[i] &lt;= preorder.length</code></li>
<li>All the values of <code>preorder</code> are <strong>unique</strong>.</li>
<li><code>postorder.length == preorder.length</code></li>
<li><code>1 &lt;= postorder[i] &lt;= postorder.length</code></li>
<li>All the values of <code>postorder</code> are <strong>unique</strong>.</li>
<li>It is guaranteed that <code>preorder</code> and <code>postorder</code> are the preorder traversal and postorder traversal of the same binary tree.</li>
</ul>
</blockquote>
<h1 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h1><p>Firstly, it is important to note that <strong>the binary tree constructed from preorder and postorder traversals is not unique</strong>, and therefore, there is no deterministic rule. In contrast, ‚Äòinorder and preorder‚Äô as well as ‚Äòinorder and postorder‚Äô correspond uniquely to a binary tree. These rules are clear, making coding straightforward. Hence, we need to define our own rules.</p>
<p>Recall that when constructing a binary tree from ‚Äòinorder and preorder‚Äô, we sequentially traverse the preorder list. For each value, we create a corresponding node and then determine its subtree based on the inorder traversal. This can be understood as creating the preorder and verifying with the inorder.</p>
<p>Similarly, in this problem, we also ‚Äòsequentially traverse the preorder list, creating a corresponding node‚Äô but determine the <strong>position of the node</strong> (instead of its subtree) based on the postorder traversal. This is creating the preorder and verifying with the postorder.</p>
<p>In preorder, the sequence is ‚Äúroot - left - right‚Äù, and for each node in preorder, we can try placing it as the left child. In postorder, the sequence is ‚Äúleft - right - root‚Äù. <strong>If a node A in postorder is after node B, then A cannot be in the left subtree of B.</strong></p>
<p>For example, consider node <code>5</code> in Example 1. While sequentially traversing the preorder list, we can try placing <code>5</code> as the left child of <code>4</code>. However, in the postorder list, since <code>5</code> comes after <code>4</code>, this attempt is not allowed. <strong><code>5</code> can only be in the right subtree of one of the ancestors of <code>4</code></strong>, in this case, the right child of <code>2</code>.</p>
<p>Therefore, we need to keep track of the <strong>path from the root to the last traversed node</strong> and store them in a stack.</p>
<ul>
<li>As long as the current node and the top node of the stack do not satisfy the postorder constraint mentioned above, we pop the stack until it is satisfied. At this point, the current node becomes the right child of the top node.</li>
<li>If the constraint is already satisfied, the current node directly becomes the left child of the top node.</li>
</ul>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><p>The above approach is a rough description, and we should pay attention to details.</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode() : val(0), left(nullptr), right(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(nullptr), right(nullptr) &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x, TreeNode *left, TreeNode *right) : val(x), left(left), right(right) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">constructFromPrePost</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; preorder, vector&lt;<span class="type">int</span>&gt;&amp; postorder)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n = preorder.<span class="built_in">size</span>();</span><br><span class="line">        <span class="comment">// Only operate on the vector&#x27;s tail, equivalent to a stack</span></span><br><span class="line">        vector&lt;TreeNode*&gt; ve;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mp;</span><br><span class="line">        <span class="comment">// Just like &#x27;inorder and preorder&#x27;, store &lt;element, index&gt; in the hash table for validation</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            mp[postorder[i]] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> v: preorder) &#123;</span><br><span class="line">            TreeNode* cur = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(v);</span><br><span class="line">            <span class="comment">// Only the first element (root) will trigger this condition</span></span><br><span class="line">            <span class="keyword">if</span> (ve.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                ve.<span class="built_in">push_back</span>(cur);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">bool</span> popped = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">while</span>((!ve.<span class="built_in">empty</span>()) &amp;&amp; (mp[v] &gt; mp[ve.<span class="built_in">back</span>()-&gt;val])) &#123;</span><br><span class="line">                ve.<span class="built_in">pop_back</span>();</span><br><span class="line">                popped = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!popped) &#123;</span><br><span class="line">                ve.<span class="built_in">back</span>()-&gt;left = cur;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ve.<span class="built_in">back</span>()-&gt;right = cur;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Store the current node for the validation of the next node</span></span><br><span class="line">            ve.<span class="built_in">push_back</span>(cur);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// The first node is always the root node and will never be popped</span></span><br><span class="line">        <span class="keyword">return</span> ve.<span class="built_in">front</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Time Complexity: $O(n)$</p>
<ul>
<li>Sequentially traverse <code>preorder</code> and <code>postorder</code>.</li>
<li>Each node enters and exits <code>ve</code> only once.</li>
</ul>
<p>Space Complexity: $O(n)$</p>
<ul>
<li><code>mp</code> stores the values and their indices of all $n$ nodes.</li>
<li>In the worst case, all nodes are in <code>ve</code>.</li>
</ul>
]]></content>
      <categories>
        <category>Algorithm Problems</category>
      </categories>
      <tags>
        <tag>Tree</tag>
      </tags>
  </entry>
  <entry>
    <title>Deploying Nginx in Docker and Configuring SSL Certificate for Local Network</title>
    <url>/en/2024/01/31/Docker-Nginx-SSL-Local-Network/</url>
    <content><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>In my previous post, I successfully set up a LANraragi server and shared it with other devices in my home LAN. However, new issues arose:</p>
<ul>
<li>LANraragi could be accessed without logging in.</li>
<li>Even if LANraragi had a login feature, it still used HTTP plaintext transmission, which is equivalent to no password protection.</li>
</ul>
<p>The root cause of these issues was that devices like smartphones and smart home devices, connected to the LAN, were not trustworthy. They could potentially have backdoors (or ‚Äòusers voluntarily transmitting private data to improve service‚Äô). Anyway, these issues needed urgent resolution.</p>
<p>The solution is Nginx:</p>
<ul>
<li>Use Nginx‚Äôs built-in basic authentication to allow access only with a correct username and password.</li>
<li>Utilize Nginx‚Äôs reverse proxy feature. Once Nginx is configured with HTTPS, any software being proxied can use the encrypted transmission.</li>
</ul>
<p>Therefore, the key lies in the configuration of Nginx and SSL certificates. The challenge is that I need to request a certificate for an internal IP address without a corresponding domain name. This article explores these solutions, marking my first encounter with Nginx and SSL certificate configuration.</p>
<span id="more"></span>

<h1 id="Nginx-Container"><a href="#Nginx-Container" class="headerlink" title="Nginx Container"></a>Nginx Container</h1><h2 id="New-Nginx-Image"><a href="#New-Nginx-Image" class="headerlink" title="New Nginx Image"></a>New Nginx Image</h2><p>The official image only exposes port 80, while HTTPS requires port 443.</p>
<p>Create a <code>Dockerfile</code> on our own:</p>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nginx:<span class="number">1.24</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">443</span></span><br></pre></td></tr></table></figure>

<p>Build the image:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">docker build -t elnino2024/nginx:1.24 .</span><br></pre></td></tr></table></figure>

<h2 id="Obtain-the-Default-Configuration-File"><a href="#Obtain-the-Default-Configuration-File" class="headerlink" title="Obtain the Default Configuration File"></a>Obtain the Default Configuration File</h2><p>Create a temporary container, copy the <code>nginx.conf</code> from it:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">docker run --name tmp-nginx-container -d elnino2024/nginx:1.24</span><br><span class="line">docker <span class="built_in">cp</span> tmp-nginx-container:/etc/nginx/nginx.conf /opt/nginx.conf</span><br><span class="line">docker <span class="built_in">rm</span> -f tmp-nginx-container</span><br></pre></td></tr></table></figure>

<h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elnino2024/nginx:1.24</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker/nginx/nginx.conf:/etc/nginx/nginx.conf:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/nginx_ssl:/etc/nginx/ssl/:ro</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">bridge</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">50443</span><span class="string">:443</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Besides the configuration file, map a directory to store SSL private key and certificate.</li>
<li>Choose the bridge network mode; otherwise, other containers cannot be accessed.</li>
<li>Only map the <code>443</code> port, while I have no intention to open the <code>80</code> port.</li>
</ul>
<h1 id="SSL-Certificate"><a href="#SSL-Certificate" class="headerlink" title="SSL Certificate"></a>SSL Certificate</h1><h2 id="Create-a-CA"><a href="#Create-a-CA" class="headerlink" title="Create a CA"></a>Create a CA</h2><p>Create a CA key <code>myCAPK.key</code> and a (self-signed) certificate <code>myCACertificate.crt</code>:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">openssl req -x509 -sha256 -nodes -days 3650 -newkey rsa:4096 -keyout myCAPK.key -out myCACertificate.crt</span><br></pre></td></tr></table></figure>

<p>The private key and certificate generated by this command can be directly used for Nginx server. However, if another server also needs an SSL certificate, client devices need to manually trust the new certificate, which is troublesome.</p>
<p>If this certificate is used as a CA certificate, as long as devices trust this certificate, all other certificates signed by this CA will be automatically trusted. Therefore, devices only need to manually add the CA certificate only once.</p>
<h2 id="Check-Certificate-Information"><a href="#Check-Certificate-Information" class="headerlink" title="Check Certificate Information"></a>Check Certificate Information</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">openssl x509 -text -noout -<span class="keyword">in</span> myCACertificate.crt</span><br></pre></td></tr></table></figure>

<h2 id="Trust-the-CA"><a href="#Trust-the-CA" class="headerlink" title="Trust the CA"></a>Trust the CA</h2><p>As this CA certificate is self-created, the system won‚Äôt recognize it, so it needs to be installed.</p>
<p>Without this step, the browser can still establish an HTTPS connection but will prompt that the connection is not secure.</p>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>Control Panel | Internet Options | Content | Certificates</p>
<p><img src="/en/MarkDownImages/image-20240131172736021.png" alt="image-20240131172736021"></p>
<p>Trust the CA as a root certificate authority.</p>
<p><img src="/en/MarkDownImages/image-20240131172831043.png" alt="image-20240131172831043"></p>
<h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>Different systems have different locations for installing certificates, but the basic options are the same. Here‚Äôs an example for Samsung:</p>
<p>Either choose ‚ÄòCA certificates‚Äô or ‚ÄòVPN and app user certificates‚Äô. Do not choose ‚ÄòWLAN certificates‚Äô; it does not work.</p>
<p><img src="/en/MarkDownImages/Screenshot_20240201_113254_Settings.png" alt="Screenshot_20240201_113254_Settings"></p>
<h3 id="IOS"><a href="#IOS" class="headerlink" title="IOS"></a>IOS</h3><blockquote>
<p>Using iPadOS 15.7 as an example</p>
</blockquote>
<ol>
<li><p>Open your email, send the CA certificate as an attachment to yourself.</p>
</li>
<li><p>Using the Safari browser, log in to your email, click the attachment, and select ‚ÄúDownload Profile‚Äù (a prompt will appear:  ‚Äògo to settings to confirm installation‚Äô).</p>
</li>
<li><p>Go to settings, select ‚ÄúInstall Profile,‚Äù enter your lock screen password.</p>
</li>
<li><p>Settings | General | About | Certificate Trust Settings: Enable full trust.</p>
<p> <img src="/en/MarkDownImages/IMG_2032.PNG" alt="IMG_2032"></p>
</li>
</ol>
<hr>
<p>According to Apple‚Äôs <a href="https://support.apple.com/en-us/102028">new policy</a>Ôºåserver‚Äôs certificate cannot exceed 398 days, otherwise SSL connection errors occurÔºà<code>NET::ERR_CERT_VALIDITY_TOO_LONG</code>.</p>
<h2 id="Create-Server-Key"><a href="#Create-Server-Key" class="headerlink" title="Create Server Key"></a>Create Server Key</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">openssl genrsa -out nginx_server.key 4096</span><br></pre></td></tr></table></figure>

<h2 id="Create-Server-CSR-Certificate-Signing-Request"><a href="#Create-Server-CSR-Certificate-Signing-Request" class="headerlink" title="Create Server CSR (Certificate Signing Request)"></a>Create Server CSR (Certificate Signing Request)</h2><p>Create <code>openssl.cnf</code> with the following content:</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">authorityKeyIdentifier</span>=<span class="string">keyid,issuer</span></span><br><span class="line"><span class="attr">basicConstraints</span>=<span class="string">CA:FALSE</span></span><br><span class="line"><span class="attr">subjectAltName</span> = <span class="string">@alt_names</span></span><br><span class="line"><span class="attr">[alt_names]</span></span><br><span class="line"><span class="comment"># ËôöÊãüÊú∫</span></span><br><span class="line"><span class="attr">DNS.1</span> = <span class="string">CentOS100</span></span><br><span class="line"><span class="attr">IP.1</span> = <span class="string">192.168.169.132</span></span><br><span class="line"><span class="comment"># ‰∏ªÊú∫</span></span><br><span class="line"><span class="attr">IP.2</span> = <span class="string">192.168.0.105</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>The configuration file can be more complex, but for this case, these few configurations are sufficient.</p>
</blockquote>
<ul>
<li><code>DNS.x</code> corresponds to hostname&#x2F;domain.</li>
<li><code>IP.x</code> corresponds to IP addresses.</li>
</ul>
<blockquote>
<p> <code>x</code> is a positive integer.</p>
</blockquote>
<p>The only purpose of this file is to bind the server‚Äôs domain name and IP with the certificate during CA signing, indicating that the certificate indeed belongs to that server and not someone else pretending. Without this configuration, the browser would show an error: <code>NET::ERR_CERT_COMMON_NAME_INVALID</code>.</p>
<p>Use the following command to create the CSR:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">openssl req -new -key nginx_server.key -out nginx_server.csr</span><br></pre></td></tr></table></figure>

<h2 id="CA-Signing"><a href="#CA-Signing" class="headerlink" title="CA Signing"></a>CA Signing</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">openssl x509 -req -extfile openssl.cnf  -<span class="keyword">in</span> nginx_server.csr -CA /opt/MyOwnCA/myCACertificate.crt -CAkey /opt/MyOwnCA/myCAPK.key -CAcreateserial -out nginx_server.crt -days 3650</span><br></pre></td></tr></table></figure>

<p>After signing, you will get the private key <code>nginx_server.key</code> and certificate <code>nginx_server.crt</code> ready to be used in Nginx.</p>
<h1 id="Nginx-Configuration"><a href="#Nginx-Configuration" class="headerlink" title="Nginx Configuration"></a>Nginx Configuration</h1><h2 id="SSL"><a href="#SSL" class="headerlink" title="SSL"></a>SSL</h2><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> default_server ssl http2;</span><br><span class="line">    <span class="attribute">listen</span> [::]:<span class="number">443</span> ssl http2;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span> /etc/nginx/ssl/nginx_server.crt;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span> /etc/nginx/ssl/nginx_server.key;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /... &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> ...;  </span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>This is just the basic configuration; there are more SSL directives in practice, but these are sufficient for now.</p>
</blockquote>
<h2 id="Basic-Authentication"><a href="#Basic-Authentication" class="headerlink" title="Basic Authentication"></a>Basic Authentication</h2><p>1Ô∏è‚É£First, create a username and password:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Create the file if it doesn&#x27;t exist</span></span><br><span class="line"><span class="built_in">touch</span> /opt/docker/nginx_auth/.htpasswd-lanraragi</span><br><span class="line"><span class="comment"># Add user alpha to this configuration file</span></span><br><span class="line">htpasswd /opt/docker/nginx_auth/.htpasswd-lanraragi alpha</span><br></pre></td></tr></table></figure>

<p>Then, the system will prompt to set a password for the <code>alpha</code> user. To add multiple users, use the same command:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">htpasswd /opt/docker/nginx_auth/.htpasswd-lanraragi beta</span><br></pre></td></tr></table></figure>

<blockquote>
<p>On CentOS, the <code>htpasswd</code> command belongs to <code>httpd-tools</code>. If not installed, the system will prompt to install it.</p>
</blockquote>
<hr>
<p>2Ô∏è‚É£Configure in NginxÔºö</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">location</span> /api &#123;</span><br><span class="line">    <span class="attribute">auth_basic</span>           <span class="string">&quot;Administrator‚Äôs Area&quot;</span>;</span><br><span class="line">    <span class="attribute">auth_basic_user_file</span> /etc/nginx/.htpasswd; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>auth_basic</code> prompts a message to user on the login pageÔºõ</li>
<li><code>auth_basic_user_file</code> points to the previously created <code>.htpasswd</code>Ôºõ</li>
</ul>
<p>It can also be enabled globally and disabled for specific URLs:</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="attribute">auth_basic</span>           <span class="string">&quot;Administrator‚Äôs Area&quot;</span>;</span><br><span class="line">    <span class="attribute">auth_basic_user_file</span> conf/.htpasswd;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /public/ &#123;</span><br><span class="line">      <span class="attribute">auth_basic</span> <span class="literal">off</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Example-Lanraragi"><a href="#Example-Lanraragi" class="headerlink" title="Example: Lanraragi"></a>Example: Lanraragi</h1><p>Let‚Äôs come back to the initial demand: reverse proxy Lanraragi and provide a login feature.</p>
<p>Docker compose:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">elnino2024/nginx:1.24</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx-lanraragi</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker/nginx_conf/nginx-lanraragi.conf:/etc/nginx/nginx.conf:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker/nginx_ssl:/etc/nginx/ssl/:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker/nginx_auth:/etc/nginx/auth/:ro</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">43000</span><span class="string">:443</span></span><br><span class="line">  <span class="attr">lanraragi:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">difegue/lanraragi:v.0.9.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">lanraragi</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/mnt/hgfs/doujinshiArchives:/home/koyomi/lanraragi/content:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">lanraragi-database:/home/koyomi/lanraragi/database</span></span><br><span class="line">    <span class="attr">depends_on:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">nginx</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">lanraragi-database:</span></span><br></pre></td></tr></table></figure>

<p>Nginx configuration:</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">user</span>  nginx;</span><br><span class="line"><span class="attribute">worker_processes</span>  auto;</span><br><span class="line"></span><br><span class="line"><span class="attribute">error_log</span>  /var/log/nginx/<span class="literal">error</span>.log <span class="literal">notice</span>;</span><br><span class="line"><span class="attribute">pid</span>        /var/run/nginx.pid;</span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span>  <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">include</span>       /etc/nginx/mime.types;</span><br><span class="line">    <span class="attribute">default_type</span>  application/octet-stream;</span><br><span class="line">    </span><br><span class="line">    <span class="attribute">log_format</span>  main  <span class="string">&#x27;<span class="variable">$remote_addr</span> - <span class="variable">$remote_user</span> [<span class="variable">$time_local</span>] &quot;<span class="variable">$request</span>&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;<span class="variable">$status</span> <span class="variable">$body_bytes_sent</span> &quot;<span class="variable">$http_referer</span>&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;&quot;<span class="variable">$http_user_agent</span>&quot; &quot;<span class="variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">access_log</span>  /var/log/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">sendfile</span>        <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">keepalive_timeout</span>  <span class="number">65</span>;</span><br><span class="line"></span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span> <span class="number">443</span> default_server ssl http2;</span><br><span class="line">        <span class="attribute">listen</span> [::]:<span class="number">443</span> ssl http2;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">ssl_certificate</span> /etc/nginx/ssl/nginx_server.crt;</span><br><span class="line">        <span class="attribute">ssl_certificate_key</span> /etc/nginx/ssl/nginx_server.key;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">auth_basic</span>           <span class="string">&quot;Login to view any content&quot;</span>;</span><br><span class="line">        <span class="attribute">auth_basic_user_file</span> /etc/nginx/auth/.htpasswd-lanraragi;</span><br><span class="line"></span><br><span class="line">        <span class="section">location</span> / &#123;</span><br><span class="line">            <span class="comment"># Access directly through service name in the same network</span></span><br><span class="line">            <span class="comment"># No need to map any port for lanraragi</span></span><br><span class="line">            <span class="attribute">proxy_pass</span> http://lanraragi:3000;</span><br><span class="line">            <span class="attribute">proxy_http_version</span> <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="attribute">proxy_set_header</span> Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">            <span class="attribute">http2_push_preload</span> <span class="literal">on</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Lanraragi‚Äôs own routing strategy cannot be changed, which means <code>/</code> must be mapped as-is to Lanraragi‚Äôs URI. In other words, Lanraragi needs a separate Nginx instance.</p>
<p>From a computational resources perspective, this isn‚Äôt a big deal, as one Nginx instance uses less than 20 MB of memory.</p>
<p>If each existing software gets its own Nginx, these Nginx instances can share a single SSL certificate. After all, when accessing the Linux host, it tells Nginx instances from each other by port, and the certificate is bound to IP&#x2F;domain. Although this is a solution, I‚Äôm not sure if it‚Äôs the best practice. However, in a home LAN scenario, it is clearly sufficient.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li>ChatGPT</li>
<li><a href="https://mindsers.blog/en/post/https-using-nginx-certbot-docker/">HTTPS using Nginx and Let‚Äôs encrypt in Docker</a></li>
<li><a href="https://www.baeldung.com/openssl-self-signed-cert">Creating a Self-Signed Certificate With OpenSSL</a></li>
<li><a href="https://hub.docker.com/_/nginx">Nginx Docker hub</a></li>
<li><a href="https://www.tangyuecan.com/2021/12/17/%E5%B1%80%E5%9F%9F%E7%BD%91%E5%86%85%E6%90%AD%E5%BB%BA%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%AF%E4%BF%A1%E4%BB%BB%E7%9A%84ssl%E8%AF%81%E4%B9%A6/">Â±ÄÂüüÁΩëÂÜÖÊê≠Âª∫ÊµèËßàÂô®ÂèØ‰ø°‰ªªÁöÑSSLËØÅ‰π¶</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-self-signed-ssl-certificate-for-nginx-in-ubuntu-16-04">How To Create a Self-Signed SSL Certificate for Nginx in Ubuntu 16.04</a></li>
<li><a href="https://stackoverflow.com/questions/10175812/how-to-generate-a-self-signed-ssl-certificate-using-openssl">How to generate a self-signed SSL certificate using OpenSSL?</a></li>
<li><a href="https://docs.nginx.com/nginx/admin-guide/security-controls/configuring-http-basic-authentication/">Restricting Access with HTTP Basic Authentication</a></li>
<li><a href="https://support.hcltechsw.com/csm?id=kb_article&sysparm_article=KB0098768">Âú®iOSËÆæÂ§á‰∏äÂÆâË£ÖÊ†πËØÅ‰π¶(CA)</a></li>
<li><a href="https://discussions.apple.com/thread/253667401?sortBy=best">Enabling self-signed certificates in iOS 15</a></li>
<li><a href="https://support.apple.com/en-us/102028">Apple: About upcoming limits on trusted certificates</a></li>
</ul>
]]></content>
      <categories>
        <category>tech</category>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>Nginx</tag>
        <tag>SSL</tag>
      </tags>
  </entry>
  <entry>
    <title>LANraragi Using Experience</title>
    <url>/en/2024/02/20/LANraragi-Using-Experience/</url>
    <content><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>I have been using LANraragi for a while and encountered some issues. I managed to resolve them, and I thought it would be a good idea to document my experience in a post. You can refer to my <a href="/en/2024/01/25/LANraragi-manga-server/">previous article on installing LANraragi</a> first.</p>
<h1 id="Issue-1-Mounting-Thumbnail-Directory-Causes-Thumbnail-Generation-Failure"><a href="#Issue-1-Mounting-Thumbnail-Directory-Causes-Thumbnail-Generation-Failure" class="headerlink" title="Issue 1: Mounting Thumbnail Directory Causes Thumbnail Generation Failure"></a>Issue 1: Mounting Thumbnail Directory Causes Thumbnail Generation Failure</h1><span id="more"></span>

<p>When installing LANraragi, to ensure the <code>content</code> directory is read-only, I set the thumbnail directory as an internal path of the container. This means that every time I deleted and restarted the container, thumbnails will be regenerated. This practice not only wasted computational resources but also deviated from Docker‚Äôs best practices. To address this, I used a new volume to store the thumbnails.</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">lanraragi:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">difegue/lanraragi:v.0.9.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">lanraragi</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/mnt/hgfs/doujinshiArchives:/home/koyomi/lanraragi/content:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">lanraragi-database:/home/koyomi/lanraragi/database</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">lanraragi-thumbnail:/home/koyomi/lanraragi/thumb</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">lanraragi-database:</span></span><br><span class="line">  <span class="attr">lanraragi-thumbnail:</span></span><br></pre></td></tr></table></figure>

<p><code>lanraragi-thumbnail</code> is the volume for storing thumbnails.</p>
<p>After starting the container, I noticed that thumbnails could not be generated. Upon entering the ‚ÄòMinion Console‚Äô, I found the following error:</p>
<p><img src="/en/MarkDownImages/image-20240220111456968.png" alt="image-20240220111456968"></p>
<p>Why did <code>mkdir</code> not have permission? I entered the container:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">/home/koyomi/lanraragi <span class="comment"># ls -lah</span></span><br><span class="line">total 192K   </span><br><span class="line">drwxr-sr-x    1 koyomi   koyomi      4.0K Feb 20 02:14 .</span><br><span class="line">drwxr-sr-x    1 koyomi   koyomi      4.0K Feb 20 02:14 ..</span><br><span class="line">-rw-r--r--    1 root     koyomi        52 Oct 29 21:19 config.log</span><br><span class="line">drwxrwxrwx    1 root     root       16.0K Feb 17 11:44 content</span><br><span class="line">drwxr-xr-x    3 koyomi   root        4.0K Feb 20 03:10 database</span><br><span class="line">drwxr-sr-x    3 koyomi   koyomi      4.0K Oct 31 00:58 lib</span><br><span class="line">drwxr-sr-x    2 koyomi   koyomi      4.0K Feb 20 02:14 <span class="built_in">log</span></span><br><span class="line">-rw-r--r--    1 koyomi   koyomi       186 Oct 31 00:58 lrr.conf</span><br><span class="line">-rw-r--r--    1 koyomi   koyomi         8 Feb 20 02:14 oshino</span><br><span class="line">-rw-r--r--    1 koyomi   koyomi     97.6K Oct 29 21:02 package-lock.json</span><br><span class="line">-rw-r--r--    1 koyomi   koyomi      2.1K Oct 27 23:07 package.json</span><br><span class="line">drwxr-sr-x    1 root     koyomi      4.0K Feb 20 02:14 public</span><br><span class="line">drwxr-sr-x    2 koyomi   koyomi      4.0K Oct 31 00:58 script</span><br><span class="line">drwxr-sr-x    3 koyomi   koyomi      4.0K Oct 31 00:58 templates</span><br><span class="line">drwxr-sr-x    4 koyomi   koyomi      4.0K Oct 31 00:58 tests</span><br><span class="line">drwxr-xr-x  257 root     root        4.0K Feb 20 02:19 thumb</span><br><span class="line">drwxr-sr-x    1 koyomi   koyomi      4.0K Oct 31 00:59 tools</span><br></pre></td></tr></table></figure>

<p>Note the <code>thumb</code> directory created by the <code>root</code> user, but the user running LANraragi, <code>koyomi</code>, does not have write permission to that directory. Just granting permission:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 777 thumb</span><br></pre></td></tr></table></figure>

<p>Then, in ‚ÄòTags and Thumbnails‚Äô, click on ‚ÄòGenerate Missing Thumbnails‚Äô.</p>
<blockquote>
<p>It‚Äôs also worth noting that the default manga directory, <code>content</code>, has elevated permissions intentionally set by the author. Therefore, using <code>content/thumb</code> as the default thumbnail directory will not cause this issue.</p>
</blockquote>
<h1 id="Issue-2-Real-Time-File-Monitoring-Failure"><a href="#Issue-2-Real-Time-File-Monitoring-Failure" class="headerlink" title="Issue 2: Real-Time File Monitoring Failure"></a>Issue 2: Real-Time File Monitoring Failure</h1><p>Refer to the ‚ÄòBackground Workers‚Äô in the settings:</p>
<blockquote>
<p>This File Watcher is responsible for monitoring your content directory and automatically handling new archives as they come.<br>If Shinobu is dead or unresponsive, you can reboot her by clicking this button.</p>
</blockquote>
<p>While it should monitor file changes in real-time, I couldn‚Äôt use this feature. The reason is that this feature utilizes the <code>inotify</code> API:</p>
<blockquote>
<p>The inotify API provides a mechanism for monitoring filesystem events.  Inotify can be used to monitor individual files, or to monitor directories.  When a directory is monitored, inotify will return events for the directory itself, and for files inside the directory.</p>
</blockquote>
<p>If the file system does not support this API, obviously, LANraragi cannot monitor file changes.</p>
<p>I use VMware‚Äôs shared folder to map manga resources to Linux, and the underlying file system of the shared folder does not support <code>inotify</code>.</p>
<p>Solution: Click ‚ÄòRestart File Watcher,‚Äô which will scan the entire <code>content</code> directory after restarting. Alternatively, write a scheduled task script to POST <code>/api/shinobu/restart</code>.</p>
<hr>
<p>In fact, many software applications use <code>inotify</code> to monitor file changes, making this a common issue.</p>
<p>My Jellyfin media folder also uses VMware‚Äôs shared folder, so it faces the same problem. However, Jellyfin is more popular, which allowed me to find the cause to this issue quickly from related posts. More importantly, Jellyfin explicitly states that only file systems supporting <code>inotify</code> have this functionality, which is a good practice for other software authors to follow when documenting.</p>
<blockquote>
<h2 id="Real-Time-Monitoring"><a href="#Real-Time-Monitoring" class="headerlink" title="Real Time Monitoring"></a>Real Time Monitoring</h2><p>This will let Jellyfin automatically update libraries when files are added or modified. Unfortunately, this feature is <strong>only supported on certain filesystems</strong>.</p>
<p>For Linux systems, this is performed by inotify. NFS and rclone do not support inotify, but support can be provided by using a union file system such as mergerfs with your networked file systems.</p>
</blockquote>
<p>By the way, here‚Äôs the solution for Jellyfin:</p>
<ul>
<li>Increase the frequency of the scheduled task ‚ÄòScan Media Library‚Äô ‚Äì this task doesn‚Äôt consume many resources, so running it frequently is not an issue.</li>
<li>Execute a refresh through the API.</li>
</ul>
<h1 id="Gains"><a href="#Gains" class="headerlink" title="Gains"></a>Gains</h1><p>This script is quite useful:</p>
<p><img src="/en/MarkDownImages/image-20240220131323937.png" alt="image-20240220131323937"></p>
<p>My manga directory structure is:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">‚îú‚îÄ‚îÄ Author1</span><br><span class="line">‚îÇ   ‚îú‚îÄ‚îÄ Manga Archive 1</span><br><span class="line">‚îÇ   ‚îî‚îÄ‚îÄ Manga Archive 2</span><br><span class="line">‚îî‚îÄ‚îÄ Author2</span><br><span class="line">    ‚îú‚îÄ‚îÄ Manga Archive 1</span><br><span class="line">    ‚îî‚îÄ‚îÄ Manga Archive 2</span><br></pre></td></tr></table></figure>

<p>This script categorizes the corresponding manga into a specific author‚Äôs category. Although I did not (and will not) tag manga, using author as a category achieves the same effect, allowing me to select manga based on the author.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://man7.org/linux/man-pages/man7/inotify.7.html">inotify(7) ‚Äî Linux manual page</a></li>
<li><a href="https://sugoi.gitbook.io/lanraragi/api-documentation/shinobu-api">LANraragi doc: Shinobu API</a></li>
<li><a href="https://jellyfin.org/docs/general/administration/troubleshooting#real-time-monitoring">Jellyfin doc: Real Time Monitoring</a></li>
<li><a href="https://www.reddit.com/r/jellyfin/comments/ke3cmo/jellyfin_not_picking_up_new_files_on_docker_mount/">Jellyfin not picking up new files on docker mount</a></li>
<li><a href="https://post.smzdm.com/p/a5o645pl/">ÊàëÁöÑJellyfinÂΩ±ËßÜÂ∫ì Êê≠Âª∫„ÄÅ‰ø°ÊÅØÂàÆÂâäÂ∞èËÆ∞</a></li>
<li><a href="https://vagrant-up.narkive.com/5sdcgSfL/shared-folders-and-inotify-does-it-work-with-vmware-any-way-to-run-vagrant-vmware-in-trial-period">Shared folders and inotify: Does it work with VMWare + Any way to run Vagrant + VMWare in trial period?</a></li>
<li><a href="https://www.reddit.com/r/jellyfin/comments/106qtix/how_does_the_scheduled_task_for_scan_media/">How does the Scheduled Task for Scan Media Library work?</a></li>
</ul>
]]></content>
      <categories>
        <category>tech</category>
        <category>Docker</category>
        <category>NAS</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>NAS</tag>
        <tag>LANraragi</tag>
        <tag>Jellyfin</tag>
      </tags>
  </entry>
  <entry>
    <title>Install Jellyfin in Docker</title>
    <url>/en/2024/02/11/Jellyfin-Docker/</url>
    <content><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><blockquote>
<p><a href="https://jellyfin.org/">Jellyfin</a> is an open-source media server. Here is my way of using Jellyfin: download anime using qBittorrent, start Jellyfin, and then watch the anime on iPad through the client.</p>
</blockquote>
<p>Previously, I have installed the portable version of Jellyfin on Windows because a Linux virtual machine can not utilize the graphics card for hardware transcoding. However, I discovered that the Android and iOS clients support most codecs, eliminating the need for server-side transcoding. Since I am already familiar with Jellyfin‚Äôs usage and configuration, I decided to migrate it to Docker.</p>
<p>Although Jellyfin itself is cross-platform, its configuration is still OS-dependent, especially when moving from Windows to Docker. Despite the availability of a <a href="https://github.com/MMMZZZZ/Jellyfin-Migrator">third-party script</a>, I chose to reconfigure it for safety, which does not require much effort.</p>
<p>This article mainly talks about how to install Jellyfin using Docker, along with any issues encountered and their solutions.</p>
<span id="more"></span>

<h1 id="Install-Jellyfin"><a href="#Install-Jellyfin" class="headerlink" title="Install Jellyfin"></a>Install Jellyfin</h1><p>Firstly, create two volumes:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">docker volume create jellyfin-config</span><br><span class="line">docker volume create jellyfin-cache</span><br></pre></td></tr></table></figure>

<p>Docker Compose:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">jellyfin:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">jellyfin/jellyfin:10.8.13-1</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">jellyfin</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">bridge</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">58096</span><span class="string">:8096</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">58920</span><span class="string">:8920</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">jellyfin-config:/config</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">jellyfin-cache:/cache</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/mnt/hgfs/jellyfin-media:/media:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/docker/jellyfin_ssl/jellyfin.pfx:/ssl/jellyfin.pfx:ro</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">jellyfin-config:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">jellyfin-cache:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>Specify the image version; <code>10.8.13</code> is the latest stable version, and subsequent versions have the term <code>unstable</code>, so it‚Äôs best not to use <code>latest</code>.</p>
</li>
<li><p><code>8096</code> is the default HTTP port, and <code>8920</code> is the default HTTPS port.</p>
</li>
<li><p>Jellyfin uses the following paths to store data:</p>
<table>
<thead>
<tr>
<th>Directory</th>
<th>Description</th>
<th>Path</th>
</tr>
</thead>
<tbody><tr>
<td>Data Directory</td>
<td>Stores all Jellyfin data, usually referenced by other directories</td>
<td>Specified by ENV <code>JELLYFIN_DATA_DIR</code></td>
</tr>
<tr>
<td>Configuration Directory</td>
<td>Stores configuration files</td>
<td>Specified by ENV <code>JELLYFIN_CONFIG_DIR</code>; if not specified, it uses <code>&lt;Data Directory&gt;/config</code></td>
</tr>
<tr>
<td>Cache Directory</td>
<td>Stores server cache</td>
<td>Specified by ENV <code>JELLYFIN_CACHE_DIR</code>; if not specified, it uses <code>&lt;Data Directory&gt;/cache</code></td>
</tr>
<tr>
<td>Log Directory</td>
<td>Stores log files</td>
<td>Specified by ENV <code>JELLYFIN_LOG_DIR</code>; if not specified, it uses <code>&lt;Data Directory&gt;/log</code></td>
</tr>
</tbody></table>
<p>  These environment variables are specified in the <a href="https://hub.docker.com/layers/jellyfin/jellyfin/10.8.13-1/images/sha256-095e6d410d1d27b17cc4a961a9bab9fab5ffce6e49389d8ec685f65ab5538525?context=explore">Dockerfile</a>Ôºö</p>
  <figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ENV</span> DOTNET_SYSTEM_GLOBALIZATION_INVARIANT=<span class="number">1</span> LC_ALL=en_US.UTF-<span class="number">8</span> LANG=en_US.UTF-<span class="number">8</span> LANGUAGE=en_US:en JELLYFIN_DATA_DIR=/config JELLYFIN_CACHE_DIR=/cache JELLYFIN_CONFIG_DIR=/config/config JELLYFIN_LOG_DIR=/config/log JELLYFIN_WEB_DIR=/jellyfin/jellyfin-web JELLYFIN_FFMPEG=/usr/lib/jellyfin-ffmpeg/ffmpeg</span><br></pre></td></tr></table></figure>

<p>  Therefore, <strong><code>/config</code> and <code>/cache</code> contain all data of the Jellyfin server</strong>, and these directories are mounted to <code>jellyfin-config</code> and <code>jellyfin-cache</code>, respectively.</p>
</li>
<li><p><code>/mnt/hgfs/jellyfin-media:/media:ro</code>: Mount media files from the local machine into Docker, the path can be arbitrary.</p>
</li>
<li><p><code>/opt/docker/jellyfin_ssl/jellyfin.pfx</code>: Used to configure the SSL certificate for the server, which will be discussed later.</p>
</li>
<li><p><code>TZ=Asia/Shanghai</code>: Set the time zone to make the log time consistent with the local machine.</p>
</li>
</ul>
<h1 id="Jellyfin-Configuration"><a href="#Jellyfin-Configuration" class="headerlink" title="Jellyfin Configuration"></a>Jellyfin Configuration</h1><p>Since it‚Äôs a fresh installation, all configurations need to be set up again. Here are some key points.</p>
<h2 id="Server-Users"><a href="#Server-Users" class="headerlink" title="Server | Users"></a>Server | Users</h2><p>Disable transcoding: Even if the client doesn‚Äôt support the codec, server-side software decoding is not allowed, as it can lead to high pressure on the system.</p>
<p>Remove the following two options for <strong>each user</strong>:</p>
<p><img src="/en/MarkDownImages/image-20240213140202762.png" alt="image-20240213140202762"></p>
<p>For the option ‚ÄòAllow video playback that requires conversion without re-encoding‚Äô, many articles recommend disabling it, but it seems to have no impact, so it can be left enabled.</p>
<h2 id="Advanced-Networking"><a href="#Advanced-Networking" class="headerlink" title="Advanced | Networking"></a>Advanced | Networking</h2><p>Select the mounted <code>jellyfin.pfx</code> file as the SSL certificate (how to generate this file is explained later):</p>
<p><img src="/en/MarkDownImages/image-20240213140616778.png" alt="image-20240213140616778"></p>
<p>Check ‚ÄòEnable HTTPS‚Äô and restart the container.</p>
<p><img src="/en/MarkDownImages/image-20240213140600270.png" alt="image-20240213140600270"></p>
<p>There‚Äôs no need to enable ‚ÄòForce HTTPS‚Äô because the firewall will only allow devices on the local network to access the HTTPS port; the local machine can still access Jellyfin via HTTP.</p>
<h1 id="SSL-Certificate"><a href="#SSL-Certificate" class="headerlink" title="SSL Certificate"></a>SSL Certificate</h1><p>Firstly, you need the private key <code>jellyfin-priv-key.key</code> and the certificate <code>jellyfin.crt</code> (refer to the <a href="/en/2024/01/31/Docker-Nginx-SSL-Local-Network/#SSL-Certificate">previous article</a>).</p>
<p>Then, use the following command to generate the <code>.pfx</code> file:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -<span class="built_in">export</span> -out jellyfin.pfx -inkey jellyfin-priv-key.key -<span class="keyword">in</span> jellyfin.crt  -passout pass:</span><br></pre></td></tr></table></figure>

<h1 id="Local-Network-Settings"><a href="#Local-Network-Settings" class="headerlink" title="Local Network Settings"></a>Local Network Settings</h1><blockquote>
<p>Here is my network topology:</p>
<p>Windows host with a Linux virtual machine installed by VMware, and Docker runs on this virtual machine.</p>
<p>The host and other devices share the home network.</p>
</blockquote>
<p>Previously, when running Jellyfin on Windows, I allowed Jellyfin‚Äôs direct access to the home network. That is, the firewall rules were authorized for the Jellyfin executable rather than a specific port.</p>
<p>Now, with Docker, the following changes are made:</p>
<ol>
<li><p>Add a NAT mapping for the virtual machine, mapping Linux‚Äôs 58920 to the host‚Äôs 58920 port.</p>
<p> <img src="/en/MarkDownImages/image-20240213141926681.png" alt="image-20240213141926681"></p>
</li>
<li><p>Add a firewall inbound rule: <code>58920/tcp</code> for the private network.</p>
</li>
<li><p>Reconnect all client devices to the new server.</p>
</li>
</ol>
<hr>
<p>Jellyfin on Windows had port 58920 open, and after switching to the Docker version, it still uses the same port. We can access the web client through <code>https://hostIP:58920</code> in a browser. This ‚Äòtricks‚Äô Google Password Manager in some sense, allowing me to directly use the previous account and password.</p>
<h1 id="Some-Bugs"><a href="#Some-Bugs" class="headerlink" title="Some Bugs"></a>Some Bugs</h1><h2 id="Font-Issue"><a href="#Font-Issue" class="headerlink" title="Font Issue"></a>Font Issue</h2><p>After creating the container, enter the container and execute the following command:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">apt update &amp;&amp; apt install fonts-noto-cjk-extra</span><br></pre></td></tr></table></figure>

<p>Then restart the container.</p>
<p>Otherwise, Chinese characters on the media library cover images appear as squares.</p>
<h2 id="Symbolic-Links"><a href="#Symbolic-Links" class="headerlink" title="Symbolic Links"></a>Symbolic Links</h2><p>On Windows, we can create links using the <code>mklink</code> command. When running Jellyfin on Windows, to prevent Jellyfin from modifying the media directory, I used the <a href="https://github.com/el-nino2020/script-house/blob/main/script_house/FileSystemOperation.py#L125"><code>walk_while_link</code> function</a> to create symbolic links for each video file. However, shared folders in virtual machines can be set to read-only, and volumes can also be set to read-only, so there‚Äôs no need to do this in Docker.</p>
<p>Moreover, creating symbolic links this way causes videos to be unplayable, and Jellyfin reports errors when reading media data. I suspect this is due to symbolic links because many articles about NAS use hard links rather than symbolic links. However, I don‚Äôt prefer using hard links, especially on Windows.</p>
<p>Creating symbolic links for folders is still possible. For example, if the shared folder is <code>jellyfin-docker-media</code>, you can create symbolic links for the <code>films</code> and <code>animes</code> folders in other paths, putting them all under <code>jellyfin-docker-media</code>. This essentially adds an extra layer of abstraction and reduces the number of shared folders for the virtual machine.</p>
<p>In fact, this is what I did. The <code>/mnt/hgfs/jellyfin-media</code> in Docker-compose is the host‚Äôs <code>jellyfin-docker-media</code> shared folder.</p>
<h1 id="Docker-Knowledge"><a href="#Docker-Knowledge" class="headerlink" title="Docker Knowledge"></a>Docker Knowledge</h1><p>By installing Jellyfin, I deepened my understanding of Docker through practical experiences.</p>
<h2 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE"></a>EXPOSE</h2><p>I always thought that using the <code>EXPOSE</code> keyword in the Dockerfile was necessary for mapping ports when starting a container. However, that‚Äôs not the case.</p>
<blockquote>
<p>The <code>EXPOSE</code> instruction <strong>informs</strong> Docker that the container listens on the specified network ports at runtime. You can specify whether the port listens on TCP or UDP, and the default is TCP if you don‚Äôt specify a protocol.</p>
<p>The <code>EXPOSE</code> instruction <strong>doesn‚Äôt actually publish the port</strong>. It functions as a type of <strong>documentation</strong> between the person who builds the image and the person who runs the container, about which ports are intended to be published. To publish the port when running the container, use the <code>-p</code> flag on <code>docker run</code> to publish and map one or more ports, or the <code>-P</code> flag to publish all exposed ports and map them to high-order ports.</p>
</blockquote>
<p>These two paragraphs are excerpted from the official documentation. <code>EXPOSE</code> is merely a declarative instruction, and it‚Äôs the <code>-p</code> option that truly maps the container‚Äôs ports. This mapping can be done freely, without any restrictions.</p>
<p>Therefore, the approach I took in <a href="/en/2024/01/31/Docker-Nginx-SSL-Local-Network/#Nginx-Container">‚ÄòDeploying Nginx in Docker and Configuring SSL Certificate for Local Network‚Äô</a> is meaningless. There‚Äôs no need to create a new image just for <code>EXPOSE</code>.</p>
<blockquote>
<figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nginx:<span class="number">1.24</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">443</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="Cache-Memory"><a href="#Cache-Memory" class="headerlink" title="Cache Memory"></a>Cache Memory</h2><p>In Portainer statistics, you can see that memory usage is divided into ‚ÄòMemory‚Äô and ‚ÄòCache‚Äô. What do these two terms mean? Which one represents the current memory usage?</p>
<p><img src="/en/MarkDownImages/image-20240213085846776.png" alt="image-20240213085846776"></p>
<p>In simple words, ‚ÄòMemory‚Äô represents the current memory usage, while ‚ÄòCache‚Äô represents memory that <strong>was previously used</strong>. Memory Cache is a term in Docker, and its value is equal to the value of <code>Inactive(file)</code> in <code>/proc/meminfo</code>.</p>
<blockquote>
<p><code>Inactive(file)</code> ‚Äî The amount of file cache memory, in kibibytes, that is newly loaded from the disk, or is a candidate for reclaiming.</p>
</blockquote>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://zhuanlan.zhihu.com/p/624670198">Âú®Docker‰∏ãÂÆâË£ÖJellyfinÂπ∂Ê≠£Á°ÆÂºÄÂêØÁ°¨‰ª∂Ëß£Á†Å</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/640489824">DockerÈÉ®ÁΩ≤ÂºÄÊ∫êÊµÅÂ™í‰ΩìËΩØ‰ª∂Jellyfin</a></li>
<li><a href="https://jellyfin.org/docs/general/installation/container#using-docker-compose">Jellyfin doc installation</a></li>
<li><a href="https://jellyfin.org/docs/general/networking/#self-signed-certificate">Jellyfin doc self-signed certificate</a></li>
<li><a href="https://docs.docker.com/engine/reference/builder/#expose">Docker doc EXPOSE</a></li>
<li><a href="https://www.reddit.com/r/portainer/comments/w6pvit/what_is_memory_cache_in_the_container_stats/">What is memory ‚Äúcache‚Äù in the container stat‚Äôs?</a></li>
</ul>
]]></content>
      <categories>
        <category>tech</category>
        <category>Docker</category>
        <category>NAS</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>NAS</tag>
        <tag>Jellyfin</tag>
      </tags>
  </entry>
  <entry>
    <title>HexoËá™ÂÆö‰πâ404È°µÈù¢</title>
    <url>/en/2023/07/04/Hexo-custom-404/</url>
    <content><![CDATA[<h1 id="Ëá™ÂÆö‰πâ-404-È°µÈù¢"><a href="#Ëá™ÂÆö‰πâ-404-È°µÈù¢" class="headerlink" title="Ëá™ÂÆö‰πâ 404 È°µÈù¢"></a>Ëá™ÂÆö‰πâ 404 È°µÈù¢</h1><p>È¶ñÂÖàÔºåÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ <code>404</code> ÁöÑ post</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">hexo new <span class="number">404</span></span><br></pre></td></tr></table></figure>

<p>Âú®ÂØπÂ∫îÁöÑ md Êñá‰ª∂‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™ÂÆö‰πâ 404 È°µÈù¢„ÄÇÁî±‰∫é Hexo Ê°ÜÊû∂ÁöÑÁâπÊÄßÔºåÊàë‰ª¨ÂèØ‰ª•ÁºñÂÜô JS ËÑöÊú¨ÔºåËÆ©È°µÈù¢Âä®Ëµ∑Êù•„ÄÇ</p>
<p>ËøôÈáåÁªôÂá∫<a href="/404" target="_blank">ÊàëÁöÑ 404 È°µÈù¢</a>„ÄÇÂèØ‰ª•ÁúãÂà∞Ôºå‰∏äÈù¢Êúâ‰∏Ä‰∏™ÂÄíËÆ°Êó∂„ÄÇÂΩìÂÄíËÆ°Êó∂‰∏∫ 0 Êó∂Ôºå‰ºöËá™Âä®Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ„ÄÇÂΩìÁÑ∂ÔºåÁî®Êà∑‰πüÂèØ‰ª•ÊâãÂä®ÁÇπÂáªÔºå‰ªéËÄåËøîÂõûÈ¶ñÈ°µ„ÄÇ</p>
<p>‰∏ãÈù¢ÊòØÂØπÂ∫îÁöÑ‰ª£Á†ÅÔºåÁõ¥Êé•ÊîæÂú® md Êñá‰ª∂‰∏≠Âç≥ÂèØÔºö</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./../js/jquery-3.3.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span>ÊÇ®Ê≠£Âú®ËÆøÈóÆ‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÂú∞ÂùÄü§î<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span>Á≥ªÁªü‰ºöÂú® <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;seconds&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">span</span>&gt;</span> ÁßíÂêéËá™Âä®Ë∑≥ËΩ¨Âà∞È¶ñÈ°µ,<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span> ÊÇ®‰πüÂèØ‰ª•ÁÇπÊ≠§ <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">&quot;_self&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> &gt;</span>ÈìæÊé•<span class="tag">&lt;/<span class="name">a</span>&gt;</span>, ÊâãÂä®Ë∑≥ËΩ¨!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    $(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> seconds = $(<span class="string">&quot;#seconds&quot;</span>).<span class="title function_">text</span>();</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&quot;#seconds&quot;</span>).<span class="title function_">text</span>(--seconds);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (seconds == <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                location.<span class="property">href</span> = <span class="string">&quot;/&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;, <span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ÊàëÈÄâÊã©Â∞Ü jQuery ‰ª£Á†ÅÊîæÂú®Êú¨Âú∞ÔºåËøôÊ†∑È°µÈù¢ÂìçÂ∫îÊõ¥Âø´„ÄÇ</p>
<p>jQuery Âú®ËøôÈáåÂè™ÊòØÁî®‰∫éËé∑Âèñ DOM ÂØπË±°ÔºåÂõ†Ê≠§‰πüÂÆåÂÖ®ÂèØ‰ª•Áî®ÂéüÁîü JS ÂáΩÊï∞Êù•ÂÜô„ÄÇ</p>
<h1 id="Â¶Ç‰ΩïËÆ©ÁΩëÁ´ôË∑≥ËΩ¨Âà∞Ëá™ÂÆö‰πâÈ°µÈù¢Ôºü"><a href="#Â¶Ç‰ΩïËÆ©ÁΩëÁ´ôË∑≥ËΩ¨Âà∞Ëá™ÂÆö‰πâÈ°µÈù¢Ôºü" class="headerlink" title="Â¶Ç‰ΩïËÆ©ÁΩëÁ´ôË∑≥ËΩ¨Âà∞Ëá™ÂÆö‰πâÈ°µÈù¢Ôºü"></a>Â¶Ç‰ΩïËÆ©ÁΩëÁ´ôË∑≥ËΩ¨Âà∞Ëá™ÂÆö‰πâÈ°µÈù¢Ôºü</h1><span id="more"></span>

<p>Ê≥®ÊÑèÔºö‰ª•‰∏ãÊñπÊ≥ï‰ªÖÈôê‰∫é Github PagesÔºåÂÖ∂‰ªñÂπ≥Âè∞ÁöÑÊñπÂºèÂèØËÉΩ‰∏çÂêå„ÄÇ</p>
<p>Âú®<code>front-matter</code>‰∏≠Ê∑ªÂä†Â¶Ç‰∏ãÂÜÖÂÆπÔºåGithub Pages Â∞±ËÉΩËÆæÁΩÆËØ•È°µÈù¢‰∏∫ 404 È°µÈù¢</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">permalink:</span> <span class="string">/404.html</span></span><br></pre></td></tr></table></figure>

<p>‰∏çÂ¶®ÈöèÊú∫ËÆøÈóÆ‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÁΩëÈ°µÔºüÁúãÁúãÊïàÊûúÂ¶Ç‰ΩïÔºö‚ñ∂ <a href="/hsfh/40u235u/jasdlafn" target="_blank">ÁÇπÊàë</a></p>
<h1 id="ÂèÇËÄÉÊñáÁ´†"><a href="#ÂèÇËÄÉÊñáÁ´†" class="headerlink" title="ÂèÇËÄÉÊñáÁ´†"></a>ÂèÇËÄÉÊñáÁ´†</h1><p><a href="https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-custom-404-page-for-your-github-pages-site">Creating a custom 404 page for your GitHub Pages site</a></p>
<p><a href="https://theme-next.js.org/docs/theme-settings/custom-pages.html#Custom-404-Page">theme-next: custom-pages</a></p>
]]></content>
      <categories>
        <category>softwares</category>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>LANraragi Manga Server</title>
    <url>/en/2024/01/25/LANraragi-manga-server/</url>
    <content><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>Recently, I‚Äôve been looking into home media libraries, and most tutorials focus on NAS, but most of the applications actually run on Docker.</p>
<p>Now, I have the following demands for reading manga&#x2F;doujinshi:</p>
<ul>
<li>I have a large collection of manga archives on my computer and want various devices able to access these resources. ‚Äî‚Äî A server capable of transmitting images via HTTP.</li>
<li>I want to manage the manga directory according to my preferences, not the rules of the server software.</li>
<li>When browsing manga on my phone&#x2F;tablet, I want an easy-to-use interface. ‚Äî‚Äî A user-friendly client or a Web UI.</li>
<li>The client should have a random manga selection feature. ‚Äî‚Äî Due to the abundance of collected manga, randomly picking one for leisure is the most convenient.</li>
</ul>
<p>Considering these, I chose <a href="https://github.com/Difegue/LANraragi">LANraragi</a>. Although <a href="https://komga.org/">Komga</a>, <a href="https://www.kavitareader.com/#home">Kavita</a>, and <a href="https://github.com/Suwayomi/Tachidesk-Sorayomi">Tachidesk (Sorayomi)</a> are also open-source manga servers, they didn‚Äôt quite meet my expectations.</p>
<p>This article includes some excerpts from the official documentation and my own insights.</p>
<span id="more"></span>

<h1 id="LANraragi"><a href="#LANraragi" class="headerlink" title="LANraragi"></a>LANraragi</h1><p>LANraragi offers many features, but I only need a few of them:</p>
<table>
<thead>
<tr>
<th>Features</th>
<th>Required</th>
</tr>
</thead>
<tbody><tr>
<td>Upload local manga</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Download online manga</td>
<td>‚ùå</td>
</tr>
<tr>
<td>Adding metadata (tagging)</td>
<td>‚ùå</td>
</tr>
</tbody></table>
<p>All manga are uploaded locally by me. I just want to read manga and don‚Äôt need to categorize them with tags.</p>
<h1 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h1><p>Docker compose:</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">lanraragi:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">difegue/lanraragi:v.0.9.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">lanraragi</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">43000</span><span class="string">:3000</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/mnt/hgfs/doujinshiArchives:/home/koyomi/lanraragi/content:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">lanraragi-database:/home/koyomi/lanraragi/database</span></span><br><span class="line">        </span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">lanraragi-database:</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>/home/koyomi/lanraragi/database</code> is the directory where LANraragi stores Redis data. Just create a volume for it.</li>
<li>The <code>/home/koyomi/lanraragi/content</code> directory stores:<ul>
<li>All manga archives. LANraragi can recursively scan subdirectories ‚Äî‚Äî file management is based on my preferences.</li>
<li>Thumbnails of manga, by default stored in <code>/home/koyomi/lanraragi/content/thumb</code>.</li>
</ul>
</li>
<li>Since the thumbnail directory can be configured, the <code>content</code> directory only contains my own archives. I set permissions to read-only and map the host directory where manga files are stored. LANraragi detects file changes on its own, and I can collect mangas just like before.</li>
</ul>
<hr>
<ul>
<li>Using Docker Compose allows for recording the startup command, making it convenient for reuse later.</li>
<li>Stack in Portainer is a synonym for Docker Compose. After modifying Docker-compose file, Portainer will redeploy it, which is convenient. (Essentially, it‚Äôs a combination of <a href="https://docs.docker.com/engine/reference/commandline/compose_down/">down</a> + up, but data won‚Äôt be lost because they are stored in volumes.)</li>
</ul>
<h1 id="Configurations"><a href="#Configurations" class="headerlink" title="Configurations"></a>Configurations</h1><p>On the first launch, the admin password is <code>kamimamita</code>. After logging in, go to the configuration page:</p>
<p><img src="/en/MarkDownImages/image-20240125195217045.png" alt="image-20240125195217045"></p>
<p>Firstly, a reminder: don‚Äôt forget to save your configuration changes:</p>
<p><img src="/en/MarkDownImages/image-20240125200813922.png" alt="image-20240125200813922"></p>
<p>Start by changing the initial password:</p>
<p><img src="/en/MarkDownImages/image-20240125195247264.png" alt="image-20240125195247264"></p>
<p>Other configurations are as follows:</p>
<h2 id="Global-Settings"><a href="#Global-Settings" class="headerlink" title="Global Settings"></a>Global Settings</h2><p><img src="/en/MarkDownImages/image-20240125195357388.png" alt="image-20240125195357388"></p>
<ul>
<li>Set <code>Archives per page</code> to 20; a default of 100 is too many.</li>
<li>The reading history feature is not needed, so I store them on the client side to save server resources.</li>
</ul>
<h2 id="Archive-Files"><a href="#Archive-Files" class="headerlink" title="Archive Files"></a>Archive Files</h2><p>No need to change.</p>
<p><img src="/en/MarkDownImages/image-20240125195541509.png" alt="image-20240125195541509"></p>
<h2 id="Tags-and-Thumbnails"><a href="#Tags-and-Thumbnails" class="headerlink" title="Tags and Thumbnails"></a>Tags and Thumbnails</h2><p><img src="/en/MarkDownImages/image-20240125195742625.png" alt="image-20240125195742625"></p>
<ul>
<li>The point here is to change the thumbnail directory, due to the read-only mapping during Docker startup and the default thumbnail directory in <code>content</code>.</li>
<li>Turn off the two options related to tags.</li>
</ul>
<h2 id="Background-Workers"><a href="#Background-Workers" class="headerlink" title="Background Workers"></a>Background Workers</h2><p><img src="/en/MarkDownImages/image-20240125200521462.png" alt="image-20240125200521462"></p>
<p>This is used to monitor changes in manga archives in the <code>content</code> directory. If new resources are not processed promptly, a manual restart may be needed.</p>
<h2 id="Plugin-Configuration"><a href="#Plugin-Configuration" class="headerlink" title="Plugin Configuration"></a>Plugin Configuration</h2><p><img src="/en/MarkDownImages/image-20240125200854396.png" alt="image-20240125200854396"></p>
<p>Turn this off as it‚Äôs not needed.</p>
<p>All plugins are disabled by default, So you may leave this setting as before.</p>
<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>When mounting your own manga archives for the first time in the <code>content</code> directory, LANraragi requires significant resources to process metadata and thumbnails. According to Portainer‚Äôs monitoring data, it used 2-3GB of memory and 2000% CPU (not quite sure how this CPU resource is calculated).</p>
<p>Functions on the homepage:</p>
<ul>
<li>Search;</li>
<li>Display random mangas each time;</li>
<li>List mode &#x2F; thumbnail mode.</li>
</ul>
<p>Reader configuration:</p>
<p>1Ô∏è‚É£ Default is pagination mode.</p>
<p>2Ô∏è‚É£ I prefer infinite scrolling mode:</p>
<p><img src="/en/MarkDownImages/image-20240125201748231.png" alt="image-20240125201748231"></p>
<h1 id="Sharing-With-Other-Devices"><a href="#Sharing-With-Other-Devices" class="headerlink" title="Sharing With Other Devices"></a>Sharing With Other Devices</h1><p>My Docker runs in a Linux virtual machine, and due to Docker port mapping, LANraragi can be accessed on the host machine through the virtual machine‚Äôs IP.</p>
<h2 id="Virtual-Machine-NAT-Passthrough"><a href="#Virtual-Machine-NAT-Passthrough" class="headerlink" title="Virtual Machine NAT Passthrough"></a>Virtual Machine NAT Passthrough</h2><p>To access LANraragi from other devices, NAT passthrough is needed to map the virtual machine‚Äôs port to the host‚Äôs port:</p>
<p><img src="/en/MarkDownImages/image-20240125202125135.png" alt="image-20240125202125135"></p>
<p><img src="/en/MarkDownImages/image-20240125202155268.png" alt="image-20240125202155268"></p>
<p><img src="/en/MarkDownImages/image-20240125202344077.png" alt="image-20240125202344077"></p>
<p>As configured in the images, map port 43000 on the virtual machine to port 43000 on the host.</p>
<h2 id="Local-Firewall"><a href="#Local-Firewall" class="headerlink" title="Local Firewall"></a>Local Firewall</h2><p>Windows Firewall will block this port by default, so configure a new rule:</p>
<p><img src="/en/MarkDownImages/image-20240125202513739.png" alt="image-20240125202513739"></p>
<p><img src="/en/MarkDownImages/image-20240125202536458.png" alt="image-20240125202536458"></p>
<p><img src="/en/MarkDownImages/image-20240125202641453.png" alt="image-20240125202641453"></p>
<p>Create a new rule in inbound rules: open port 43000&#x2F;tcp for private networks (home networks).</p>
<p>Afterward, you can access LANraragi from your phone via <code>computerIP:43000</code>.</p>
<p>The homepage of the mobile web UI is not great, but you can use the <a href="https://sugoi.gitbook.io/lanraragi/advanced-usage/external-readers">officially recommended client</a>. However, since I only want to read randomly, it‚Äôs not a big issue. And the interface for reading manga is handy, So I will take it.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://sugoi.gitbook.io/lanraragi/">LANraragi Official Documentation</a></li>
</ul>
]]></content>
      <categories>
        <category>tech</category>
        <category>Docker</category>
        <category>NAS</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>NAS</tag>
        <tag>LANraragi</tag>
      </tags>
  </entry>
  <entry>
    <title>LocalSendÔºöÂ±ÄÂüüÁΩëÊñá‰ª∂‰º†ËæìÂà©Âô®</title>
    <url>/en/2023/09/04/LocalSend-A-powerful-tool-for-local-file-transfer/</url>
    <content><![CDATA[<h1 id="Â∫èË®Ä"><a href="#Â∫èË®Ä" class="headerlink" title="Â∫èË®Ä"></a>Â∫èË®Ä</h1><p>ÊúÄËøëÂáÜÂ§áÈáçË£ÖÁ¨îËÆ∞Êú¨ÁöÑÁ≥ªÁªüÔºåÂõ†Ê≠§Ë¶ÅÂ§á‰ªΩÊñá‰ª∂ÔºåÂ≠òÂà∞Âè∞ÂºèÊú∫Èáå„ÄÇÊàëÂ∞ÜË¶ÅÂ§á‰ªΩÁöÑÊñá‰ª∂Â§πÂéãÁº©ÔºåÈÄöËøá Windows Ëá™Â∏¶ÁöÑÊñá‰ª∂Â§πÂÖ±‰∫´ÔºàÂ±ÄÂüüÁΩëÂÖ±‰∫´ÔºâÔºå‰º†ËæìËøô‰∫õÂéãÁº©ÂåÖ„ÄÇ</p>
<p>‰ΩÜÊòØÔºå‰º†ËæìËøáÁ®ãÂç¥ÈùûÂ∏∏Ëâ∞Èöæ„ÄÇÊúâÁöÑÂéãÁº©ÂåÖÊúâ 10 Âá†‰∏™ GBÔºå‰º†‰∫Ü‰∏ÄÂàÜÈíüÔºåÁΩëÈÄüÂ∞±Ê≤°‰∫ÜÔºå‰πãÂêéÂ∞±ÂºÄÂßãÊä•Ë∂ÖÊó∂‰πãÁ±ªÁöÑÈîôËØØ„ÄÇÊõ¥Á¶ªË∞±ÁöÑÊòØÔºåÊúâ‰∏™ÂéãÁº©ÂåÖÂú®‰∏§Âè∞ÁîµËÑë‰∏ä<a href="#%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%A0%A1%E9%AA%8C">ÊëòË¶ÅÁÆóÊ≥ï</a>ÁöÑÁªìÊûú‰∏çÂêå„ÄÇ</p>
<p>ÊòæÁÑ∂Ôºåwindows SMB ÂçèËÆÆÊó¢‰∏çËÉΩ‰øùËØÅÈÄüÂ∫¶Ôºå‰πü‰∏çËÉΩ‰øùËØÅÊï∞ÊçÆÊ≠£Á°ÆÊÄßÔºå‰∫éÊòØÊàëÂºÄÂßãÂØªÊâæÊõ¥Âä†Â•ΩÁî®ÁöÑÂ±ÄÂüüÁΩë‰º†ËæìËΩØ‰ª∂„ÄÇÂÆÉÔºåÂ∞±ÊòØÊú¨ÊñáÁöÑ‰∏ªËßí ‚Äî‚Äî LocalSend</p>
<span id="more"></span>

<h1 id="LocalSend-‰ªãÁªç"><a href="#LocalSend-‰ªãÁªç" class="headerlink" title="LocalSend ‰ªãÁªç"></a>LocalSend ‰ªãÁªç</h1><p>LocalSend ÊòØ‰∏Ä‰∏™<strong>Ë∑®Âπ≥Âè∞</strong>ÁöÑÂ±ÄÂüüÁΩë‰º†ËæìËΩØ‰ª∂ÔºåÊîØÊåÅ Windows, Linux, macOS, Android Âíå IOS. ËøôÊòØÂÆÉÁöÑ<a href="https://localsend.org/#/">ÂÆòÁΩë</a>ÔºõËøôÊòØÂÆÉÁöÑ <a href="https://github.com/localsend/localsend">GitHub ‰ªìÂ∫ì</a></p>
<p>‰ΩúËÄÖËÆæËÆ°‰∫Ü‰∏Ä‰∏™Âü∫‰∫é HTTP ÁöÑ‰º†ËæìÂçèËÆÆÔºåÂú®<a href="https://github.com/localsend/protocol">ËøôÈáå</a></p>
<p>LocalSend Âü∫Êú¨‰∏äÊòØÂºÄÁÆ±Âç≥Áî®ÔºåÊ≤°ÂøÖË¶Å‰∏ìÈó®ÂÜô‰∏ÄËäÇ quickstart</p>
<p>‰ΩÜÊòØÔºåÁî±‰∫é Windows Èò≤ÁÅ´Â¢ôÁöÑÈªòËÆ§ÈÖçÁΩÆÔºåÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®ËØ•ËΩØ‰ª∂Êó∂ÔºåÂêåÂ±ÄÂüüÁΩëÂÜÖÁöÑËÆæÂ§áÂèØËÉΩÊó†Ê≥ïÂèëÁé∞ËøôÂè∞ Windows ËÆæÂ§á„ÄÇ‰∏ãÈù¢ÔºåÊàëÂ∞ÜÁªôÂá∫Ëß£ÂÜ≥ÊñπÊ°à„ÄÇ</p>
<h1 id="Èò≤ÁÅ´Â¢ôÈÖçÁΩÆ"><a href="#Èò≤ÁÅ´Â¢ôÈÖçÁΩÆ" class="headerlink" title="Èò≤ÁÅ´Â¢ôÈÖçÁΩÆ"></a>Èò≤ÁÅ´Â¢ôÈÖçÁΩÆ</h1><h2 id="ÊàëÁöÑÊñπÊ°à"><a href="#ÊàëÁöÑÊñπÊ°à" class="headerlink" title="ÊàëÁöÑÊñπÊ°à"></a>ÊàëÁöÑÊñπÊ°à</h2><ol>
<li><p>Â∞ÜÂÆ∂Â∫≠ WIFI ËÆæÁΩÆ‰∏∫‰∏ìÁî®ÁΩëÁªúÔºà‰∏çÂª∫ËÆÆÂú®ÂÖ¨ÂÖ±ÁΩëÁªú‰ΩøÁî®Â±ÄÂüüÁΩë‰º†ËæìÊñá‰ª∂ÔºåÊó†ËÆ∫ËΩØ‰ª∂‰ΩúËÄÖÂÅö‰∫ÜÊÄéÊ†∑ÁöÑÂä†ÂØÜÔºåÊàëÈÉΩËÆ§‰∏∫ÊòØ‰∏çÂÆâÂÖ®ÁöÑ„ÄÇÂõ†Ê≠§ÔºåËøôÈáå‰∏çËÆ®ËÆ∫ÂÖ¨Áî®ÁΩëÁªúÁöÑÊÉÖÂÜµÔºâ<img src="/en/MarkDownImages/image-20230904212558782.png" alt="image-20230904212558782"></p>
</li>
<li><p>ËøõÂÖ•„ÄéÈÖçÁΩÆÈò≤ÁÅ´Â¢ôÂíåÂÆâÂÖ®ËÆæÁΩÆ„Äè</p>
<p> <img src="/en/MarkDownImages/image-20230904212718315.png" alt="image-20230904212718315"></p>
</li>
<li><p>„ÄéÂÖÅËÆ∏Â∫îÁî®ÈÄöËøáÈò≤ÁÅ´Â¢ô„Äè‚Äî‚Äî„ÄéÊõ¥ÊîπÈÖçÁΩÆ„Äè„ÄÇÊâæÂà∞ <code>localsend_app</code>ÔºàÂÖ∂‰ªñ‰ª•<code>localsend</code>ÂºÄÂ§¥ÁöÑ‰πüÂèØ‰ª•ËøôÊ†∑ÂÅöÔºâÔºåÂ∞ÜÂÆÉ‰πãÂâçÈÇ£ÁöÑÂçïÈÄâÊ°ÜÈÄâ‰∏ä„ÄÇ‰ª•Èò≤‰∏á‰∏ÄÔºåÁ°Æ‰øù‰πãÂêéÁöÑ‰∏§‰∏™ÂçïÈÄâÊ°Ü‰πüÊòØÈÄâ‰∏äÁöÑÔºàÂ∫îËØ•ÊòØÈªòËÆ§ÂºÄÂêØÁöÑÔºâ„ÄÇÁÑ∂ÂêéÁÇπÂáª„ÄéÁ°ÆÂÆö„Äè</p>
<p> <img src="/en/MarkDownImages/image-20230904212911221.png" alt="image-20230904212911221"></p>
</li>
<li><p>ÈáçÂêØ LocalSendÔºåÁ≠âÂæÖÊâæÂà∞ÁõÆÊ†á‰∏ªÊú∫</p>
</li>
</ol>
<h2 id="ÁΩë‰∏äÁöÑÊñπÊ°àÔºàÊú™È™åËØÅÔºâ"><a href="#ÁΩë‰∏äÁöÑÊñπÊ°àÔºàÊú™È™åËØÅÔºâ" class="headerlink" title="ÁΩë‰∏äÁöÑÊñπÊ°àÔºàÊú™È™åËØÅÔºâ"></a>ÁΩë‰∏äÁöÑÊñπÊ°àÔºàÊú™È™åËØÅÔºâ</h2><p>ËøôÈáå‰πüÁªôÂá∫ÁΩë‰∏äÂÖ∂‰ªñ‰∫∫ÁöÑËß£ÂÜ≥ÊñπÊ≥ïÔºåËôΩÁÑ∂ÊàëËßâÂæóÂÖ®Â±ÄÊìç‰ΩúÈò≤ÁÅ´Â¢ô<strong>Âæà‰∏çÂÆâÂÖ®</strong>„ÄÇ</p>
<ol>
<li><p>ÊâìÂºÄ„ÄéWindows Defender Èò≤ÁÅ´Â¢ô„Äè</p>
<p> <img src="/en/MarkDownImages/image-20230904213446263.png" alt="image-20230904213446263"></p>
</li>
<li><p>„ÄéÈ´òÁ∫ßËÆæÁΩÆ„Äè‚Äî‚Äî„ÄéWindows Èò≤ÁÅ´Â¢ôÂ±ûÊÄß„Äè„ÄÇÂú®„Äé‰∏ìÁî®ÈÖçÁΩÆÊñá‰ª∂„Äè‰∏ÄÊ†èÔºåÂ∞Ü„ÄéÂÖ•Á´ôËøûÊé•„ÄèÊîπ‰∏∫„ÄéÂÖÅËÆ∏„ÄèÔºåÁÑ∂Âêé„ÄéÂ∫îÁî®„Äè</p>
<p> <img src="/en/MarkDownImages/image-20230904213728952.png" alt="image-20230904213728952"></p>
</li>
<li><p>ÈáçÂêØ LocalSendÔºåÊü•ÁúãËÉΩÂê¶ÊâæÂà∞ÁõÆÊ†á‰∏ªÊú∫„ÄÇÂ¶ÇÊûú‰∏çË°åÔºåÂÜçÂ∞Ü‰∏äËø∞„ÄéÂÖ¨Áî®ÈÖçÁΩÆÊñá‰ª∂„Äè‰∏ÄÊ†èÁöÑ„ÄéÂÖ•Á´ôËøûÊé•„ÄèÊîπ‰∏∫„ÄéÂÖÅËÆ∏„ÄèÔºåÁÑ∂Âêé„ÄéÂ∫îÁî®„ÄèÔºåÂÜçÊ¨°ÈáçÂêØ LocalSend Âπ∂Ê£ÄÈ™å„ÄÇ</p>
</li>
</ol>
<h1 id="Êñá‰ª∂‰º†ËæìÊ†°È™å"><a href="#Êñá‰ª∂‰º†ËæìÊ†°È™å" class="headerlink" title="Êñá‰ª∂‰º†ËæìÊ†°È™å"></a>Êñá‰ª∂‰º†ËæìÊ†°È™å</h1><p>Âú®ÁΩëÁªú‰º†ËæìÊñá‰ª∂ÂêéÔºåÈÄöÂ∏∏Ë¶Å‰ΩøÁî®ÊëòË¶ÅÁÆóÊ≥ïÔºàMD5„ÄÅSHA1„ÄÅSHA256Á≠âÔºâÂØπÊØî‰∏§‰ªΩÊñá‰ª∂ÊòØÂê¶‰∏ÄËá¥ÔºåÈò≤Ê≠¢Áî±‰∫éÁΩëÁªúÂØºËá¥ÁöÑÊï∞ÊçÆ‰∏¢Â§±„ÄÇÂæàÂ§öÁé∞ÊàêÁöÑÂ∑•ÂÖ∑Êèê‰æõËøôÊ†∑ÁöÑÊúçÂä°ÔºåËøôÈáåÊàë‰ªãÁªç 3 ‰∏™„ÄÇ</p>
<h2 id="7-zip"><a href="#7-zip" class="headerlink" title="7-zip"></a>7-zip</h2><p>7-zip ËôΩÁÑ∂ÊòØ‰∏Ä‰∏™ÂºÄÊ∫êÁöÑÂéãÁº©ËΩØ‰ª∂Ôºå‰ΩÜ‰πüÊèê‰æõÊëòË¶ÅÂáΩÊï∞„ÄÇ</p>
<p>Âè≥ÈîÆÈÄâ‰∏≠Ë¶ÅÊëòË¶ÅÁöÑÊñá‰ª∂ÔºåÁÇπÂáª„ÄéCRC SHA„ÄèÔºåÈÄâÊã©ÊëòË¶ÅÁÆóÊ≥ï</p>
<p><img src="/en/MarkDownImages/image-20230904214607556.png" alt="image-20230904214607556"></p>
<p>Â¶ÇÊûúÂè≥ÈîÆËèúÂçïÊ≤°ÊúâËØ•ÈÄâÈ°πÔºåÂú® 7-zip ‰∏≠ÈÖçÁΩÆÂç≥ÂèØÔºö</p>
<p><img src="/en/MarkDownImages/image-20230904214947662.png" alt="image-20230904214947662"></p>
<h2 id="openssl"><a href="#openssl" class="headerlink" title="openssl"></a>openssl</h2><p>Linux Â§ßÂ§öÊï∞ÂèëË°åÁâàÈÉΩ‰ºöËá™Â∏¶ÁöÑÂ∑•ÂÖ∑„ÄÇ‰πüÂèØ‰ª•Âú® git bash ‰∏≠‰ΩøÁî®Ëøô‰∏™ÂëΩ‰ª§„ÄÇËØ≠Ê≥ïÊòØÔºö</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">openssl ÊëòË¶ÅÁÆóÊ≥ïÂêç Êñá‰ª∂Ë∑ØÂæÑ</span><br></pre></td></tr></table></figure>

<p>‰æãÂ≠êÔºö</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">Elnino@PC MINGW64 ~/Desktop</span><br><span class="line">$ openssl sha256 generate-random-file.cmd</span><br><span class="line">SHA256(generate-random-file.cmd)= 03f9454e4ee7923d08aefa4957282b62a655e7231ea6f4bdd6cdcc4e9a4c1bd9</span><br></pre></td></tr></table></figure>



<h2 id="Certutil"><a href="#Certutil" class="headerlink" title="Certutil"></a>Certutil</h2><p>Windows ‰∏äÁöÑ‰∏Ä‰∏™Áî®Êù•Êèê‰æõËØÅ‰π¶ÊúçÂä°ÁöÑÂ∑•ÂÖ∑Ôºå‰πüÊèê‰æõ‰∫Ü‰∏Ä‰∫õÊëòË¶ÅÁÆóÊ≥ï„ÄÇËØ≠Ê≥ïÊòØÔºö</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">certutil <span class="literal">-hashfile</span> Êñá‰ª∂Ë∑ØÂæÑ ÊëòË¶ÅÁÆóÊ≥ïÂêç</span><br></pre></td></tr></table></figure>

<p>‰æãÂ≠êÔºö</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\Elnino\Desktop&gt; certutil <span class="literal">-hashfile</span> .\generate<span class="literal">-random-file</span>.cmd sha256</span><br><span class="line">SHA256 ÁöÑ .\generate<span class="literal">-random-file</span>.cmd ÂìàÂ∏å:</span><br><span class="line"><span class="number">03</span>f9454e4ee7923d08aefa4957282b62a655e7231ea6f4bdd6cdcc4e9a4c1bd9</span><br><span class="line">CertUtil: <span class="literal">-hashfile</span> ÂëΩ‰ª§ÊàêÂäüÂÆåÊàê„ÄÇ</span><br></pre></td></tr></table></figure>



<h1 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h1><p>Âú®Êú¨Êñá‰∏≠ÔºåÊàë‰ªãÁªç‰∫Ü‰∏ÄÊ¨æÂºÄÊ∫êÂ•ΩÁî®ÁöÑÂ±ÄÂüüÁΩë‰º†ËæìÂ∑•ÂÖ∑ ‚Äî‚Äî LocalSend„ÄÇ‰πãÂêéÔºåÊàëÂèàÁªôÂá∫‰∫Ü Windows Á≥ªÁªü‰∏≠Â¶Ç‰ΩïÈÖçÁΩÆÈò≤ÁÅ´Â¢ôÔºå‰ΩøÂæóÂÖ∂‰ªñËÆæÂ§áËÉΩÂèëÁé∞ÂΩìÂâçÁöÑËÆæÂ§á„ÄÇÊúÄÂêéÔºåÊàë‰ªãÁªç‰∫Ü‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÂØπÊñá‰ª∂ËøõË°åÊëòË¶ÅÁöÑÂ∑•ÂÖ∑Ôºö‰ªéÁΩëÁªú‰∏ãËΩΩÁöÑÊñá‰ª∂ÔºåÁêÜËÆ∫‰∏äÈÉΩË¶ÅËøõË°å‰∏ÄÈÅçÊ†°È™åÔºåÈò≤Ê≠¢Êï∞ÊçÆÊçüÂùèÊàñ‰∏¢Â§±„ÄÇ</p>
]]></content>
      <categories>
        <category>softwares</category>
        <category>LocalSend</category>
      </categories>
      <tags>
        <tag>LocalSend</tag>
        <tag>settings</tag>
        <tag>Firewall</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown ÊèíÂÖ•ÂõæÁâáÊó∂Ëá™Âä®Êã∑Ë¥ù‚Äî‚Äî‰ª• Typora Âíå  VS Code ‰∏∫‰æã</title>
    <url>/en/2023/07/22/Markdown-Automatically-Copy-When-Inserting-Images-Using-Typora-and-VS-Code-as-Examples/</url>
    <content><![CDATA[<h1 id="Â∫èË®Ä"><a href="#Â∫èË®Ä" class="headerlink" title="Â∫èË®Ä"></a>Â∫èË®Ä</h1><p>ÈöèÁùÄ Markdown ÁöÑÊôÆÂèäÔºå‰ΩøÁî®‰º†ÁªüÊñáÊú¨ÁºñËæëÂô®ÂÜô‰ΩúÁöÑÊïàÁéáÊòæÂæó‰Ωé‰∏ãÔºåÂ∞§ÂÖ∂Ë°®Áé∞Âú®‰∏Ä‰∫õÂ§çÊùÇËØ≠Ê≥ïÔºåÊØîÂ¶ÇÊèíÂÖ•Ë°®Ê†ºÔºåÊàñËÄÖÊèíÂÖ•ÂõæÁâá„ÄÇ</p>
<p>Typora ‰Ωú‰∏∫‰∏öÁïåÁü•ÂêçÁöÑ Markdown ÁºñËæëÂô®ÔºåÈô§‰∫ÜËëóÂêçÁöÑ„ÄéÂç≥Êó∂Ê∏≤Êüì„ÄèÔºå‰πüÊã•ÊúâÂæàÂ§öÊñπ‰æø‰π¶ÂÜô Markdown ÁöÑÂäüËÉΩÔºåÊØîÂ¶ÇÊèíÂÖ•ÂõæÁâáÊó∂ÁöÑËá™Âä®‰øùÂ≠òÔºöÂæÄ‰∏Ä‰∏™ Markdown Êñá‰ª∂ÔºàÊñáÊú¨Êñá‰ª∂Ôºâ‰∏≠Á≤òË¥¥‰∏ÄÂº†ÂõæÁâáÔºåËØ•ÂõæÁâá‰æø‰ºöËá™Âä®‰øùÂ≠òÂà∞ÊåáÂÆöË∑ØÂæÑÔºåÂπ∂‰∏îËá™Âä®Âú® Markdown ‰∏≠Âª∫Á´ãÂ•ΩÂºïÁî®„ÄÇ</p>
<p>ÂØπ‰∫éÁªèÂ∏∏Áî® Markdown ËÆ∞Á¨îËÆ∞ÁöÑÊàëÊù•ËØ¥Ôºå<strong>Ëøô‰∏ÄÂäüËÉΩÂ∫îËØ•Êàê‰∏∫‰∏öÁïåÁöÑÊ†áÂáÜ</strong>„ÄÇ‰ΩÜÊòØÔºåÂè¶‰∏ÄÊ¨æÂ∏∏Áî®ÁöÑÁºñËæëÂô® ‚Äî‚Äî VS Code ‚Äî‚Äî ÂØπËøô‰∏ÄÂäüËÉΩÁöÑÊîØÊåÅÂπ∂‰∏çÂ•Ω„ÄÇÂΩìÁÑ∂ÔºåÊàë‰ª¨‰πü‰∏çÂ∫îËØ•ËãõÊ±ÇËøôÊ†∑‰∏ÄÊ¨æÂÖçË¥π„ÄÅÈÄöÁî®ÁöÑÁºñËæëÂô®ËÉΩÂ§üÈù¢Èù¢‰ø±Âà∞„ÄÇ</p>
<h1 id="ÈúÄÊ±Ç"><a href="#ÈúÄÊ±Ç" class="headerlink" title="ÈúÄÊ±Ç"></a>ÈúÄÊ±Ç</h1><p>ÂØπ‰∫éÁªèÂ∏∏ËÆ∞Á¨îËÆ∞ÁöÑÁî®Êà∑ÔºåÊà™ÂõæÂπ∂ÊèíÂÖ• Markdown ÊòØ‰∏Ä‰∏™Â∏∏ËßÅÁöÑÈúÄÊ±Ç„ÄÇÂú®Ëøô‰∏ÄÊìç‰ΩúÁöÑËÉåÂêéÔºåÊúâ‰∏§‰∏™ÊñπÈù¢ÂÖ≥‰πéÁùÄÁî®Êà∑‰ΩìÈ™åÔºö1Ô∏è‚É£ Êà™ÂõæÂ∑•ÂÖ∑ 2Ô∏è‚É£Markdown ÁºñËæëÂô®„ÄÇ</p>
<p>Âú®Êà™ÂõæÂ∑•ÂÖ∑‰∏ÄËá¥ÁöÑÊÉÖÂÜµ‰∏ãÔºåMarkdown ÁºñËæëÂô®ÊòØÂÜ≥ÂÆöÁî®Êà∑‰ΩìÈ™åÁöÑÂÖ≥ÈîÆÂõ†Á¥†„ÄÇ‰∏ãÈù¢ÊàëÂ∞ÜÂ±ïÂºÄ‰ªãÁªç 3 ÁßçÁºñËæëÂô®ÊòØÂ¶Ç‰ΩïÊèíÂÖ•ÂõæÁâáÁöÑ„ÄÇ</p>
<span id="more"></span>


<h1 id="‰º†ÁªüÊñáÊú¨ÁºñËæëÂô®"><a href="#‰º†ÁªüÊñáÊú¨ÁºñËæëÂô®" class="headerlink" title="‰º†ÁªüÊñáÊú¨ÁºñËæëÂô®"></a>‰º†ÁªüÊñáÊú¨ÁºñËæëÂô®</h1><p>ËøôÁßçÁºñËæëÂô®ÈÄöÂ∏∏Âè™ÊòØÊîØÊåÅ Markdown ËØ≠Ê≥ïÈ´ò‰∫ÆÁöÑ‚ÄúËÆ∞‰∫ãÊú¨‚ÄùÔºåÊØîÂ¶Ç vimÔºåsublime Á≠â„ÄÇ</p>
<p>ÂΩìÊàë‰ª¨Êà™ÂõæÂÆåÊØïÂêéÔºåÈúÄË¶ÅÂÖàÂ∞ÜÂõæÁâáÂ≠òÂÇ®Âà∞Êú¨Âú∞ÔºåÂÜç‰ΩøÁî® Markdown ËØ≠Ê≥ïÊâãÂä®ÂºïÁî®ËØ•ÂõæÁâáÁöÑË∑ØÂæÑÔºö</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![<span class="string">alt text</span>](<span class="link">image.jpg</span>)</span><br></pre></td></tr></table></figure>

<p>Âá∫‰∫éÊñπ‰æøÔºåÊà™ÂõæËΩØ‰ª∂ÂæÄÂæÄ‰ºöÂ∞ÜÂõæÁâáÈÉΩÂ≠òÂÇ®Âà∞ÁâπÂÆöË∑ØÂæÑ‰∏ã„ÄÇ‰∏∫‰∫ÜÂçïÁã¨Â≠òÊîæÊØè‰∏™ Markdown Êñá‰ª∂Áõ∏ÂÖ≥ÁöÑÂõæÁâáÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÊâãÂä®Âú∞Ââ™ÂàáÂõæÁâáÁöÑ‰ΩçÁΩÆ„ÄÇÂæàÈ∫ªÁÉ¶ÔºÅ</p>
<h1 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h1><h2 id="ËÆæÁΩÆ"><a href="#ËÆæÁΩÆ" class="headerlink" title="ËÆæÁΩÆ"></a>ËÆæÁΩÆ</h2><p>Typora ‰∏∫ÊèíÂÖ•ÂõæÁâáÊèê‰æõ‰∫ÜÂ§öÁßçÂäüËÉΩÔºåÊàëÊúÄÂ∏∏Áî®ÁöÑÊòØ„ÄéÂ§çÂà∂ÂõæÁâáÂà∞ÊåáÂÆöË∑ØÂæÑ„Äè„ÄÇ</p>
<p>ËøôÈáåÁöÑ„ÄéÊèíÂÖ•ÂõæÁâá„ÄèÔºåÊòØÊåáÈº†Ê†áÊãñÂä®ÂõæÁâáÂà∞ Typora ‰∏≠ÔºåÊàñËÄÖ‰ªéÂâ™Ë¥¥ÊùøÔºà<code>win + v</code>Ôºâ‰∏≠Á≤òË¥¥</p>
<img src="/MarkDownImages/image-20230722141038783.png" alt="image-20230722141038783" style="zoom:50%;" />

<p>ÊàëÈÄâÊã©‰øùÂ≠òÂà∞‰∏éÂΩìÂâç Markdown Êñá‰ª∂ÂêåÁõÆÂΩï‰∏ãÁöÑ<code>MarkDownImages</code>Êñá‰ª∂Â§π‰∏ãÔºàÊ≤°Êúâ‰ºöËá™Âä®ÂàõÂª∫Ôºâ„ÄÇÂΩìÁÑ∂ÔºåÊõ¥Â•ΩÁöÑÂÅöÊ≥ïÂ∫îËØ•ÊòØÈÄâÊã©„ÄéÂ§çÂà∂ÂõæÁâáÂà∞ <code>./$&#123;filename&#125;.assets</code> Êñá‰ª∂Â§π„ÄèÔºåËøôÊ†∑Êñπ‰æø Markdown Êñá‰ª∂ÁöÑËøÅÁßª</p>
<img src="/MarkDownImages/image-20230722141359394.png" alt="image-20230722141359394" style="zoom:50%;" />

<p>„ÄéÂØπÁΩëÁªú‰ΩçÁΩÆÁöÑÂõæÁâáÂ∫îÁî®‰∏äËø∞ËßÑÂàô„ÄèÔºöÂΩìÊàë‰ª¨Â§çÂà∂‰∫Ü‰∏Ä‰∏™ÁΩëÁªúÂõæÁâáÔºàÁöÑ url Ôºâ ÔºåTypora ‰ºöËá™Âä®‰∏ãËΩΩÂõæÁâáÂà∞ÊåáÂÆöË∑ØÂæÑÔºåÂπ∂Â∞Ü url Âèò‰∏∫Êú¨Âú∞Êñá‰ª∂ÂºïÁî® ‚Äî‚Äî ÁΩëÁªú‰∏äÁöÑÂõæÁâáÂèØËÉΩÈöèÊó∂Ê∂àÂ§±ÔºåÊú¨Âú∞Â≠òÂÇ®Êõ¥ÂèØÈù†„ÄÇ</p>
<h2 id="Êìç‰Ωú"><a href="#Êìç‰Ωú" class="headerlink" title="Êìç‰Ωú"></a>Êìç‰Ωú</h2><p>Êà™ÂõæÂêéÔºåÂú® Typora ‰∏≠Êåâ‰∏ã <code>Ctrl + v</code>ÔºåÂàôÂâ™Ë¥¥Êùø‰∏≠ÁöÑÂõæÁâá‰ºöËá™Âä®Êã∑Ë¥ùÂà∞<code>MarkDownImages</code>Êñá‰ª∂Â§π‰∏ãÔºåÂπ∂‰∏î<strong>Êñá‰ª∂ÂêçÂü∫‰∫éÊó∂Èó¥Êà≥</strong>Ôºå‰∏çÂÆπÊòìÈáçÂ§ç</p>
<hr>
<img src="/MarkDownImages/image-20230722142231405.png" alt="image-20230722142231405" style="zoom:67%;" />

<hr>
<img src="/MarkDownImages/image-20230722142307844.png" alt="image-20230722142307844" style="zoom:67%;" />

<hr>
<img src="/MarkDownImages/image-20230722142326387.png" alt="image-20230722142326387" style="zoom:67%;" />

<hr>
<p>ÂèØ‰ª•ÁúãÂá∫ÔºåËøôÁßçÊèíÂÖ•ÂõæÁâáÁöÑÊñπÂºèÈùûÂ∏∏‰ºòÈõÖ„ÄÅ‰æøÊç∑</p>
<h1 id="VS-Code"><a href="#VS-Code" class="headerlink" title="VS Code"></a>VS Code</h1><h2 id="ËÆæÁΩÆ-1"><a href="#ËÆæÁΩÆ-1" class="headerlink" title="ËÆæÁΩÆ"></a>ËÆæÁΩÆ</h2><p>VS Code Â∫îËØ•ÊòØÂú®ÊúÄËøëÊâçÂä†ÂÖ•Á±ª‰ºº Typora ÁöÑÂäüËÉΩÔºå‰∏çËøáÂè™Êèê‰æõ‰∫Ü„ÄéÂ§çÂà∂ÂõæÁâáÂà∞ÊåáÂÆöË∑ØÂæÑ„ÄèÁöÑÈÄâÈ°π„ÄÇ</p>
<p>ÊàëËøôÈáåÁöÑÈÖçÁΩÆÊòØÊèíÂÖ•‰ªªÊÑèÊñá‰ª∂Ôºà<code>**/*</code>ÔºâÊó∂ÔºåÂ∞ÜÂÆÉÂ§çÂà∂Âà∞‰∏éÂΩìÂâç Markdown Êñá‰ª∂ÂêåÁõÆÂΩï‰∏ãÁöÑ <code>MarkDownImages</code> Êñá‰ª∂Â§π‰∏ãÔºàÊ≤°Êúâ‰ºöËá™Âä®ÂàõÂª∫Ôºâ„ÄÇÊñá‰ª∂ÂêçÂè´ÂÅö <code>VSCodeCopied-$&#123;fileName&#125;</code>„ÄÇ<code>$&#123;fileName&#125;</code>ÊòØÂéüÂßãÊñá‰ª∂Âêç</p>
<p><img src="/en/MarkDownImages/image-20230722142953270.png" alt="image-20230722142953270"></p>
<p>ÊàñËÄÖÂèØ‰ª•Áõ¥Êé•Â§çÂà∂‰ª•‰∏ãÂÜÖÂÆπÂà∞ <code>settings.json</code> ‰∏≠Ôºö</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;markdown.copyFiles.destination&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;**/*&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./MarkDownImages/VSCodeCopied-$&#123;fileName&#125;&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Êìç‰Ωú-1"><a href="#Êìç‰Ωú-1" class="headerlink" title="Êìç‰Ωú"></a>Êìç‰Ωú</h2><p>‰∏é Typora Á±ª‰ººÔºåÊà™ÂõæÊåâ‰∏ã <code>Ctrl + v</code> Âç≥ÂèØ</p>
<p>‰∏∫‰ªÄ‰πà‰øùÂ≠òÁöÑÂõæÁâáÂêçË¶ÅÂè´ÂÅö <code>VSCodeCopied-$&#123;fileName&#125;</code>ÔºüÂõ†‰∏∫Â∞ÜÊà™ÂõæÊèíÂÖ•Âà∞ VS Code ‰∏≠Êó∂Ôºå‰ºöË¢´Ëµ∑Âêç‰∏∫<code>image.png</code></p>
<p><img src="/en/MarkDownImages/image-20230722143640371.png" alt="image-20230722143640371"></p>
<p>Â¶ÇÊûúÊúâÈáçÂ§çÔºåÂ∞±Âú®Êñá‰ª∂ÂêçÂêéÈù¢Ê∑ªÂä†Êï∞Â≠ó‰ª•Á§∫Âå∫ÂàÜÔºö</p>
<p><img src="/en/MarkDownImages/image-20230722143756389.png" alt="image-20230722143756389"></p>
<p><img src="/en/MarkDownImages/image-20230722143813041.png" alt="image-20230722143813041"></p>
<p>ËøôÊòæÁÑ∂‰∏çÁõ¥ËßÇÔºåÂπ∂‰∏îÂú®Âõ¢ÈòüÂêà‰ΩúÂÜôÊñáÊ°£Êó∂ÂÆπÊòìÈÄ†ÊàêÊñá‰ª∂ÂêçÂÜ≤Á™Å„ÄÇÊúüÂæÖ VS Code ÂêéÁª≠ÁöÑÊõ¥Êñ∞‰∏≠ËÉΩÂ§üËß£ÂÜ≥Ëøô‰∏ÄÁÇπÔºåÂπ∂Êèê‰æõÊõ¥Â§öÁöÑÊèíÂÖ•ÂõæÁâáÊó∂ÁöÑÈÄâÈ°π„ÄÇ</p>
<h1 id="ÂèÇËÄÉÊñáÁ´†"><a href="#ÂèÇËÄÉÊñáÁ´†" class="headerlink" title="ÂèÇËÄÉÊñáÁ´†"></a>ÂèÇËÄÉÊñáÁ´†</h1><p><a href="https://support.typora.io/Images/#when-insert-images">Images in Typora: when-insert-images</a></p>
<p><a href="https://www.markdownguide.org/cheat-sheet/">Markdown Cheat Sheet</a></p>
]]></content>
      <categories>
        <category>tech</category>
        <category>softwares</category>
        <category>VS Code</category>
        <category>Typora</category>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>settings</tag>
        <tag>VS Code</tag>
        <tag>Typora</tag>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>MyBatis-Plus ÂÆûÁé∞ MySQL JSON Á±ªÂûãÂ≠óÊÆµÁöÑÊò†Â∞Ñ</title>
    <url>/en/2023/07/08/MyBatis-Plus-Mapping-MySQL-JSON-Type/</url>
    <content><![CDATA[<h1 id="Â∫èË®Ä"><a href="#Â∫èË®Ä" class="headerlink" title="Â∫èË®Ä"></a>Â∫èË®Ä</h1><p>MySQL ÊîØÊåÅ JSON Á±ªÂûãÁöÑÂ≠óÊÆµ„ÄÇÁõ∏ÊØîÂ≠óÁ¨¶‰∏≤Á±ªÂûãÁöÑÂ≠óÊÆµÔºå JSON Á±ªÂûãÊúâÂ¶Ç‰∏ãÂ•ΩÂ§ÑÔºö</p>
<ul>
<li>Ëá™Âä®Ê£ÄÊü• JSON ËØ≠Ê≥ïÊòØÂê¶Ê≠£Á°Æ</li>
<li>Â∫ïÂ±ÇÊîØÊåÅÂø´ÈÄüÂ≠òÂèñ JSON ‰∏≠ÁöÑÂÖÉÁ¥†„ÄÇ‰∏çÈúÄË¶ÅÂ∞ÜÊï¥‰∏™ Â≠óÁ¨¶‰∏≤ ÂÖ®ÈÉ®ËØªÂèñÂá∫Êù•ÔºåÂÜçËß£ÊûêÊàê JSON ÂØπË±°</li>
</ul>
<p>Âú®ÈÄªËæë‰∏äÔºåJSON ‰∏é POJO Êó†ÂºÇ„ÄÇSpring MVC Â∑≤ÁªèÂÆûÁé∞‰∫Ü Controller Â±Ç‰∏§ËÄÖÁöÑËá™Âä®ËΩ¨ÂåñÔºåËøô‰ΩìÁé∞Âú®ËØ∑Ê±ÇÂèÇÊï∞ÂíåËøîÂõûÂÄº‰∏ä„ÄÇÈÇ£‰πàÔºåRepository Â±ÇÂ¶Ç‰ΩïÂÆûÁé∞‰∏§ËÄÖÁöÑËá™Âä®ËΩ¨Êç¢Âë¢Ôºü</p>
<p>Êú¨ÊñáÂ±ïÁ§∫‰∫ÜÈÄöËøá‰ΩøÁî® MyBatis-PlusÔºå<strong>Êó†‰æµÂÖ•Âºè</strong>Âú∞ÂÆûÁé∞ÊåÅ‰πÖÂ±Ç JSON ‰∏é POJO ÁöÑËá™Âä®Êò†Â∞ÑÔºàORMÔºå Object Relational MappingÔºâ</p>
<h1 id="Ê°à‰æãÊºîÁ§∫"><a href="#Ê°à‰æãÊºîÁ§∫" class="headerlink" title="Ê°à‰æãÊºîÁ§∫"></a>Ê°à‰æãÊºîÁ§∫</h1><h2 id="Êï∞ÊçÆÂ∫ìË°®"><a href="#Êï∞ÊçÆÂ∫ìË°®" class="headerlink" title="Êï∞ÊçÆÂ∫ìË°®"></a>Êï∞ÊçÆÂ∫ìË°®</h2><span id="more"></span>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE `person` (</span><br><span class="line">  `id` bigint NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `name` varchar(255) NOT NULL,</span><br><span class="line">  `log` json NOT NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB;</span><br></pre></td></tr></table></figure>

<h2 id="‰æùËµñ"><a href="#‰æùËµñ" class="headerlink" title="‰æùËµñ"></a>‰æùËµñ</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="entity"><a href="#entity" class="headerlink" title="entity"></a>entity</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(value = &quot;person&quot;, autoResultMap = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(typeHandler = JacksonTypeHandler.class)</span></span><br><span class="line">    <span class="keyword">private</span> PersonLog log;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Data</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">PersonLog</span> &#123;</span><br><span class="line">        List&lt;String&gt; hobbies;</span><br><span class="line">        Integer age;</span><br><span class="line">        String address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ËøôÈáåÁöÑ<code>PersonLog</code>ÊòØÈáçÁÇπËÆ®ËÆ∫ÁöÑÂØπË±°ÔºåÊàë‰ª¨Ë¶ÅÂÆûÁé∞ÂÆÉ‰∏é JSON ÁöÑÊò†Â∞Ñ„ÄÇ</p>
<p><code>Person</code>Á±ª‰∏äÈúÄË¶ÅÊ†áËÆ∞‰∏§‰∏™Ê≥®Ëß£Ôºå‰∏§ËÄÖÈÄöÂ∏∏‰∏ÄËµ∑‰ΩøÁî®Ôºö</p>
<p> <code>TableName#autoResultMap</code>ÔºöË¥üË¥£Âú®<strong>Êü•ËØ¢</strong>Êó∂ÂÄôÊää JSON ËΩ¨Êç¢‰∏∫ POJO</p>
<p><code>TableField#typeHandler</code>ÔºöË¥üË¥£Âú®<strong>ÊèíÂÖ•</strong>Êó∂Â∞Ü POJO ËΩ¨Êç¢‰∏∫ JSON„ÄÇÁî±‰∫é spring-web-starter Â∑≤ÁªèÂØºÂÖ•‰∫Ü jackson ‰æùËµñÔºåÁõ¥Êé•‰ΩøÁî® <code>JacksonTypeHandler</code> Âç≥ÂèØ„ÄÇ</p>
<h2 id="mapper-xml"><a href="#mapper-xml" class="headerlink" title="mapper.xml"></a>mapper.xml</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.demo.mapper.PersonMapper&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;BaseResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.example.demo.entity.Person&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;BIGINT&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;VARCHAR&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;log&quot;</span> <span class="attr">property</span>=<span class="string">&quot;log&quot;</span> <span class="attr">jdbcType</span>=<span class="string">&quot;LONGVARCHAR&quot;</span> <span class="attr">typeHandler</span>=<span class="string">&quot;com.baomidou.mybatisplus.extension.handlers.JacksonTypeHandler&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;Base_Column_List&quot;</span>&gt;</span></span><br><span class="line">        id, name, log</span><br><span class="line">    <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>mapper Êñá‰ª∂‰∏≠ÈúÄË¶ÅÊåáÂá∫ <code>log</code> Â≠óÊÆµÁöÑ typeHandler ÁöÑÂÖ®Á±ªÂêç</p>
<h2 id="ÊµãËØï"><a href="#ÊµãËØï" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PersonMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Person&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÁúÅÁï•‰∫Ü Service Â±Ç</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PersonController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PersonMapper personMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/json&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">testJSON2BeanMap</span><span class="params">(<span class="meta">@RequestBody</span> Person person)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> personMapper.insert(person);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/json/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Person <span class="title function_">getPersonById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> personMapper.selectById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÊµãËØï‰∏§‰∏™ÊñπÊ≥ïÔºåÊ≤°Êä•ÈîôÂ∞±ËØ¥ÊòéÊàêÂäüÔºåÊèíÂÖ•Êó∂ÂèØ‰ª•ÂÜçÊü•Áúã‰∏Ä‰∏ãÊï∞ÊçÆÂ∫ì„ÄÇ</p>
<p>Âú®<a href="#%E5%BA%8F%E8%A8%80">Â∫èË®Ä</a>‰∏≠ÊèêÂà∞ÁöÑ<strong>Êó†‰æµÂÖ•ÂºèORM</strong>ÔºåÊòØÊåáÊàë‰ª¨‰∏çÈúÄË¶ÅÂú®‰ª£Á†Å‰∏≠ÊâãÂä®Âú∞ÊâßË°å JSON ‰∏é PersonLog ÁöÑËΩ¨Êç¢„ÄÇ</p>
<h1 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h1><p>Êú¨ÊñáÂ±ïÁ§∫‰∫ÜÈÄöËøá‰ΩøÁî® MyBatis-Plus<strong>Êó†‰æµÂÖ•Âºè</strong>ÂÆûÁé∞ÊåÅ‰πÖÂ±Ç JSON ‰∏é POJO ÁöÑËá™Âä®Êò†Â∞Ñ„ÄÇ</p>
<p>ÊàëÂØπËøô‰∏ÄÈóÆÈ¢òÁöÑÁ†îÁ©∂Ê∫êËá™ÂÆû‰π†Êó∂‰∏öÂä°ÁöÑË¶ÅÊ±Ç„ÄÇÂΩìÊàëÊü•ËØ¢ÁΩë‰∏äÁöÑËµÑÊñôÊó∂ÔºåÂèëÁé∞Â∏ñÂ≠êÁöÑË°®Ëø∞ÈÉΩ‰∏çÂ§™ÂÆåÊï¥„ÄÅÁõ¥ËßÇÔºå‰∫éÊòØÊàëËÆ∞ÂΩï‰∏ã‰∫ÜËß£ÂÜ≥ÊñπÊ°àÔºåÂÜôÊàê‰∫ÜËøôÁØáÊñáÁ´†„ÄÇ</p>
<h1 id="ÂèÇËÄÉÊñáÁ´†"><a href="#ÂèÇËÄÉÊñáÁ´†" class="headerlink" title="ÂèÇËÄÉÊñáÁ´†"></a>ÂèÇËÄÉÊñáÁ´†</h1><p><a href="https://dev.mysql.com/doc/refman/8.0/en/json.html">The JSON Data Type</a></p>
<p><a href="https://blog.csdn.net/qq_33360626/article/details/119836835">mybatis-plusÂ§ÑÁêÜmysql‰∏≠jsonÊ†ºÂºèÊñπÊ≥ï</a></p>
]]></content>
      <categories>
        <category>tech</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring Boot</tag>
        <tag>MySQL</tag>
        <tag>MyBatis-Plus</tag>
        <tag>JDBC</tag>
        <tag>Repository</tag>
      </tags>
  </entry>
  <entry>
    <title>PotPlayer ÂêØÁî® Nvidia Ë∂ÖÂàÜËæ®Áéá</title>
    <url>/en/2023/07/09/PotPlayer-Enable-Nvidia-Super-Resolution/</url>
    <content><![CDATA[<h1 id="Â∫èË®Ä"><a href="#Â∫èË®Ä" class="headerlink" title="Â∫èË®Ä"></a>Â∫èË®Ä</h1><p>Nvidia VSR (Video Super Resolution) ÈÄöËøá AI ÊäÄÊúØ‰ºòÂåñËßÜÈ¢ëÁöÑÁîªÈù¢Ë¥®ÈáèÔºå‰∏ªË¶ÅË°®Áé∞Âú®ÈîêÂåñ‰ΩéÂàÜËæ®ÁéáÁöÑËßÜÈ¢ë‰∏ä„ÄÇËØ•ÊäÄÊúØÊúÄÂàùÂè™ÊîØÊåÅ Chrome Âíå Edge ÊµèËßàÂô®„ÄÇ</p>
<p>Â¶Ç‰ΩïÂú®Êú¨Âú∞ËßÜÈ¢ëÊí≠ÊîæÂô®‰∏≠‰ΩìÈ™åËøôÈ°πÊäÄÊúØÔºüPotPlayer ÊúÄËøëÂèëÂ∏É‰∫ÜÁõ∏ÂÖ≥Êõ¥Êñ∞ÔºåÊîØÊåÅ‰∫ÜËØ•ÊäÄÊúØ„ÄÇ</p>
<p>PotPlayer ÊòØÁõÆÂâçÊï∞‰∏ÄÊï∞‰∫åÁöÑËßÜÈ¢ëÊí≠ÊîæÂô®Ôºå‰πüÊòØÊàëÁöÑ‰∏ªÂäõÊí≠ÊîæÂô®„ÄÇË∂ÅÁùÄËøôÊ¨°Êõ¥Êñ∞ÔºåÊàëÊù•ËÆ∞ÂΩï‰∏Ä‰∏ãÂ¶Ç‰ΩïÂú® PotPlayer ‰∏ä‰ΩøÁî® Nvidia Super Resolution.</p>
<h1 id="ÊµèËßàÂô®ÂºÄÂêØ-VSR"><a href="#ÊµèËßàÂô®ÂºÄÂêØ-VSR" class="headerlink" title="ÊµèËßàÂô®ÂºÄÂêØ VSR"></a>ÊµèËßàÂô®ÂºÄÂêØ VSR</h1><p>Êú¨Â∞èËäÇÂÖà‰ªãÁªç‰∏Ä‰∏ãÂ¶Ç‰ΩïËÆ© Chrome Âíå Edge ÊµèËßàÂô®‰ΩøÁî® Nvidia Super Resolution„ÄÇ</p>
<span id="more"></span>

<h2 id="Êõ¥Êñ∞È©±Âä®ÁâàÊú¨"><a href="#Êõ¥Êñ∞È©±Âä®ÁâàÊú¨" class="headerlink" title="Êõ¥Êñ∞È©±Âä®ÁâàÊú¨"></a>Êõ¥Êñ∞È©±Âä®ÁâàÊú¨</h2><p>Êõ¥Êñ∞È©±Âä®ÁâàÊú¨ÔºåËá≥Â∞ëÂà∞ 532 Áâà</p>
<img src="/MarkDownImages/image-20230709161546792.png" alt="image-20230709161546792" style="zoom: 67%;" />

<h2 id="ËÆæÁΩÆ"><a href="#ËÆæÁΩÆ" class="headerlink" title="ËÆæÁΩÆ"></a>ËÆæÁΩÆ</h2><p>Âú® Nvidia Control Panel ‰∏≠ËøõÂÖ•Â¶Ç‰∏ãÈÖçÁΩÆÔºö</p>
<p>ÂºÄÂêØ„ÄéË∂ÖÂàÜËæ®Áéá„ÄèÔºåÈÄâÊã©Ë¥®Èáè„ÄÇÊï∞Â≠óË∂äÂ§ßÔºåÂ¢ûÂº∫ÊïàÊûúË∂äÂº∫ÔºåÂêåÊó∂ÂØπ GPU ÂéãÂäõ‰πüË∂äÂ§ß</p>
<p><img src="/en/MarkDownImages/image-20230709161702760.png" alt="image-20230709161702760"></p>
<h1 id="PotPlayer-ÂºÄÂêØ-VSR"><a href="#PotPlayer-ÂºÄÂêØ-VSR" class="headerlink" title="PotPlayer ÂºÄÂêØ VSR"></a>PotPlayer ÂºÄÂêØ VSR</h1><h2 id="Êõ¥Êñ∞ÁâàÊú¨"><a href="#Êõ¥Êñ∞ÁâàÊú¨" class="headerlink" title="Êõ¥Êñ∞ÁâàÊú¨"></a>Êõ¥Êñ∞ÁâàÊú¨</h2><p>Âú® PotPlayer ËøëÊúüÁöÑÊõ¥Êñ∞ËØ¥Êòé‰∏≠ÔºåÊèêÂà∞‰∫ÜÔºö</p>
<blockquote>
<p>Ê∑ªÂä† GPU Ë∂ÖÂàÜËæ®ÁéáÂäüËÉΩÂà∞ÂÜÖÁΩÆÁöÑ D3D11 ËßÜÈ¢ëÊ∏≤ÊüìÂô®</p>
</blockquote>
<img src="/MarkDownImages/image-20230709162050531.png" alt="image-20230709162050531" style="zoom: 67%;" />

<p>Ëá≥Â∞ëÂ∞Ü PotPlayer ÂçáÁ∫ßÂà∞Ëøô‰∏™ÁâàÊú¨</p>
<h2 id="ËÆæÁΩÆ-1"><a href="#ËÆæÁΩÆ-1" class="headerlink" title="ËÆæÁΩÆ"></a>ËÆæÁΩÆ</h2><p>Á°Æ‰øù‰ΩøÁî®ÁöÑÊòØ„ÄéDirect3D 11 ËßÜÈ¢ëÊ∏≤ÊüìÂô®„ÄèÔºåÂπ∂ÊâìÂºÄ„ÄéË∂ÖÂàÜËæ®Áéá„ÄèÔºàÈªòËÆ§ÊòØÂÖ≥Èó≠ÁöÑÔºâ</p>
<img src="/MarkDownImages/image-20230709162350077.png" alt="image-20230709162350077" style="zoom: 80%;" />

<h2 id="ÊµãËØï"><a href="#ÊµãËØï" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h2><p>Èöè‰æøÊâìÂºÄ‰∏Ä‰∏™ËßÜÈ¢ëÔºåÊåâ <code>Tab</code> ÈîÆ„ÄÇÂ¶ÇÊûú„ÄéËßÜÈ¢ëÊ∏≤ÊüìÂô® - Áº©Êîæ„ÄèÊòæÁ§∫ÁöÑÊòØ„ÄéGPU Super Resolution„ÄèÔºåÂàôËØ¥ÊòéÈÖçÁΩÆÊàêÂäü‰∫Ü„ÄÇÊí≠ÊîæËßÜÈ¢ëÊó∂Ôºå‰πüÂèØ‰ª•Âú®‰ªªÂä°ÁÆ°ÁêÜÂô®‰∏≠ÁúãÂà∞ GPU ÁöÑË¥üËΩΩÂçáÈ´ò„ÄÇ</p>
<p><img src="/en/MarkDownImages/image-20230709162617479.png" alt="image-20230709162617479"></p>
<h1 id="ÂèÇËÄÉÊñáÁ´†"><a href="#ÂèÇËÄÉÊñáÁ´†" class="headerlink" title="ÂèÇËÄÉÊñáÁ´†"></a>ÂèÇËÄÉÊñáÁ´†</h1><p><a href="https://blogs.nvidia.com/blog/2023/02/28/rtx-video-super-resolution/">Pixel Perfect: RTX Video Super Resolution Now Available for GeForce RTX 40 and 30 Series GPUs</a></p>
<p><a href="https://potplayer.daum.net/">PotPlayer ÂÆòÁΩë</a></p>
]]></content>
      <categories>
        <category>softwares</category>
        <category>PotPlayer</category>
      </categories>
      <tags>
        <tag>settings</tag>
        <tag>PotPlayer</tag>
        <tag>Nvidia</tag>
        <tag>VSR</tag>
      </tags>
  </entry>
  <entry>
    <title>Spring MVC ‰ΩøÁî® Validation Ê≥®Ëß£ÂÆûÁé∞ËØ∑Ê±ÇÂèÇÊï∞Ëá™Âä®Ê†°È™å</title>
    <url>/en/2023/07/05/Spring-MVC-Automatic-Validation-of-Request-Parameters-Using-Validation-Annotations/</url>
    <content><![CDATA[<h1 id="Â∫èË®Ä"><a href="#Â∫èË®Ä" class="headerlink" title="Â∫èË®Ä"></a>Â∫èË®Ä</h1><p>ÊéßÂà∂Âô®ÊñπÊ≥ïÔºà handler Ôºâ‰∏≠Ë¥üË¥£ËØ∑Ê±ÇÂèÇÊï∞Ê†°È™å„ÄÇ</p>
<p>‰º†ÁªüÁöÑÂÜôÊ≥ïÊòØÂú®ÊØè‰∏™ÊñπÊ≥ïÁöÑÂºÄÂ§¥ÂØπÊâÄÊúâËØ∑Ê±ÇÂèÇÊï∞ËøõË°åÊ†°È™åÔºåÂ¶ÇÊûúÂ≠òÂú®ÂèÇÊï∞‰∏çÊª°Ë∂≥Êù°‰ª∂ÔºåÂàôÊäõÂá∫ÂºÇÂ∏∏ÔºåÊàñËÄÖÊèêÂâçËøîÂõûÈîôËØØ„ÄÇ</p>
<p>Validation API Êèê‰æõ‰∫Ü‰∏ÄÁ≥ªÂàóÁöÑÊ≥®Ëß£ÔºåÈÄöËøáÂ∞ÜËøô‰∫õÊ≥®Ëß£Ê†áËÆ∞Âú® entity Á±ªÁöÑÂ±ûÊÄß‰∏äÔºåSpring MVC ‰ºöÊ†πÊçÆËøô‰∫õÊ≥®Ëß£ÁöÑËØ≠‰πâÔºåËá™Âä®ÂÆåÊàêËØ∑Ê±ÇÂèÇÊï∞Ê†°È™å„ÄÇÂ¶ÇÊûúÂèÇÊï∞‰∏çÊª°Ë∂≥Êù°‰ª∂ÔºåÂàôÊäõÂá∫ÂºÇÂ∏∏„ÄÇËøôËäÇÁúÅ‰∫ÜÂºÄÂèëËÄÖÊâãÂä®Ê†°È™åËØ∑Ê±ÇÂèÇÊï∞ÁöÑÈ∫ªÁÉ¶„ÄÇ</p>
<p>Ë¥üË¥£Ëá™Âä®ÂèÇÊï∞Ê†°È™åÁöÑÁ±ªÂÆûÈôÖ‰∏äÊòØÁî± Spring Boot Ëá™Âä®Ë£ÖÈÖçÂØºÂÖ•ÁöÑÔºåÂõ†Ê≠§Êàë‰ª¨Ë¶Å‰ΩøÁî®ÂØπÂ∫îÁöÑ starter ‰æùËµñ„ÄÇ</p>
<h1 id="Ê°à‰æãÊºîÁ§∫"><a href="#Ê°à‰æãÊºîÁ§∫" class="headerlink" title="Ê°à‰æãÊºîÁ§∫"></a>Ê°à‰æãÊºîÁ§∫</h1><h2 id="‰æùËµñ"><a href="#‰æùËµñ" class="headerlink" title="‰æùËµñ"></a>‰æùËµñ</h2><span id="more"></span>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-validation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>validation-api ÊòØÊú¨Ê¨°‰ªãÁªçÁöÑÈáçÁÇπ</p>
<img src="/MarkDownImages/image-20230705200537754.png" alt="image-20230705200537754" style="zoom:80%;" />

<h2 id="È°πÁõÆÁªìÊûÑ"><a href="#È°πÁõÆÁªìÊûÑ" class="headerlink" title="È°πÁõÆÁªìÊûÑ"></a>È°πÁõÆÁªìÊûÑ</h2><p>‰∏Ä‰∏™Ê†áÂáÜÁöÑ Spring Initializer ÁîüÊàêÁöÑ Spring Boot È°πÁõÆ</p>
<img src="/MarkDownImages/image-20230705200916180.png" alt="image-20230705200916180" style="zoom: 80%;" />

<h2 id="entity"><a href="#entity" class="headerlink" title="entity"></a>entity</h2><h3 id="User"><a href="#User" class="headerlink" title="User"></a>User</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.elnino.springmvcvalidatordemo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="meta">@NotBlank</span></span><br><span class="line">    <span class="meta">@Size(max = 5, message = &quot;ÂêçÂ≠ó‰∏çËÉΩË∂ÖËøá5‰∏™Â≠óÁ¨¶&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Min(value = 0, message = &quot;Âπ¥ÈæÑ‰∏çËÉΩÂ∞è‰∫é0&quot;)</span></span><br><span class="line">    <span class="meta">@Max(value = 200, message = &quot;Âπ¥ÈæÑ‰∏çËÉΩÂ§ß‰∫é200&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>@NotBlank</code>ÔºöÁî®Âú® <code>CharSequence</code> Á±ªÂûãÁöÑÂ±ûÊÄß‰∏äÔºåË°®Á§∫ËØ•Â≠óÊÆµÈùûÁ©∫Ôºå‰∏îÈïøÂ∫¶Ëá≥Â∞ë‰∏∫ 1„ÄÇÁÆÄÂçïÊù•ËØ¥ÔºåËØ•Â≠óÁ¨¶‰∏≤ÂøÖÈ°ªÊúâÂÜÖÂÆπ</p>
<p><code>@Size</code>ÔºöÁî®Âú®<code>CharSequence</code>ÂíåÈõÜÂêàÁ±ªÁöÑÂ±ûÊÄß‰∏äÔºåË°®Á§∫ËØ•Â≠óÊÆµÁöÑÂ≠óÁ¨¶Êï∞&#x2F;ÂÖÉÁ¥†Êï∞ÁõÆ„ÄÇ<code>max = 5</code>ÊòØÊï∞ÈáèÁöÑ‰∏äÁïåÔºå‰∏çËÉΩË∂ÖËøáËØ•‰∏äÁïå„ÄÇÂΩìÂ±ûÊÄßÂÄº‰∏çÊª°Ë∂≥Êù°‰ª∂Êó∂ÔºåSpring MVC ‰ºöÊäõÂá∫ÂºÇÂ∏∏ÔºåÂ¶ÇÊûúËÆæÁΩÆ‰∫Ü<code>message</code>Â±ûÊÄßÔºåÂàôÂºÇÂ∏∏ÂÜÖÂÆπ‰∏≠‰ºöÂåÖÂê´ <code>message</code> ÁöÑÂÄº</p>
<p><code>@NotNull</code>ÔºöÂ≠óÈù¢Âê´‰πâÔºåÂ≠óÊÆµÈùûÁ©∫</p>
<p><code>@Min</code>„ÄÅ<code>@Max</code>ÔºöÁî®Âú®Êï∞ÂÄºÁ±ªÂûã‰∏äÔºåÂØπÊï∞ÂÄºÁöÑÂ§ßÂ∞èËøõË°åÁ∫¶Êùü„ÄÇ</p>
<h3 id="Pet"><a href="#Pet" class="headerlink" title="Pet"></a>Pet</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.elnino.springmvcvalidatordemo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotBlank;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pet</span> &#123;</span><br><span class="line">    <span class="meta">@NotBlank</span></span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line">    <span class="meta">@NotBlank</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UserAndPet"><a href="#UserAndPet" class="headerlink" title="UserAndPet"></a>UserAndPet</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.elnino.springmvcvalidatordemo.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.Valid;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserAndPet</span> &#123;</span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Valid</span> <span class="comment">// Ëøô‰∏™Ê≥®Ëß£‰øùËØÅ‰∫ÜUserÁ±ªÂÜÖÈÉ®ÁöÑÂ≠óÊÆµ‰πüËÉΩË¢´Ê†°È™å</span></span><br><span class="line">    <span class="keyword">private</span> User user;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Valid</span></span><br><span class="line">    <span class="keyword">private</span> Pet pet;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Valid</code>Ê≥®Ëß£ÂëäËØâ Spring MVCÔºåÂÆÉÊ†áËÆ∞ÁöÑÁ±ª‰∏ä‰πüÊúâÂ≠óÊÆµÈúÄË¶ÅÊ†°È™å„ÄÇ</p>
<h2 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.elnino.springmvcvalidatordemo.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.elnino.springmvcvalidatordemo.entity.UserAndPet;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.annotation.Validated;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoController</span> &#123;</span><br><span class="line">    <span class="meta">@PostMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> UserAndPet <span class="title function_">test</span><span class="params">(<span class="meta">@Validated</span> <span class="meta">@RequestBody</span> UserAndPet userAndPet)</span> &#123;</span><br><span class="line">        System.out.println(userAndPet);</span><br><span class="line">        <span class="keyword">return</span> userAndPet;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@Validated</code>ÊåáÁ§∫ Spring MVCÔºöÂΩìÂâçËØ∑Ê±ÇÂèÇÊï∞ÈúÄË¶ÅË¢´Ê†°È™å</p>
<h2 id="‰ΩøÁî®-Postman-ÂèëÈÄÅËØ∑Ê±Ç"><a href="#‰ΩøÁî®-Postman-ÂèëÈÄÅËØ∑Ê±Ç" class="headerlink" title="‰ΩøÁî® Postman ÂèëÈÄÅËØ∑Ê±Ç"></a>‰ΩøÁî® Postman ÂèëÈÄÅËØ∑Ê±Ç</h2><h3 id="ÂêàÊ≥ïËØ∑Ê±Ç"><a href="#ÂêàÊ≥ïËØ∑Ê±Ç" class="headerlink" title="ÂêàÊ≥ïËØ∑Ê±Ç"></a>ÂêàÊ≥ïËØ∑Ê±Ç</h3><p>ËØ∑Ê±Ç‰ΩìÂ¶Ç‰∏ãÔºö</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;user&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;adam&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">15</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pet&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cat&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;east wind&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<img src="/MarkDownImages/image-20230705202651511.png" alt="image-20230705202651511" style="zoom:67%;" />

<h3 id="ÈùûÊ≥ïËØ∑Ê±Ç"><a href="#ÈùûÊ≥ïËØ∑Ê±Ç" class="headerlink" title="ÈùûÊ≥ïËØ∑Ê±Ç"></a>ÈùûÊ≥ïËØ∑Ê±Ç</h3><p>ÊïÖÊÑè‰Ωø<code>user.name</code>Ë∂ÖËøáÈïøÂ∫¶ÈôêÂà∂„ÄÇËØ∑Ê±Ç‰ΩìÂ¶Ç‰∏ãÔºö</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;user&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;adam williams&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">15</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pet&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cat&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;east wind&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ÊúçÂä°Âô®ËøîÂõû‰∫Ü 400 ÈîôËØØ</p>
<p><img src="/en/MarkDownImages/image-20230705202748075.png" alt="image-20230705202748075"></p>
<p>ÊúçÂä°Á´ØÊäõÂá∫‰∫Ü<code>MethodArgumentNotValidException</code>ÁöÑÂºÇÂ∏∏„ÄÇÂÜÖÂÆπÊòØ<code>user.name</code>‰∏∫ÈùûÊ≥ïÂèÇÊï∞ÔºåÂêåÊó∂Â±ïÁ§∫‰∫ÜÊàë‰ª¨Ëá™Â∑±ËÆæÁΩÆÁöÑ <code>message</code></p>
<p><img src="/en/MarkDownImages/image-20230705202916086.png" alt="image-20230705202916086"></p>
<h1 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h1><p>ÈÄöËøá‰ΩøÁî® Validation Ê≥®Ëß£ÔºåÊàë‰ª¨ÂèØ‰ª•‰æøÊç∑Âú∞ÂÆûÁé∞ËØ∑Ê±ÇÂèÇÊï∞Ê†°È™åÔºåÊó†ÈúÄÂÜôÂæàÂ§ö‰ª£Á†Å„ÄÇ</p>
<p>ËØïÊÉ≥ÔºåÊàë‰ª¨‰ΩøÁî®‰º†ÁªüÊñπÂºèÊ†°È™åËØ∑Ê±ÇÂèÇÊï∞ÔºåÂÖâÊòØÊ†°È™å <code>user.name</code>ÔºåÂ∞±ÈúÄË¶ÅÂÜôÂæàÂ§ö‰ª£Á†ÅÔºö</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> UserAndPet <span class="title function_">test</span><span class="params">(<span class="meta">@Validated</span> <span class="meta">@RequestBody</span> UserAndPet userAndPet)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (userAndPet == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (userAndPet.getUser() == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> userAndPet.getUser().getName();</span><br><span class="line">    <span class="keyword">if</span> (!(name != <span class="literal">null</span> &amp;&amp; name.length() &gt;= <span class="number">1</span> &amp;&amp; name.length() &lt;= <span class="number">5</span>)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Ê†°È™åÂÖ∂‰ªñËØ∑Ê±ÇÂèÇÊï∞</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ‰∏öÂä°ÈÄªËæë</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ÂΩìÁÑ∂ÔºåÊñπ‰æøÂø´Êç∑ÁöÑ Validation Ê≥®Ëß£Ê†°È™åÂª∫Á´ãÂú® Spring MVC Âíå Spring Boot ÁöÑÂü∫Á°Ä‰∏ä„ÄÇSpring Boot ÂÖ∑‰ΩìËá™Âä®Ë£ÖÈÖç‰∫ÜÂì™‰∫õÁ±ªÔºåSpring MVC ÂèàÊòØÂ¶Ç‰Ωï‰ΩøÁî®Ëøô‰∫õÁ±ªÂÆåÊàêËØ∑Ê±ÇÂèÇÊï∞Ê†°È™åÔºåÂ∞±‰∏çÂú®Êú¨ÊñáÁöÑËÆ®ËÆ∫ËåÉÂõ¥ÂÜÖ‰∫Ü„ÄÇÊúâÂÖ¥Ë∂£ÁöÑËØªËÄÖÂèØ‰ª•Ëá™Ë°åÈòÖËØªÊ∫êÁ†ÅÔºåÊàñËÄÖÈòÖËØªÂÖ∂‰ªñÊñáÁ´†„ÄÇ</p>
]]></content>
      <categories>
        <category>tech</category>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>Spring Boot</tag>
        <tag>Spring MVC</tag>
        <tag>Controller</tag>
      </tags>
  </entry>
  <entry>
    <title>Using Python venv</title>
    <url>/en/2023/12/20/Python-venv-use/</url>
    <content><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>Python is renowned for its rich set of modules. However, unlike in Java development where Maven uses group Id, artifact Id, and version to uniquely identify a dependency, in practice, most Python projects differentiate modules <strong>solely</strong> by their names. Run <code>pip install &lt;module&gt;</code>, and you‚Äôve got the module. But what about the module version? Most project requirements do not specify versions, leading to constant errors for those who run the project later.</p>
<p>Hence, the concept of a weakened version number undoubtedly does more harm than good. How to solve this issue? By using venv (virtual environment).</p>
<p>If you directly use <code>pip install</code>, all Python projects share these modules, leading to potential compatibility issues. Venv copies the original Python environment. The virtual environment runs only on the copied Python, and the installed modules exist only in that virtual environment. Multiple virtual environments are isolated from each other.</p>
<h1 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h1><p>1Ô∏è‚É£Create venv:</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">python <span class="literal">-m</span> venv C:\Users\Elnino\Desktop\test\venv</span><br></pre></td></tr></table></figure>

<p>The directory <code>C:\Users\Elnino\Desktop\test\venv</code> is the virtual environment.</p>
<span id="more"></span>

<p>2Ô∏è‚É£Activate:</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">venv\Scripts\activate</span><br></pre></td></tr></table></figure>

<p>If <code>(venv)</code> appears in front of the prompt, it means activation is successful, and you can now freely work inside.</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">(venv) C:\Users\Elnino\Desktop\test&gt;pip list</span><br></pre></td></tr></table></figure>

<p>3Ô∏è‚É£Deactivate: </p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">(venv) C:\Users\Elnino\Desktop\test&gt;deactivate</span><br><span class="line">C:\Users\Elnino\Desktop\test&gt;</span><br></pre></td></tr></table></figure>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://docs.python.org/3/library/venv.html">venv ‚Äî Creation of virtual environments</a></p>
]]></content>
      <categories>
        <category>tech</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>venv</tag>
      </tags>
  </entry>
  <entry>
    <title>VS Code Remote SSH Login By Key</title>
    <url>/en/2024/01/01/VS-Code-Remote-SSH-Login-By-Key/</url>
    <content><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>The Remote SSH extension in VS Code provides the functionality to connect to other remote hosts. While the basic way of connection requires a username and password, using a key allows for direct login without the effort to type the password every time.</p>
<p>However, it‚Äôs crucial to understand that VS Code merely provides a GUI, and how to use a SSH key to login is a separate matter. These two aspects should not be confused.</p>
<p>This article will primarily explain how to configure SSH keys on both the local machine and the remote machine. Subsequently, it will delve into the usage of the VS Code Remote SSH extension.</p>
<span id="more"></span>

<h1 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h1><ul>
<li>Local Machine: Windows 10</li>
<li>Remote Machine: Local virtual machine CentOS 8, root user</li>
</ul>
<h1 id="Local-SSH-Configuration"><a href="#Local-SSH-Configuration" class="headerlink" title="Local SSH Configuration"></a>Local SSH Configuration</h1><p>Using the <code>ssh-keygen</code> command will create the RSA public-private key pair for the <strong>local</strong> machine in the <code>C:\users\&lt;user&gt;\.ssh</code> directory:</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\Elnino\.ssh&gt; <span class="built_in">dir</span></span><br><span class="line">    Directory: C:\Users\Elnino\.ssh</span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line"><span class="literal">-a----</span>          <span class="number">2024</span>/<span class="number">1</span>/<span class="number">1</span>     <span class="number">12</span>:<span class="number">26</span>             <span class="number">91</span> config</span><br><span class="line"><span class="literal">-a----</span>         <span class="number">2023</span>/<span class="number">9</span>/<span class="number">30</span>     <span class="number">18</span>:<span class="number">03</span>           <span class="number">2610</span> id_rsa</span><br><span class="line"><span class="literal">-a----</span>         <span class="number">2023</span>/<span class="number">9</span>/<span class="number">30</span>     <span class="number">18</span>:<span class="number">03</span>            <span class="number">576</span> id_rsa.pub</span><br><span class="line"><span class="literal">-a----</span>        <span class="number">2023</span>/<span class="number">12</span>/<span class="number">18</span>     <span class="number">20</span>:<span class="number">42</span>           <span class="number">1398</span> known_hosts</span><br><span class="line"><span class="literal">-a----</span>         <span class="number">2023</span>/<span class="number">9</span>/<span class="number">30</span>     <span class="number">18</span>:<span class="number">03</span>             <span class="number">92</span> known_hosts.old</span><br></pre></td></tr></table></figure>

<p><code>id_rsa</code> is the private key, and <code>id_rsa.pub</code> is the public key.</p>
<h1 id="Remote-Host-SSH-Configuration"><a href="#Remote-Host-SSH-Configuration" class="headerlink" title="Remote Host SSH Configuration"></a>Remote Host SSH Configuration</h1><p>Upload the <strong>local</strong> <code>id_rsa.pub</code> to the <code>~/ssh</code> directory on the Linux remote host and rename it to <code>authorized_keys</code>:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">[root@CentOS100 .ssh]<span class="comment"># ll</span></span><br><span class="line">total 16</span><br><span class="line">-rw-r--r--. 1 root root 576 Jan  1 11:50 authorized_keys</span><br><span class="line">-rw-------. 1 root root 411 Jul  1  2023 id_ed25519</span><br><span class="line">-rw-r--r--. 1 root root  96 Jul  1  2023 id_ed25519.pub</span><br><span class="line">-rw-r--r--. 1 root root 880 Dec 18 21:07 known_hosts</span><br></pre></td></tr></table></figure>

<h1 id="ÊµãËØï"><a href="#ÊµãËØï" class="headerlink" title="ÊµãËØï"></a>ÊµãËØï</h1><p>The steps above complete the configuration needed for SSH key login. Open PowerShell on the local machine and test the connection using <code>ssh &lt;user&gt;@&lt;ip&gt;</code>. It should allow direct login without entering a password.</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\Elnino&gt; ssh root@CentOS100</span><br><span class="line">Activate the web console with: systemctl enable <span class="literal">--now</span> cockpit.socket</span><br><span class="line"></span><br><span class="line">Last login: Mon Jan  <span class="number">1</span> <span class="number">12</span>:<span class="number">26</span>:<span class="number">15</span> <span class="number">2024</span> from &lt;ip&gt;</span><br><span class="line">[<span class="type">root</span>@<span class="type">CentOS100</span> ~]<span class="comment"># pwd</span></span><br><span class="line">/root</span><br></pre></td></tr></table></figure>

<h1 id="VS-Code-Configuration"><a href="#VS-Code-Configuration" class="headerlink" title="VS Code Configuration"></a>VS Code Configuration</h1><ol>
<li><p>Install the <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-ssh">Remote - SSH</a> extension:</p>
<p> <img src="/en/MarkDownImages/image-20240101130622357.png" alt="image-20240101130622357"></p>
</li>
<li><p>Click these three buttons sequentially to access the configuration file:</p>
<p> <img src="/en/MarkDownImages/image-20240101130733756.png" alt="image-20240101130733756"></p>
</li>
<li><p>Fill in the configuration file (this file is essentially the SSH configuration for the host):</p>
<p> <img src="/en/MarkDownImages/image-20240101130804525.png" alt="image-20240101130804525"></p>
<ul>
<li><code>Host</code>: an ID for this remote connection; you can choose any name.</li>
<li><code>HostName</code>: Domain name or IP address of the remote host.</li>
<li><code>User</code>: User to login to the remote host.</li>
<li><code>IdentityFile</code>: Path to the <strong>private key</strong>, whose public key is in <code>authorized_keys</code>.</li>
</ul>
</li>
</ol>
<p>A few notes about the configuration file:</p>
<ul>
<li>If <code>authorized_keys</code> is not configured on the remote host, the <code>IdentityFile</code> property will not take effect, and it will prompt for a password during login.</li>
<li>In this case, <code>IdentityFile</code> is not necessary because <code>authorized_keys</code> is the local machine‚Äôs public key, and SSH defaults to using the local machine‚Äôs private key for connection attempts.</li>
<li>Generally, <code>authorized_keys</code> won‚Äôt be the local machine‚Äôs public key, and in such cases, <code>IdentityFile</code> must be configured; otherwise, a password will be required.</li>
</ul>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://medium.com/@sean4deepak/using-ssh-key-authentication-in-visual-studio-codes-remote-ssh-extension-4e5b922448e7">Using SSH Key Authentication in Visual Studio Code‚Äô s Remote SSH Extension</a></li>
<li><a href="https://adamtheautomator.com/add-ssh-key-to-vs-code/">Add SSH Key to VS Code and Connect to a Host</a></li>
<li><a href="https://stackoverflow.com/questions/48328446/id-rsa-pub-file-ssh-error-invalid-format">id_rsa.pub file SSH Error: invalid format</a></li>
</ul>
]]></content>
      <categories>
        <category>softwares</category>
        <category>VS Code</category>
      </categories>
      <tags>
        <tag>settings</tag>
        <tag>VS Code</tag>
        <tag>SSH</tag>
      </tags>
  </entry>
  <entry>
    <title>Display Original Filenames in Jellyfin</title>
    <url>/en/2024/02/17/jellyfin-original-filename/</url>
    <content><![CDATA[<h1 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h1><p>The recommended usage of Jellyfin is that users create folders according to the media rules and place media files in them. After that, the media titles are automatically generated based on the metadata obtained from the scraper. However, this rule is so compulsory that this simple functionality of <strong>using the original file name as the title</strong> is not even available. While manual updating media titles is possible, it can be cumbersome.</p>
<p>To fit this demand, I have created a script using <a href="https://github.com/jellyfin/jellyfin-apiclient-python">jellyfin-apiclient-python</a> to batch rename all media in a specific media library. Additionally, this article explores some previous solutions, none of which were satisfactory in my opinion.</p>
<span id="more"></span>

<h1 id="Existing-Solution-1"><a href="#Existing-Solution-1" class="headerlink" title="Existing Solution 1"></a>Existing Solution 1</h1><p>When creating a media library, choose ‚ÄòMusic Videos‚Äô as its content type and select ‚ÄòPrefer embedded titles over filenames‚Äô. </p>
<p>What is this ‚Äúembedded title‚Äù? Open the ‚ÄòProperties‚Äô of a video and go to ‚ÄòDetails‚Äô. </p>
<p><img src="/en/MarkDownImages/image-20240217135326419.png" alt="image-20240217135326419"></p>
<p>Any content in the ‚ÄòTitle‚Äô field will be displayed as the media title in Jellyfin without any modifications. However, this approach has two issues:</p>
<p>1Ô∏è‚É£ For most anime published, the values of their ‚ÄòTitle‚Äô are their series names, as shown in the image, lacking episode numbers, making it hard for me to distinguish.</p>
<p>This issue can be easily solved by copying the file name to ‚ÄòTitle‚Äô or clearing the ‚ÄòTitle‚Äô field. In either case, the original filename will be displayed eventually. For automation in Python, the <a href="https://github.com/quodlibet/mutagen">mutagen</a> module is handy to use.</p>
<p>2Ô∏è‚É£ Media libraries of type ‚ÄòMusic Videos‚Äô cannot display folder structures, which I find unacceptable. In fact, only ‚ÄòMixed Movies and Shows‚Äô will be presented in a pure folder format.</p>
<h1 id="Existing-Solution-2"><a href="#Existing-Solution-2" class="headerlink" title="Existing Solution 2"></a>Existing Solution 2</h1><p>Directly modify the database, as referenced in <a href="https://www.cnblogs.com/toumingbai/p/15514526.html">‚ÄòManually Correcting Titles to File (Folder) Names‚Äô</a>„ÄÇ</p>
<p>Bypassing the Service Tier to directly manipulate the database is too risky. I will never use this approach.</p>
<h1 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h1><p>Since directly manipulating the database in Solution 2 is bad, why not use the Jellyfin API?</p>
<p>The first step is to find which API corresponds to the required functionality. Instead of referring to the official documentation first, inspect the browser‚Äôs network traffic in Developer tools and then refer to the documentation. However, in most cases, the documentation is still useless, because there is no description. Under such circumstances, we need perform experiments to guess the usage of an API.</p>
<p>Fortunately, <a href="https://github.com/jellyfin/jellyfin-apiclient-python">jellyfin-apiclient-python</a> provides a ready-made API, eliminating the need to start from <code>requests</code>. I quickly completed the script:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> jellyfin_apiclient_python <span class="keyword">import</span> JellyfinClient</span><br><span class="line"><span class="keyword">from</span> jellyfin_apiclient_python.api <span class="keyword">import</span> API</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rename_to_filename</span>(<span class="params">jellyfin: API, item_id: <span class="built_in">str</span></span>):</span><br><span class="line">    metadata: <span class="built_in">dict</span> = jellyfin.get_item(item_id)</span><br><span class="line">    <span class="keyword">assert</span> metadata[<span class="string">&#x27;Id&#x27;</span>] == item_id</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(metadata[<span class="string">&#x27;MediaSources&#x27;</span>]) == <span class="number">1</span></span><br><span class="line">    path: <span class="built_in">str</span> = metadata[<span class="string">&#x27;MediaSources&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;Path&#x27;</span>]</span><br><span class="line">    filename = path.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Only modify Name, keep other info unchanged</span></span><br><span class="line">    metadata.update(&#123;<span class="string">&#x27;Name&#x27;</span>: filename&#125;)</span><br><span class="line">    <span class="keyword">return</span> jellyfin.items(<span class="string">&#x27;/&#x27;</span> + item_id, action=<span class="string">&#x27;POST&#x27;</span>, params=<span class="literal">None</span>, json=metadata)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rename_items_in_library</span>(<span class="params">jellyfin: API, library_id: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="comment"># get_items_by_letter recursively retrieves elements in all subfolders</span></span><br><span class="line">    res = jellyfin.get_items_by_letter(parent_id=library_id)</span><br><span class="line">    res = res[<span class="string">&#x27;Items&#x27;</span>]</span><br><span class="line">    item_count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> res:</span><br><span class="line">        <span class="keyword">if</span> r[<span class="string">&#x27;Type&#x27;</span>] == <span class="string">&#x27;Folder&#x27;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        rename_to_filename(jellyfin, r[<span class="string">&#x27;Id&#x27;</span>])</span><br><span class="line">        item_count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;total renamed item count: <span class="subst">&#123;item_count&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">client = JellyfinClient()</span><br><span class="line"><span class="comment"># Modify these client infos as needed; it doesn&#x27;t affect the result</span></span><br><span class="line">client.config.app(<span class="string">&#x27;pycharm&#x27;</span>, <span class="string">&#x27;0.0.1&#x27;</span>, <span class="string">&#x27;pycharm&#x27;</span>, <span class="string">&#x27;kufhskdf&#x27;</span>)</span><br><span class="line">client.config.data[<span class="string">&quot;auth.ssl&quot;</span>] = <span class="literal">True</span></span><br><span class="line">client.authenticate(&#123;<span class="string">&quot;Servers&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;AccessToken&quot;</span>: <span class="string">&quot;xxx&quot;</span>,  <span class="comment"># Create one in &#x27;Dashboard | API Keys&#x27;</span></span><br><span class="line">        <span class="string">&quot;address&quot;</span>: <span class="string">&quot;zzz&quot;</span>, <span class="comment"># Jellyfin server address</span></span><br><span class="line">        <span class="string">&quot;DateLastAccessed&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;UserId&quot;</span>: <span class="string">&quot;yyy&quot;</span>  <span class="comment"># This user should have the privilege to manage media library</span></span><br><span class="line">    &#125;</span><br><span class="line">]&#125;, discover=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(client.logged_in)</span><br><span class="line"></span><br><span class="line">rename_items_in_library(client.jellyfin, <span class="string">&#x27;uuu&#x27;</span>)  <span class="comment"># Fill in the media library ID</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>By the way, the documentation for this module is also poor; I only figured out how to connect to the server through Issues.</p>
</blockquote>
<p>My Jellyfin server‚Äôs certificate is self-signed, and it seems Python‚Äôs SSL cannot use the certificates installed on OS. We can resolve this by setting the environment variable <code>REQUESTS_CA_BUNDLE=&lt;certificate_path&gt;</code>.</p>
<p>My solution perfectly addresses the drawbacks of the two aforementioned solutions.</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://www.reddit.com/r/jellyfin/comments/pcptfz/possible_to_use_original_filenames_only/?utm_source=share&utm_medium=web2x&context=3">Possible to use original filenames only?</a></li>
<li><a href="https://www.cnblogs.com/toumingbai/p/15514526.html">jellyfinÊâãÂä®‰øÆÊ≠£Ê†áÈ¢ò‰∏∫Êñá‰ª∂ÔºàÂ§πÔºâÂêç</a></li>
<li><a href="https://github.com/jellyfin/jellyfin-apiclient-python">jellyfin-apiclient-python</a></li>
</ul>
]]></content>
      <categories>
        <category>tech</category>
        <category>NAS</category>
        <category>Python</category>
      </categories>
      <tags>
        <tag>NAS</tag>
        <tag>Jellyfin</tag>
        <tag>Python</tag>
      </tags>
  </entry>
  <entry>
    <title>Common Commands for pip &amp; conda</title>
    <url>/en/2024/01/14/pip-conda-Common-Commands/</url>
    <content><![CDATA[<h1 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h1><ol>
<li><p>Install <code>script-house</code>, version <code>0.0.2</code>.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip install script-house==0.0.2</span><br></pre></td></tr></table></figure>

<p> If you want to install the latest version by default, you can omit <code>==0.0.2</code>.</p>
<p> To install multiple dependencies in one line:</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip install script-house==0.0.2 pydantic==2.5.3 pymongo==4.6.1</span><br></pre></td></tr></table></figure></li>
</ol>
<span id="more"></span>

<ol start="2">
<li><p>List all dependencies.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip list</span><br></pre></td></tr></table></figure>
</li>
<li><p>List current dependencies in <code>requirements.txt</code> format.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip freeze</span><br></pre></td></tr></table></figure>

<p> The result of <code>pip freeze</code> is a subset of <code>pip list</code>. <code>pip list</code> usually includes fundamental dependencies like <code>pip</code>, <code>setuptools</code>, and <code>wheel</code>.</p>
<p> The purpose of <code>pip freeze</code> is to export project dependencies for others to use, while <code>pip list</code> is just for display.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip freeze &gt; requirements.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install all dependencies from <code>requirements.txt</code>.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>Uninstall a specific dependency.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip uninstall script-house</span><br></pre></td></tr></table></figure>
</li>
<li><p>Uninstall multiple dependencies.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip uninstall -r req.txt -y</span><br></pre></td></tr></table></figure>

<p> <code>-y</code> automatically confirms the deletion.</p>
<p> How to uninstall all dependencies in the current environment?</p>
 <figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">pip freeze &gt; req</span><br><span class="line">pip uninstall <span class="literal">-r</span> req <span class="literal">-y</span></span><br><span class="line"><span class="built_in">del</span> req</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="conda"><a href="#conda" class="headerlink" title="conda"></a>conda</h1><ol>
<li><p>After conda is installed on Linux, you should run <code>conda init</code> first before using conda commands; On Windows, there is no such need.</p>
</li>
<li><p>List all environments.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda <span class="built_in">env</span> list</span><br></pre></td></tr></table></figure>
</li>
<li><p>Create a new environment.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda create -n &lt;environment-name&gt; python=3.8</span><br></pre></td></tr></table></figure>

<p> The basic command is <code>conda create -n &lt;environment-name&gt;</code>, but specifying the Python version is a common practice. Compared to venv, conda environments also install some basic OS-dependent dependencies.</p>
</li>
<li><p>Activate an environment.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda activate &lt;environment-name&gt;</span><br></pre></td></tr></table></figure>

<p> On Windows, you probably need to omit <code>conda</code>.</p>
</li>
<li><p>Deactivate the environment.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure>
</li>
<li><p>Remove an environment.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda remove -n &lt;environment-name&gt; --all</span><br></pre></td></tr></table></figure>
</li>
<li><p>View basic information.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda info</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install dependencies.</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda install pytorch==1.12.1 torchvision==0.13.1 torchaudio==0.12.1 -c pytorch -c conda-forge</span><br></pre></td></tr></table></figure>

<p> Similar to pip, it follows the format <code>dependency==version</code>; the <code>-c</code> parameter specifies the download source (channel) as default channels often fail.</p>
</li>
<li><p>Create an environment from a configuration file (usually named <code>environment.yml</code>).</p>
 <figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda <span class="built_in">env</span> create -f environment.yml</span><br></pre></td></tr></table></figure>

<p> Content of <code>environment.yml</code>:</p>
 <figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">&lt;environment-name&gt;</span></span><br><span class="line"><span class="attr">channels:</span> <span class="comment"># -c parameter, specifying download source</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">pytorch</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">conda-forge</span></span><br><span class="line"><span class="attr">dependencies:</span> <span class="comment"># dependencies installed by conda</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">python=3.8</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">numpy</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">pandas</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">matplotlib</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">pip:</span> <span class="comment"># dependencies installed by pip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">imageio</span></span><br></pre></td></tr></table></figure>

<p> It‚Äôs not recommended to create a new environment by this method, because channels often fail.</p>
</li>
<li><p>Disable auto-activation of the base environment. If enabled, every new shell will automatically activate the base environment.</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">conda config --<span class="built_in">set</span> auto_activate_base <span class="literal">false</span></span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>tech</category>
        <category>Python</category>
        <category>cheat sheet</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>pip</tag>
        <tag>conda</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode Weekly Contest 369 Summary</title>
    <url>/en/2023/10/29/leetcode-369-weekly-contest-summary/</url>
    <content><![CDATA[<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><blockquote>
<p><a href="https://leetcode.cn/contest/weekly-contest-369/">LeetCode Weekly Contest 369</a></p>
</blockquote>
<blockquote>
<p>This article is a summary of the contest. I don‚Äôt plan to discuss each problem in detail, but will provide general ideas. The point of this article is self-reflection and improvement.</p>
</blockquote>
<p>After reviewing the contest, it is not so difficult. Here is a brief description of my performance on each problem:</p>
<ul>
<li>Problem 1: Simple simulation problem, an easy one.</li>
<li>Problem 2: Not difficult, but requires consideration of multiple cases. Unfortunately, I didn‚Äôt think thoroughly, resulting in 3 WA üòí.</li>
<li>Problem 3: a Medium-level DP problem. Initially struggled to come up with a solution, wasted time on the unsolved problem 4, but eventually solved it quickly üòã.</li>
<li>Problem 4: Despite being a hard-level problem and not solved during the contest, the code only exceeded time limits. After the contest, I figured out an optimization method by myself. Note that the messy logic during coding led to 2 WA üòí.</li>
</ul>
<span id="more"></span>

<h1 id="I-Find-the-K-or-of-an-Array"><a href="#I-Find-the-K-or-of-an-Array" class="headerlink" title="I. Find the K-or of an Array"></a>I. <a href="https://leetcode.cn/problems/find-the-k-or-of-an-array/">Find the K-or of an Array</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>You are given a <strong>0-indexed</strong> integer array <code>nums</code>, and an integer <code>k</code>.</p>
<p>The <strong>K-or</strong> of <code>nums</code> is a non-negative integer that satisfies the following:</p>
<ul>
<li>The <code>ith</code> bit is set in the K-or <strong>if and only if</strong> there are at least <code>k</code> elements of <code>nums</code> in which bit <code>i</code> is set.</li>
</ul>
<p>Return <em>the <strong>K-or</strong> of</em> <code>nums</code>.</p>
<p><strong>Note</strong> that a bit <code>i</code> is set in <code>x</code> if <code>(2i AND x) == 2i</code>, where <code>AND</code> is the bitwise <code>AND</code> operator.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [7,12,9,8,9,15], k = 4</span><br><span class="line">Output: 9</span><br><span class="line">Explanation: Bit 0 is set at nums[0], nums[2], nums[4], and nums[5].</span><br><span class="line">Bit 1 is set at nums[0], and nums[5].</span><br><span class="line">Bit 2 is set at nums[0], nums[1], and nums[5].</span><br><span class="line">Bit 3 is set at nums[1], nums[2], nums[3], nums[4], and nums[5].</span><br><span class="line">Only bits 0 and 3 are set in at least k elements of the array, and bits i &gt;= 4 are not set in any of the array&#x27;s elements. Hence, the answer is 2^0 + 2^3 = 9.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [2,12,1,11,4,5], k = 6</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: Since k == 6 == nums.length, the 6-or of the array is equal to the bitwise AND of all its elements. Hence, the answer is 2 AND 12 AND 1 AND 11 AND 4 AND 5 = 0.</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [10,8,5,9,11,6,8], k = 1</span><br><span class="line">Output: 15</span><br><span class="line">Explanation: Since k == 1, the 1-or of the array is equal to the bitwise OR of all its elements. Hence, the answer is 10 OR 8 OR 5 OR 9 OR 11 OR 6 OR 8 = 15.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 50</code></li>
<li><code>0 &lt;= nums[i] &lt; 231</code></li>
<li><code>1 &lt;= k &lt;= nums.length</code></li>
</ul>
</blockquote>
<p>The problem description is a bit hard to understand. Combining it with examples during the contest was necessary for quick understanding.</p>
<p>Bitwise simulation:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findKOr</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">val</span> <span class="operator">=</span> <span class="number">1</span> &lt;&lt; i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> num : nums) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((num &amp; val) &gt; <span class="number">0</span>) count++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (count &gt;= k)  &#123;</span><br><span class="line">                ans |= val;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Time complexity: $O(n)$</p>
<h1 id="II-Minimum-Equal-Sum-of-Two-Arrays-After-Replacing-Zeros"><a href="#II-Minimum-Equal-Sum-of-Two-Arrays-After-Replacing-Zeros" class="headerlink" title="II. Minimum Equal Sum of Two Arrays After Replacing Zeros"></a>II. <a href="https://leetcode.cn/problems/minimum-equal-sum-of-two-arrays-after-replacing-zeros/">Minimum Equal Sum of Two Arrays After Replacing Zeros</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>You are given two arrays <code>nums1</code> and <code>nums2</code> consisting of positive integers.</p>
<p>You have to replace <strong>all</strong> the <code>0</code>‚Äòs in both arrays with <strong>strictly</strong> positive integers such that the sum of elements of both arrays becomes <strong>equal</strong>.</p>
<p>Return <em>the <strong>minimum</strong> equal sum you can obtain, or</em> <code>-1</code> <em>if it is impossible</em>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums1 = [3,2,0,1,0], nums2 = [6,5,0]</span><br><span class="line">Output: 12</span><br><span class="line">Explanation: We can replace 0&#x27;s in the following way:</span><br><span class="line">- Replace the two 0&#x27;s in nums1 with the values 2 and 4. The resulting array is nums1 = [3,2,2,1,4].</span><br><span class="line">- Replace the 0 in nums2 with the value 1. The resulting array is nums2 = [6,5,1].</span><br><span class="line">Both arrays have an equal sum of 12. It can be shown that it is the minimum sum we can obtain.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums1 = [2,0,2,0], nums2 = [1,4]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: It is impossible to make the sum of both arrays equal.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= nums1.length, nums2.length &lt;= 105</code></li>
<li><code>0 &lt;= nums1[i], nums2[i] &lt;= 106</code></li>
</ul>
</blockquote>
<ul>
<li>If there are <code>k</code> zeros in <code>nums1</code>, its sum must increase by at least <code>k</code> after replacement.</li>
<li>If <code>nums1</code> has at least one zero, its sum after replacement can be any value greater than <code>sum(nums1)</code>.</li>
<li>Similar for <code>nums2</code>.</li>
</ul>
<p>Return type of the function is <code>long</code>. Array length is at most $10^5$, elements are at most $10^6$, and the sum is at most $10^{11}$, exceeding the limit of a 32-bit integer, which reminds us that all the intermediate results should be stored in <code>long</code> type. In fact, it is a common practice to replace <code>int</code> with <code>long</code> in coding contests to avoid integer overflow.</p>
<p>The key is to identify conditions where equality does not hold. A mistake in this aspect led to three WA:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">minSum</span><span class="params">(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">sum1</span> <span class="operator">=</span> Arrays.stream(nums1).mapToLong(i -&gt; i).sum();</span><br><span class="line">        <span class="type">long</span> <span class="variable">sum2</span> <span class="operator">=</span> Arrays.stream(nums2).mapToLong(i -&gt; i).sum();</span><br><span class="line">        <span class="type">long</span> <span class="variable">c1</span> <span class="operator">=</span> Arrays.stream(nums1).filter(i -&gt; i == <span class="number">0</span>).count();</span><br><span class="line">        <span class="type">long</span> <span class="variable">c2</span> <span class="operator">=</span> Arrays.stream(nums2).filter(i -&gt; i == <span class="number">0</span>).count();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (sum1 &gt; sum2) &#123;</span><br><span class="line">            <span class="comment">// sum2 can not increase</span></span><br><span class="line">            <span class="keyword">if</span> (c2 == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            <span class="comment">// sum1 can not increase, sum2 has c2 zeros, so sum2 will increase by at least c2</span></span><br><span class="line">            <span class="keyword">if</span> (c1 == <span class="number">0</span> &amp;&amp; c2 + sum2 &gt; sum1) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sum1 == sum2) &#123;</span><br><span class="line">            <span class="comment">// one of sum1 or sum2 must increase, while the other one will not change</span></span><br><span class="line">            <span class="keyword">if</span> (c1 == <span class="number">0</span> &amp;&amp; c2 != <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (c1 != <span class="number">0</span> &amp;&amp; c2 == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// same logic to the case where sum1 &gt; sum2</span></span><br><span class="line">            <span class="keyword">if</span> (c1 == <span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (c2 == <span class="number">0</span> &amp;&amp; c1 + sum1 &gt; sum2) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Math.max(sum1 + c1, sum2 + c2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="III-Minimum-Increment-Operations-to-Make-Array-Beautiful"><a href="#III-Minimum-Increment-Operations-to-Make-Array-Beautiful" class="headerlink" title="III. Minimum Increment Operations to Make Array Beautiful"></a>III. <a href="https://leetcode.cn/problems/minimum-increment-operations-to-make-array-beautiful/">Minimum Increment Operations to Make Array Beautiful</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>You are given a <strong>0-indexed</strong> integer array <code>nums</code> having length <code>n</code>, and an integer <code>k</code>.</p>
<p>You can perform the following <strong>increment</strong> operation <strong>any</strong> number of times (<strong>including zero</strong>):</p>
<ul>
<li>Choose an index <code>i</code> in the range <code>[0, n - 1]</code>, and increase <code>nums[i]</code> by <code>1</code>.</li>
</ul>
<p>An array is considered <strong>beautiful</strong> if, for any <strong>subarray</strong> with a size of <code>3</code> or <strong>more</strong>, its <strong>maximum</strong> element is <strong>greater than or equal</strong> to <code>k</code>.</p>
<p>Return <em>an integer denoting the <strong>minimum</strong> number of increment operations needed to make</em> <code>nums</code> <em><strong>beautiful</strong>.</em></p>
<p>A subarray is a contiguous <strong>non-empty</strong> sequence of elements within an array.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [2,3,0,0,2], k = 4</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: We can perform the following increment operations to make nums beautiful:</span><br><span class="line">Choose index i = 1 and increase nums[1] by 1 -&gt; [2,4,0,0,2].</span><br><span class="line">Choose index i = 4 and increase nums[4] by 1 -&gt; [2,4,0,0,3].</span><br><span class="line">Choose index i = 4 and increase nums[4] by 1 -&gt; [2,4,0,0,4].</span><br><span class="line">The subarrays with a size of 3 or more are: [2,4,0], [4,0,0], [0,0,4], [2,4,0,0], [4,0,0,4], [2,4,0,0,4].</span><br><span class="line">In all the subarrays, the maximum element is equal to k = 4, so nums is now beautiful.</span><br><span class="line">It can be shown that nums cannot be made beautiful with fewer than 3 increment operations.</span><br><span class="line">Hence, the answer is 3.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [0,1,3,3], k = 5</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: We can perform the following increment operations to make nums beautiful:</span><br><span class="line">Choose index i = 2 and increase nums[2] by 1 -&gt; [0,1,4,3].</span><br><span class="line">Choose index i = 2 and increase nums[2] by 1 -&gt; [0,1,5,3].</span><br><span class="line">The subarrays with a size of 3 or more are: [0,1,5], [1,5,3], [0,1,5,3].</span><br><span class="line">In all the subarrays, the maximum element is equal to k = 5, so nums is now beautiful.</span><br><span class="line">It can be shown that nums cannot be made beautiful with fewer than 2 increment operations.</span><br><span class="line">Hence, the answer is 2.</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [1,1,2], k = 1</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: The only subarray with a size of 3 or more in this example is [1,1,2].</span><br><span class="line">The maximum element, 2, is already greater than k = 1, so we don&#x27;t need any increment operation.</span><br><span class="line">Hence, the answer is 0.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>3 &lt;= n == nums.length &lt;= 105</code></li>
<li><code>0 &lt;= nums[i] &lt;= 109</code></li>
<li><code>0 &lt;= k &lt;= 109</code></li>
</ul>
</blockquote>
<blockquote>
<p>An array is considered <strong>beautiful</strong> if, for any subarray with a size of <strong><code>3</code> or more</strong>, its <strong>maximum</strong> element is greater than or equal to <code>k</code>.</p>
</blockquote>
<p>This condition is equivalent to having <strong>every subarray of length 3</strong> with a maximum element $\ge k$.</p>
<p>Obviously, we should try to ensure that in every three consecutive elements, at least one element is $\ge k$. However, it is unclear which elements should be increased to $k$. To address this, let‚Äôs use DP.</p>
<p>1Ô∏è‚É£DP definition: <code>dp[i]</code>: the <strong>minimum</strong> increment operations to make <strong><code>nums[0:i]</code></strong> a beautiful array and <strong><code>nums[i]</code></strong> $\ge k$. ‚Äî Here are three bold points.</p>
<p>If <code>nums[i]</code> $\ge k$, then <code>nums[i - 2 : i]</code> forms a subarray of length 3 that can be covered, satisfying the condition for being a beautiful array. This coverage simultaneously indicates that we need to ensure <code>nums[0:(i-3)]</code> is also a beautiful array to make <code>nums[0:i]</code> a beautiful array. Results from <code>dp[i - 3]</code>, <code>dp[i - 2]</code>, and <code>dp[i - 1]</code> all satisfy this requirement; thus, we take the minimum value in them:</p>
<p>2Ô∏è‚É£Recurrence relation: $dp[i] &#x3D; \max\set{0,k-nums[i]} + \min\set{dp[i - 1], dp[i - 2], dp[i - 3]}$</p>
<p>3Ô∏è‚É£Answer: Choose the minimum value among <code>dp[n - 3]</code>, <code>dp[n - 2]</code>, and <code>dp[n - 1]</code>, all of which can guarantee <code>nums</code> being a beautiful array by DP definition.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">minIncrementOperations</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">long</span>[] dp = <span class="keyword">new</span> <span class="title class_">long</span>[n];</span><br><span class="line">        <span class="comment">// base case</span></span><br><span class="line">        Arrays.fill(dp, Long.MAX_VALUE);</span><br><span class="line">        <span class="comment">// n &gt;= 3 guarantees that we do not need to check whether dp[0], dp[1] or dp[2] exists</span></span><br><span class="line">        dp[<span class="number">0</span>] = Math.max(<span class="number">0</span>, k - nums[<span class="number">0</span>]);</span><br><span class="line">        dp[<span class="number">1</span>] = Math.max(<span class="number">0</span>, k - nums[<span class="number">1</span>]);</span><br><span class="line">        dp[<span class="number">2</span>] = Math.max(<span class="number">0</span>, k - nums[<span class="number">2</span>]);</span><br><span class="line">        <span class="comment">// recursively</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">3</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">v</span> <span class="operator">=</span> Math.max(<span class="number">0</span>, k - nums[i]);</span><br><span class="line">            dp[i] = Math.min(dp[i], dp[i - <span class="number">1</span>] + v);</span><br><span class="line">            dp[i] = Math.min(dp[i], dp[i - <span class="number">2</span>] + v);</span><br><span class="line">            dp[i] = Math.min(dp[i], dp[i - <span class="number">3</span>] + v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// answer</span></span><br><span class="line">        <span class="keyword">return</span> Math.min(dp[n - <span class="number">1</span>], Math.min(dp[n - <span class="number">2</span>], dp[n - <span class="number">3</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="IV-Maximum-Points-After-Collecting-Coins-From-All-Nodes"><a href="#IV-Maximum-Points-After-Collecting-Coins-From-All-Nodes" class="headerlink" title="IV. Maximum Points After Collecting Coins From All Nodes"></a>IV. <a href="https://leetcode.cn/problems/maximum-points-after-collecting-coins-from-all-nodes/">Maximum Points After Collecting Coins From All Nodes</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>There exists an undirected tree rooted at node <code>0</code> with <code>n</code> nodes labeled from <code>0</code> to <code>n - 1</code>. You are given a 2D <strong>integer</strong> array <code>edges</code> of length <code>n - 1</code>, where <code>edges[i] = [ai, bi]</code> indicates that there is an edge between nodes <code>ai</code> and <code>bi</code> in the tree. You are also given a <strong>0-indexed</strong> array <code>coins</code> of size <code>n</code> where <code>coins[i]</code> indicates the number of coins in the vertex <code>i</code>, and an integer <code>k</code>.</p>
<p>Starting from the root, you have to collect all the coins such that the coins at a node can only be collected if the coins of its ancestors have been already collected.</p>
<p>Coins at <code>nodei</code> can be collected in one of the following ways:</p>
<ul>
<li>Collect all the coins, but you will get <code>coins[i] - k</code> points. If <code>coins[i] - k</code> is negative then you will lose <code>abs(coins[i] - k)</code> points.</li>
<li>Collect all the coins, but you will get <code>floor(coins[i] / 2)</code> points. If this way is used, then for all the <code>nodej</code> present in the subtree of <code>nodei</code>, <code>coins[j]</code> will get reduced to <code>floor(coins[j] / 2)</code>.</li>
</ul>
<p>Return <em>the <strong>maximum points</strong> you can get after collecting the coins from <strong>all</strong> the tree nodes.</em></p>
<p><strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2023/09/18/ex1-copy.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[0,1],[1,2],[2,3]], coins = [10,10,3,3], k = 5</span><br><span class="line">Output: 11                        </span><br><span class="line">Explanation: </span><br><span class="line">Collect all the coins from node 0 using the first way. Total points = 10 - 5 = 5.</span><br><span class="line">Collect all the coins from node 1 using the first way. Total points = 5 + (10 - 5) = 10.</span><br><span class="line">Collect all the coins from node 2 using the second way so coins left at node 3 will be floor(3 / 2) = 1. Total points = 10 + floor(3 / 2) = 11.</span><br><span class="line">Collect all the coins from node 3 using the second way. Total points = 11 + floor(1 / 2) = 11.</span><br><span class="line">It can be shown that the maximum points we can get after collecting coins from all the nodes is 11. </span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<p><strong><img src="https://assets.leetcode.com/uploads/2023/09/18/ex2.png" alt="img"></strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[0,1],[0,2]], coins = [8,4,4], k = 0</span><br><span class="line">Output: 16</span><br><span class="line">Explanation: </span><br><span class="line">Coins will be collected from all the nodes using the first way. Therefore, total points = (8 - 0) + (4 - 0) + (4 - 0) = 16.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == coins.length</code></li>
<li><code>2 &lt;= n &lt;= 105</code></li>
<li><code>0 &lt;= coins[i] &lt;= 104</code></li>
<li><code>edges.length == n - 1</code></li>
<li><code>0 &lt;= edges[i][0], edges[i][1] &lt; n</code></li>
<li><code>0 &lt;= k &lt;= 104</code></li>
</ul>
</blockquote>
<p>1Ô∏è‚É£Build the tree. It‚Äôs essentially building a graph, and we need to perform DFS starting from node 0 to simulate tree traversal.</p>
<p>2Ô∏è‚É£There are two ways to collect coins (the problem is intentionally written in complicated words, requiring simplification):</p>
<ul>
<li>Option 1: Currently-collected coins plus <code>coins[i] - k</code> (regardless of sign).</li>
<li>Option 2: <code>floor(coins[i] / 2)</code> is essentially integer division, we should optimize the division using bitwise operation i.e., <code>coins[i] &gt;&gt; 1</code>. Bitwise operation also has the advantage that if the current node has $k$ ancestors choosing Option 2, then the coin count for that node is <code>coins[i] &gt;&gt; k</code>, avoiding the time cost of computing $2^k$ and division by $2^k$.</li>
</ul>
<p>Based on these two options, we can write a recursive function for pre-order traversal:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Pre-order traversal, collecting coins</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> root Root node of the subtree</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> half Number of times ancestors of the subtree chose Option 2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> Maximum coins that can be collected in the subtree</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">long</span> <span class="title function_">recur</span><span class="params">(Node root, <span class="type">long</span> half)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// Node is a graph node, visited is used for traversal</span></span><br><span class="line">    <span class="comment">// Pre-order traversal is essentially DFS</span></span><br><span class="line">    visited[root.index] = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// Option 1</span></span><br><span class="line">    <span class="type">long</span> <span class="variable">res1</span> <span class="operator">=</span> (root.val &gt;&gt; half) - k;</span><br><span class="line">    <span class="keyword">for</span> (Node child : root.children) &#123;</span><br><span class="line">        <span class="keyword">if</span> (visited[child.index]) <span class="keyword">continue</span>;</span><br><span class="line">        res1 += recur(child, half);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Option 2</span></span><br><span class="line">    <span class="type">long</span> <span class="variable">res2</span> <span class="operator">=</span> (root.val &gt;&gt; (<span class="number">1</span> + half));</span><br><span class="line">    <span class="keyword">for</span> (Node child : root.children) &#123;</span><br><span class="line">        <span class="keyword">if</span> (visited[child.index]) <span class="keyword">continue</span>;</span><br><span class="line">        res2 += recur(child, half + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    visited[root.index] = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> Math.max(res1, res2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Up to this point, I had written the code during the contest but still encountered a timeout. Later, I came up with the following optimization ideas:</p>
<p>3Ô∏è‚É£ $\forall i, coins[i] \le 10^4$, and $\log_2(10^4) \approx 13.8$. Thus, as long as the ancestors of the current subtree have chosen Option 2 at least 14 times, the coin count for all nodes in this subtree will continuously halve to 0.</p>
<p>This is basically a pruning technique, and we check it at the beginning of the <code>recur</code> function:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (half &gt;= <span class="number">14</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>4Ô∏è‚É£Speaking of recursion, we think about divide and conquer paradigms, which then lead to thoughts about DP paradigms. What is the difference between the two? ‚Äî DP reuses results of subproblems, making it more efficient.</p>
<p>Although the process of traversing the tree cannot be written as an iteration, we can use a map to cache results of subproblems: the key is <code>(nodes[i], half)</code>, and the value is the number of collected coins.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Node, HashMap&lt;Long, Long&gt;&gt; dpMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">long</span> <span class="title function_">recur</span><span class="params">(Node root, <span class="type">long</span> half)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// Check cache, return directly if found</span></span><br><span class="line">    HashMap&lt;Long, Long&gt; mp = dpMap.get(root);</span><br><span class="line">    <span class="keyword">if</span> (mp != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">ans</span> <span class="operator">=</span> mp.get(half);</span><br><span class="line">        <span class="keyword">if</span> (ans != <span class="literal">null</span>) <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Option 1 and Option 2 code...</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Insert into cache</span></span><br><span class="line">    <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> Math.max(res1, res2);</span><br><span class="line">    dpMap.putIfAbsent(root, <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;());</span><br><span class="line">    dpMap.get(root).put(half, ans);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>With these two optimization steps, the code successfully passed:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        List&lt;Node&gt; children = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> val;</span><br><span class="line">        <span class="type">int</span> index;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> val, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.index = index;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> k;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span>[] visited;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maximumPoints</span><span class="params">(<span class="type">int</span>[][] edges, <span class="type">int</span>[] coins, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.k = k;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> coins.length;</span><br><span class="line">        visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[n];</span><br><span class="line">        Node[] nodes = IntStream.range(<span class="number">0</span>, n).mapToObj(i -&gt; <span class="keyword">new</span> <span class="title class_">Node</span>(coins[i], i)).toArray(Node[]::<span class="keyword">new</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] e : edges) &#123;</span><br><span class="line">            nodes[e[<span class="number">0</span>]].children.add(nodes[e[<span class="number">1</span>]]);</span><br><span class="line">            nodes[e[<span class="number">1</span>]].children.add(nodes[e[<span class="number">0</span>]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">int</span>) recur(nodes[<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Recursive result cache, elevates divide and conquer algorithm to DP algorithm for efficiency</span></span><br><span class="line"><span class="comment">     * &lt;node, &lt;half, result&gt;&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;Node, HashMap&lt;Long, Long&gt;&gt; dpMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Pre-order traversal, collecting coins</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> root Root node of the subtree</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> half Number of times ancestors of the subtree chose Option 2</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Maximum coins that can be collected in the subtree</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="title function_">recur</span><span class="params">(Node root, <span class="type">long</span> half)</span> &#123;</span><br><span class="line">        <span class="comment">// coins[i] &lt;= 10^4 -&gt; log_2 (10^4) &lt; 14</span></span><br><span class="line">        <span class="keyword">if</span> (half &gt;= <span class="number">14</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// Check cache, return directly if found</span></span><br><span class="line">        HashMap&lt;Long, Long&gt; mp = dpMap.get(root);</span><br><span class="line">        <span class="keyword">if</span> (mp != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Long</span> <span class="variable">ans</span> <span class="operator">=</span> mp.get(half);</span><br><span class="line">            <span class="keyword">if</span> (ans != <span class="literal">null</span>) <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Node is a graph node, visited is used for traversal</span></span><br><span class="line">        <span class="comment">// Pre-order traversal is essentially DFS</span></span><br><span class="line">        visited[root.index] = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// Option 1</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">res1</span> <span class="operator">=</span> (root.val &gt;&gt; half) - k;</span><br><span class="line">        <span class="keyword">for</span> (Node child : root.children) &#123;</span><br><span class="line">            <span class="keyword">if</span> (visited[child.index]) <span class="keyword">continue</span>;</span><br><span class="line">            res1 += recur(child, half);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Option 2</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">res2</span> <span class="operator">=</span> (root.val &gt;&gt; (<span class="number">1</span> + half));</span><br><span class="line">        <span class="keyword">for</span> (Node child : root.children) &#123;</span><br><span class="line">            <span class="keyword">if</span> (visited[child.index]) <span class="keyword">continue</span>;</span><br><span class="line">            res2 += recur(child, half + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        visited[root.index] = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// Insert into cache</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> Math.max(res1, res2);</span><br><span class="line">        dpMap.putIfAbsent(root, <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;());</span><br><span class="line">        dpMap.get(root).put(half, ans);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Algorithm Problems</category>
        <category>Algorithm Contest</category>
      </categories>
      <tags>
        <tag>Simulation</tag>
        <tag>DP</tag>
        <tag>Tree</tag>
        <tag>Bit Manipulation</tag>
      </tags>
  </entry>
  <entry>
    <title>LeetCode Weekly Contest 370 Summary</title>
    <url>/en/2023/11/05/leetcode-370-weekly-contest-summary/</url>
    <content><![CDATA[<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><blockquote>
<p><a href="https://leetcode.cn/contest/weekly-contest-370/">LeetCode Weekly Contest 370</a></p>
</blockquote>
<blockquote>
<p>This article is a summary of the weekly contest. I do not plan to discuss each problem in detail; for some problems, I will only provide a rough outline. The point of this article is self-reflection and improvement.</p>
</blockquote>
<p>Achieved AC in the first three problems within 23 minutes, resulting in a ranking around 300 - more like a typing contest emphasizing speed rather than a coding contest. Brief description of problem-solving:</p>
<ul>
<li>Problem 1: Easy problem but got stuck for 5 minutes üòí;</li>
<li>Problem 2: Similar to the first one in terms of background, also easy problem, but solved faster üòã;</li>
<li>Problem 3: A real medium-level problem that required a bit more thought, solved in 15 minutes, not bad üòã;</li>
<li>Problem 4: Couldn‚Äôt solve. If the data range is small, it‚Äôs a simple DP problem, but couldn‚Äôt find an optimization üòí;</li>
</ul>
<span id="more"></span>



<h1 id="I-Find-Champion-I"><a href="#I-Find-Champion-I" class="headerlink" title="I. Find Champion I"></a>I. <a href="https://leetcode.cn/problems/find-champion-i/">Find Champion I</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>There are <code>n</code> teams numbered from <code>0</code> to <code>n - 1</code> in a tournament.</p>
<p>Given a <strong>0-indexed</strong> 2D boolean matrix <code>grid</code> of size <code>n * n</code>. For all <code>i, j</code> that <code>0 &lt;= i, j &lt;= n - 1</code> and <code>i != j</code> team <code>i</code> is <strong>stronger</strong> than team <code>j</code> if <code>grid[i][j] == 1</code>, otherwise, team <code>j</code> is <strong>stronger</strong> than team <code>i</code>.</p>
<p>Team <code>a</code> will be the <strong>champion</strong> of the tournament if there is no team <code>b</code> that is stronger than team <code>a</code>.</p>
<p>Return <em>the team that will be the champion of the tournament.</em></p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: grid = [[0,1],[0,0]]</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: There are two teams in this tournament.</span><br><span class="line">grid[0][1] == 1 means that team 0 is stronger than team 1. So team 0 will be the champion.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: grid = [[0,0,1],[1,0,1],[0,0,0]]</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: There are three teams in this tournament.</span><br><span class="line">grid[1][0] == 1 means that team 1 is stronger than team 0.</span><br><span class="line">grid[1][2] == 1 means that team 1 is stronger than team 2.</span><br><span class="line">So team 1 will be the champion.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>n == grid.length</code></li>
<li><code>n == grid[i].length</code></li>
<li><code>2 &lt;= n &lt;= 100</code></li>
<li><code>grid[i][j]</code> is either <code>0</code> or <code>1</code>.</li>
<li>For all <code>i grid[i][i]</code> is <code>0.</code></li>
<li>For all <code>i, j</code> that <code>i != j</code>, <code>grid[i][j] != grid[j][i]</code>.</li>
<li>The input is generated such that if team <code>a</code> is stronger than team <code>b</code> and team <code>b</code> is stronger than team <code>c</code>, then team <code>a</code> is stronger than team <code>c</code>.</li>
</ul>
</blockquote>
<p>‚ÄòTeam <code>a</code> will be the <strong>champion</strong> of the tournament if there is no team <code>b</code> that is stronger than team <code>a</code>.‚Äô Use <code>count[i]</code> to represent the number of teams stronger than <code>i</code>. The answer is the <code>i</code> with $count[i] &#x3D; 0$.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findChampion</span><span class="params">(<span class="type">int</span>[][] grid)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> grid.length;</span><br><span class="line">        <span class="type">int</span>[] count = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i == j) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (grid[i][j] == <span class="number">1</span>) count[j]++;</span><br><span class="line">                <span class="keyword">else</span> count[i]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (count[i] == <span class="number">0</span>) <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="II-Find-Champion-II"><a href="#II-Find-Champion-II" class="headerlink" title="II. Find Champion II"></a>II. <a href="https://leetcode.cn/problems/find-champion-ii/">Find Champion II</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>There are <code>n</code> teams numbered from <code>0</code> to <code>n - 1</code> in a tournament; each team is also a node in a <strong>DAG</strong>.</p>
<p>You are given the integer <code>n</code> and a <strong>0-indexed</strong> 2D integer array <code>edges</code> of length <code>m</code> representing the <strong>DAG</strong>, where <code>edges[i] = [ui, vi]</code> indicates that there is a directed edge from team <code>ui</code> to team <code>vi</code> in the graph.</p>
<p>A directed edge from <code>a</code> to <code>b</code> in the graph means that team <code>a</code> is <strong>stronger</strong> than team <code>b</code> and team <code>b</code> is <strong>weaker</strong> than team <code>a</code>.</p>
<p>Team <code>a</code> will be the <strong>champion</strong> of the tournament if there is no team <code>b</code> that is <strong>stronger</strong> than team <code>a</code>.</p>
<p>Return <em>the team that will be the <strong>champion</strong> of the tournament if there is a <strong>unique</strong> champion, otherwise, return</em> <code>-1</code><em>.</em></p>
<p><strong>Notes</strong></p>
<ul>
<li>A <strong>cycle</strong> is a series of nodes <code>a1, a2, ..., an, an+1</code> such that node <code>a1</code> is the same node as node <code>an+1</code>, the nodes <code>a1, a2, ..., an</code> are distinct, and there is a directed edge from the node <code>ai</code> to node <code>ai+1</code> for every <code>i</code> in the range <code>[1, n]</code>.</li>
<li>A <strong>DAG</strong> is a directed graph that does not have any <strong>cycle</strong>.</li>
</ul>
<p><strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2023/10/19/graph-3.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: n = 3, edges = [[0,1],[1,2]]</span><br><span class="line">Output: 0</span><br><span class="line">Explanation: Team 1 is weaker than team 0. Team 2 is weaker than team 1. So the champion is team 0.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2023/10/19/graph-4.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: n = 4, edges = [[0,2],[1,3],[1,2]]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: Team 2 is weaker than team 0 and team 1. Team 3 is weaker than team 1. But team 1 and team 0 are not weaker than any other teams. So the answer is -1.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= n &lt;= 100</code></li>
<li><code>m == edges.length</code></li>
<li><code>0 &lt;= m &lt;= n * (n - 1) / 2</code></li>
<li><code>edges[i].length == 2</code></li>
<li><code>0 &lt;= edge[i][j] &lt;= n - 1</code></li>
<li><code>edges[i][0] != edges[i][1]</code></li>
<li>The input is generated such that if team <code>a</code> is stronger than team <code>b</code>, team <code>b</code> is not stronger than team <code>a</code>.</li>
<li>The input is generated such that if team <code>a</code> is stronger than team <code>b</code> and team <code>b</code> is stronger than team <code>c</code>, then team <code>a</code> is stronger than team <code>c</code>.</li>
</ul>
</blockquote>
<p>Use directed edges to represent who is stronger, making it easier to understand than the first problem. Edge $(a,b)$ means <code>a</code> is stronger than <code>b</code>, so the teams with the strongest members have an in-degree of 0. Count the in-degrees.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findChampion</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[][] edges)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] inDeg = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">        <span class="comment">// Count in-degrees</span></span><br><span class="line">        Arrays.stream(edges).forEach(e -&gt; inDeg[e[<span class="number">1</span>]]++);</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> Arrays.stream(inDeg).filter(i -&gt; i == <span class="number">0</span>).count();</span><br><span class="line">        <span class="comment">// Not unique</span></span><br><span class="line">        <span class="keyword">if</span> (count != <span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (inDeg[i] == <span class="number">0</span>) <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="III-Maximum-Score-After-Applying-Operations-on-a-Tree"><a href="#III-Maximum-Score-After-Applying-Operations-on-a-Tree" class="headerlink" title="III. Maximum Score After Applying Operations on a Tree"></a>III. <a href="https://leetcode.cn/problems/maximum-score-after-applying-operations-on-a-tree/">Maximum Score After Applying Operations on a Tree</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>There is an undirected tree with <code>n</code> nodes labeled from <code>0</code> to <code>n - 1</code>, and rooted at node <code>0</code>. You are given a 2D integer array <code>edges</code> of length <code>n - 1</code>, where <code>edges[i] = [ai, bi]</code> indicates that there is an edge between nodes <code>ai</code> and <code>bi</code> in the tree.</p>
<p>You are also given a <strong>0-indexed</strong> integer array <code>values</code> of length <code>n</code>, where <code>values[i]</code> is the <strong>value</strong> associated with the <code>ith</code> node.</p>
<p>You start with a score of <code>0</code>. In one operation, you can:</p>
<ul>
<li>Pick any node <code>i</code>.</li>
<li>Add <code>values[i]</code> to your score.</li>
<li>Set <code>values[i]</code> to <code>0</code>.</li>
</ul>
<p>A tree is <strong>healthy</strong> if the sum of values on the path from the root to any leaf node is different than zero.</p>
<p>Return <em>the <strong>maximum score</strong> you can obtain after performing these operations on the tree any number of times so that it remains <strong>healthy</strong>.</em></p>
<p><strong>Example 1:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2023/10/11/graph-13-1.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[0,1],[0,2],[0,3],[2,4],[4,5]], values = [5,2,5,2,1,1]</span><br><span class="line">Output: 11</span><br><span class="line">Explanation: We can choose nodes 1, 2, 3, 4, and 5. The value of the root is non-zero. Hence, the sum of values on the path from the root to any leaf is different than zero. Therefore, the tree is healthy and the score is values[1] + values[2] + values[3] + values[4] + values[5] = 11.</span><br><span class="line">It can be shown that 11 is the maximum score obtainable after any number of operations on the tree.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<p><img src="https://assets.leetcode.com/uploads/2023/10/11/graph-14-2.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: edges = [[0,1],[0,2],[1,3],[1,4],[2,5],[2,6]], values = [20,10,9,7,4,3,5]</span><br><span class="line">Output: 40</span><br><span class="line">Explanation: We can choose nodes 0, 2, 3, and 4.</span><br><span class="line">- The sum of values on the path from 0 to 4 is equal to 10.</span><br><span class="line">- The sum of values on the path from 0 to 3 is equal to 10.</span><br><span class="line">- The sum of values on the path from 0 to 5 is equal to 3.</span><br><span class="line">- The sum of values on the path from 0 to 6 is equal to 5.</span><br><span class="line">Therefore, the tree is healthy and the score is values[0] + values[2] + values[3] + values[4] = 40.</span><br><span class="line">It can be shown that 40 is the maximum score obtainable after any number of operations on the tree.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>2 &lt;= n &lt;= 2 * 104</code></li>
<li><code>edges.length == n - 1</code></li>
<li><code>edges[i].length == 2</code></li>
<li><code>0 &lt;= ai, bi &lt; n</code></li>
<li><code>values.length == n</code></li>
<li><code>1 &lt;= values[i] &lt;= 109</code></li>
<li>The input is generated such that <code>edges</code> represents a valid tree.</li>
</ul>
</blockquote>
<p>$\forall i, values[i] \ge 1$, and ‚Äòthe sum of values on the path from the root to any leaf node is different than zero‚Äô. Hence, when performing operations, we must <strong>leave one node untouched on each path from the root to a leaf</strong> (Multiple paths may share one untouched node).</p>
<p>Let the set of all nodes in the graph be $V$, and the set of nodes <strong>left untouched</strong> be $U$. The goal is to maximize the score, which is given by $\sum\limits_{v\in V} v - \sum\limits_{u\in U}u$. $\sum\limits_{v\in V} v$ is simply <code>sum(values)</code>, so to maximize the score, we want to minimize $\sum\limits_{u\in U}u$. Which nodes should we leave untouched?</p>
<p>For any subtree of the tree, such as the one shown below:</p>
<p><img src="/en/MarkDownImages/image-20231105135510005.png" alt="image-20231105135510005"></p>
<p>Assume we do not operate on the root node 0, then all the remaining nodes can be modified; assume we operate on the root node 0, then there exist nodes in the remaining nodes that cannot be modified. Whatever the remaining nodes are, i.e. leaf nodes or multiple subtrees, it doesn‚Äôt affect this conclusion.</p>
<p>So when should we operate on the root node? Define <strong>the minimum sum</strong> of <strong>unoperated</strong> nodes in a <strong>healthy</strong> subtree rooted at $u$ as $res(u)$. Then, $\forall x, x$ is a child node of $u$, $res(u) &#x3D; \min\set{values[u], \sum\limits_x res(x)}$</p>
<p>The meaning of this recursive formula is:</p>
<ul>
<li>Either do not operate on the root node $u$, in which case the subtree is healthy, and all descendants can be operated on;</li>
<li>Or operate on the root node $u$, but all subtrees of $u$ must ensure they are healthy;</li>
<li>By the definition, we need to obtain <strong>the minimum sum</strong>, so we take the smaller value of the two situations;</li>
</ul>
<p>For the example above, $res(1) &#x3D; 2,res(2) &#x3D; 2,res(3) &#x3D; 5$</p>
<p>$values[0] &#x3D; 5 &lt; \sum\limits_{x\in\set{1,2,3}}res(x) &#x3D; 9$, so we do not operate on the root node 0 but operate on all nodes in its subtrees.</p>
<p>With the recurrence relation for $res(u)$, the value of $\sum\limits_{u\in U}u$ mentioned earlier is $res(0)$, hence the maximum score is <code>sum(values) - res(0)</code>. </p>
<p>Code:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Node</span><span class="params">(<span class="type">int</span> val, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.val = val;</span><br><span class="line">            <span class="built_in">this</span>.index = index;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;Node&gt; children = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> val;</span><br><span class="line">        <span class="type">int</span> index;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">maximumScoreAfterOperations</span><span class="params">(<span class="type">int</span>[][] edges, <span class="type">int</span>[] values)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> values.length;</span><br><span class="line">        <span class="comment">// Build the tree, essentially building a graph</span></span><br><span class="line">        Node[] nodes = IntStream.range(<span class="number">0</span>, n).mapToObj(i -&gt; <span class="keyword">new</span> <span class="title class_">Node</span>(values[i], i)).toArray(Node[]::<span class="keyword">new</span>);</span><br><span class="line">        Arrays.stream(edges).forEach(e -&gt; &#123;</span><br><span class="line">            nodes[e[<span class="number">0</span>]].children.add(nodes[e[<span class="number">1</span>]]);</span><br><span class="line">            nodes[e[<span class="number">1</span>]].children.add(nodes[e[<span class="number">0</span>]]);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="type">boolean</span>[] visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[n];</span><br><span class="line">        visited[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// values[i] &lt;= 10^9Ôºåpay attention to mapToLong</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">sum</span> <span class="operator">=</span> Arrays.stream(values).mapToLong(i -&gt; i).sum();</span><br><span class="line">        <span class="type">long</span> <span class="variable">min</span> <span class="operator">=</span> dfs(nodes[<span class="number">0</span>], visited);</span><br><span class="line">        <span class="keyword">return</span> sum - min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> root Root node</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> res(root)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="title function_">dfs</span><span class="params">(Node root, <span class="type">boolean</span>[] visited)</span> &#123;</span><br><span class="line">        <span class="comment">// count # visited neighbors</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// min = sum(res(children))</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">min</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Node child : root.children) &#123;</span><br><span class="line">            <span class="keyword">if</span> (visited[child.index]) &#123;</span><br><span class="line">                count++;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            visited[child.index] = <span class="literal">true</span>;</span><br><span class="line">            min += dfs(child, visited);</span><br><span class="line">            visited[child.index] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// this node is a leaf, return its val directly</span></span><br><span class="line">        <span class="keyword">if</span> (count == root.children.size()) &#123;</span><br><span class="line">            <span class="keyword">return</span> root.val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Math.min(root.val, min);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="IV-Maximum-Balanced-Subsequence-Sum"><a href="#IV-Maximum-Balanced-Subsequence-Sum" class="headerlink" title="IV. Maximum Balanced Subsequence Sum"></a>IV. <a href="https://leetcode.cn/problems/maximum-balanced-subsequence-sum/">Maximum Balanced Subsequence Sum</a></h1><blockquote>
<p><strong>Problem Description:</strong></p>
<p>You are given a <strong>0-indexed</strong> integer array <code>nums</code>.</p>
<p>A <strong>subsequence</strong> of <code>nums</code> having length <code>k</code> and consisting of <strong>indices</strong> <code>i0 &lt; i1 &lt; ... &lt; ik-1</code> is <strong>balanced</strong> if the following holds:</p>
<ul>
<li><code>nums[ij] - nums[ij-1] &gt;= ij - ij-1</code>, for every <code>j</code> in the range <code>[1, k - 1]</code>.</li>
</ul>
<p>A <strong>subsequence</strong> of <code>nums</code> having length <code>1</code> is considered balanced.</p>
<p>Return <em>an integer denoting the <strong>maximum</strong> possible <strong>sum of elements</strong> in a <strong>balanced</strong> subsequence of</em> <code>nums</code>.</p>
<p>A <strong>subsequence</strong> of an array is a new <strong>non-empty</strong> array that is formed from the original array by deleting some (<strong>possibly none</strong>) of the elements without disturbing the relative positions of the remaining elements.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [3,3,5,6]</span><br><span class="line">Output: 14</span><br><span class="line">Explanation: In this example, the subsequence [3,5,6] consisting of indices 0, 2, and 3 can be selected.</span><br><span class="line">nums[2] - nums[0] &gt;= 2 - 0.</span><br><span class="line">nums[3] - nums[2] &gt;= 3 - 2.</span><br><span class="line">Hence, it is a balanced subsequence, and its sum is the maximum among the balanced subsequences of nums.</span><br><span class="line">The subsequence consisting of indices 1, 2, and 3 is also valid.</span><br><span class="line">It can be shown that it is not possible to get a balanced subsequence with a sum greater than 14.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [5,-1,-3,8]</span><br><span class="line">Output: 13</span><br><span class="line">Explanation: In this example, the subsequence [5,8] consisting of indices 0 and 3 can be selected.</span><br><span class="line">nums[3] - nums[0] &gt;= 3 - 0.</span><br><span class="line">Hence, it is a balanced subsequence, and its sum is the maximum among the balanced subsequences of nums.</span><br><span class="line">It can be shown that it is not possible to get a balanced subsequence with a sum greater than 13.</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Input: nums = [-2,-1]</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: In this example, the subsequence [-1] can be selected.</span><br><span class="line">It is a balanced subsequence, and its sum is the maximum among the balanced subsequences of nums.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= nums.length &lt;= 105</code></li>
<li><code>-109 &lt;= nums[i] &lt;= 109</code></li>
</ul>
</blockquote>
<p>Let‚Äôs change the formulation of the problem: consecutive elements <code>nums[i]</code> and <code>nums[j]</code> in a balanced subsequence must satisfy $i &lt; j$ and $nums[j] - nums[i] \ge j - i$.</p>
<p>By rearranging the inequality above, we get $nums[j] - j \ge nums[i] - i$, which means the requirement for each element in a balanced subsequence only depends on its own value and index, not those of other elements.</p>
<p>Therefore, this problem is similar to the Longest Increasing Subsequence, and we can solve it using DP:</p>
<p>DP Definition: <code>dp[j]</code> represents <strong>the maximum sum</strong> of elements in a <strong>balanced</strong> subsequence <strong>ending at</strong> <code>nums[j]</code>.</p>
<p>Recurrence relation: $dp[j] &#x3D; nums[j] + \max\set{dp[i] | (i &lt; j) ‚àß (nums[j] - j \ge nums[i] - i)}$</p>
<p>Code:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">maxBalancedSubsequenceSum</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">long</span> <span class="variable">ans</span> <span class="operator">=</span> Long.MIN_VALUE;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// dp[i]: maximum sum of elements in a subsequence ending at nums[i]</span></span><br><span class="line">        <span class="type">long</span>[] dp = <span class="keyword">new</span> <span class="title class_">long</span>[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            dp[j] = nums[j];</span><br><span class="line">            <span class="type">long</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; j; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[j] - j &gt;= nums[i] - i) &#123;</span><br><span class="line">                    max = Math.max(max, dp[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            dp[j] += max;</span><br><span class="line"></span><br><span class="line">            ans = Math.max(ans, dp[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Obviously, this solution has a time complexity of $O(n^2)$, which is bad. Until end of the contest, I couldn‚Äôt figure out an optimization strategy.</p>
<p>I plan to describe in detail how to solve this problem in the next post, based on insights from an expert‚Äôs solution. For now, I‚Äôll focus on studying the relevant knowledge.</p>
]]></content>
      <categories>
        <category>Algorithm Problems</category>
        <category>Algorithm Contest</category>
      </categories>
      <tags>
        <tag>Simulation</tag>
        <tag>DP</tag>
        <tag>Tree</tag>
      </tags>
  </entry>
  <entry>
    <title>Messages for reader</title>
    <url>/en/3000/01/01/%E7%BD%AE%E9%A1%B6%E9%80%9A%E7%9F%A5/</url>
    <content><![CDATA[<ul>
<li>Translation of posts is based on ChatGPT first, and then proofread by me. If there is any ambiguity, please refer to the Chinese version.</li>
<li>Visit the Chinese site <a href="/" onclick="jump()">here</a>, or click ‚ÄòSwitch to Chinese‚Äô at the left sidebar.</li>
</ul>
<script>
    function jump() {
        window.location.href = "https://el-nino2020.github.io?timestamp=" + (new Date()).getTime();
    }
</script>]]></content>
  </entry>
</search>
